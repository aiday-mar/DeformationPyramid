model 002 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4980, 32])
F1.shape : torch.Size([4883, 32])
ldmk_t_indices :  tensor([4806, 4806, 1730,  ..., 1283, 1012, 3461], device='cuda:0')
ldmk_s.shape :  torch.Size([4980, 3])
ldmk_t.shape :  torch.Size([4980, 3])
vec_6d.shape :  torch.Size([4980, 6])
ind.shape :  torch.Size([1, 4980, 2])
bi :  0
si.shape :  torch.Size([4980])
ti.shape :  torch.Size([4980])
s_pos.shape :  torch.Size([4980, 3])
t_pos.shape :  torch.Size([4980, 3])
ind.shape :  torch.Size([1, 4980, 2])
bi :  0
si.shape :  torch.Size([4980])
ti.shape :  torch.Size([4980])
s_pos.shape :  torch.Size([4980, 3])
t_pos.shape :  torch.Size([4980, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1900  out of  4980
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.3815261044176707
vec6d.shape :  torch.Size([4980, 6])
ldmk_s.shape :  torch.Size([4980, 3])
ldmk_t.shape :  torch.Size([4980, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4980, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.291 
full-AccS: 0.000 
full-AccR: 5.168 
full-outlier: 39.853 
vis-epe: 12.444 
vis-AccS: 0.000 
vis-AccR: 0.995 
vis-outlier: 85.617 
occ-epe: 4.688 
occ-AccS: 0.000 
occ-AccR: 8.788 
occ-outlier: 0.157 

Actual rotation :  [[-0.40974485 -0.0177874  -0.91202674]
 [ 0.82672423  0.41532003 -0.37952117]
 [ 0.38553367 -0.90950145 -0.15546996]]
Actual translation :  [ 1.97322969 -0.31353126  0.18591825]
Predicted rotation :  [[-0.42563175 -0.05965538 -0.90292798]
 [ 0.87333576  0.23414914 -0.42715217]
 [ 0.23690176 -0.97036886 -0.04756216]]
Predicted translation :  [-0.01179126 -0.03407384  0.00041451]
Relative Rotation Error :  0.1962640205084926
Relative Translation Error :  2.0131607686968978
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04462546739435488
Strict IR :  0.0
Relaxed IR :  0.11817226890756302
model 042 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4933, 32])
F1.shape : torch.Size([5209, 32])
ldmk_t_indices :  tensor([5078, 1578, 1547,  ..., 2095, 2095, 1950], device='cuda:0')
ldmk_s.shape :  torch.Size([4933, 3])
ldmk_t.shape :  torch.Size([4933, 3])
vec_6d.shape :  torch.Size([4933, 6])
ind.shape :  torch.Size([1, 4933, 2])
bi :  0
si.shape :  torch.Size([4933])
ti.shape :  torch.Size([4933])
s_pos.shape :  torch.Size([4933, 3])
t_pos.shape :  torch.Size([4933, 3])
ind.shape :  torch.Size([1, 4933, 2])
bi :  0
si.shape :  torch.Size([4933])
ti.shape :  torch.Size([4933])
s_pos.shape :  torch.Size([4933, 3])
t_pos.shape :  torch.Size([4933, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1192  out of  4933
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.24163794851003445
vec6d.shape :  torch.Size([4933, 6])
ldmk_s.shape :  torch.Size([4933, 3])
ldmk_t.shape :  torch.Size([4933, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4933, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.689 
full-AccS: 0.068 
full-AccR: 20.525 
full-outlier: 69.976 
vis-epe: 15.025 
vis-AccS: 0.093 
vis-AccR: 3.146 
vis-outlier: 94.456 
occ-epe: 2.845 
occ-AccS: 0.000 
occ-AccR: 66.598 
occ-outlier: 5.078 

Actual rotation :  [[-0.87462848 -0.4705988  -0.11645507]
 [ 0.24256895 -0.63279443  0.73534448]
 [-0.41974435  0.61490485  0.66761269]]
Actual translation :  [ 1.20593496  0.83257865 -0.4390415 ]
Predicted rotation :  [[-0.73756145 -0.61189915 -0.28562707]
 [ 0.26360188 -0.65030849  0.71246974]
 [-0.62170527  0.4501983   0.64094003]]
Predicted translation :  [ 0.02154563 -0.0044048   0.016344  ]
Relative Rotation Error :  0.26273984910514603
Relative Translation Error :  1.52009714579644
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04000824607161666
Strict IR :  0.007011195295714124
Relaxed IR :  0.5369218590975913
model 085 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([2677, 32])
F1.shape : torch.Size([2310, 32])
ldmk_t_indices :  tensor([ 40,  24,  46,  ..., 978, 965, 702], device='cuda:0')
ldmk_s.shape :  torch.Size([2677, 3])
ldmk_t.shape :  torch.Size([2677, 3])
vec_6d.shape :  torch.Size([2677, 6])
ind.shape :  torch.Size([1, 2677, 2])
bi :  0
si.shape :  torch.Size([2677])
ti.shape :  torch.Size([2677])
s_pos.shape :  torch.Size([2677, 3])
t_pos.shape :  torch.Size([2677, 3])
ind.shape :  torch.Size([1, 2677, 2])
bi :  0
si.shape :  torch.Size([2677])
ti.shape :  torch.Size([2677])
s_pos.shape :  torch.Size([2677, 3])
t_pos.shape :  torch.Size([2677, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  329  out of  2677
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.12289876727680239
vec6d.shape :  torch.Size([2677, 6])
ldmk_s.shape :  torch.Size([2677, 3])
ldmk_t.shape :  torch.Size([2677, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2677, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.644 
full-AccS: 0.212 
full-AccR: 5.174 
full-outlier: 29.333 
vis-epe: 11.155 
vis-AccS: 0.000 
vis-AccR: 0.219 
vis-outlier: 66.857 
occ-epe: 4.900 
occ-AccS: 0.377 
occ-AccR: 9.047 
occ-outlier: 0.000 

Actual rotation :  [[-0.08515318 -0.0477966  -0.99522079]
 [-0.17928303  0.98328076 -0.03188333]
 [ 0.98010537  0.17571123 -0.0922986 ]]
Actual translation :  [ 0.67656808  0.74129062 -0.19986074]
Predicted rotation :  [[-0.02322854 -0.19888063 -0.97974849]
 [-0.74058346  0.66174092 -0.11676959]
 [ 0.67156287  0.72287305 -0.16265908]]
Predicted translation :  [ 0.02176511 -0.0117033  -0.00289722]
Relative Rotation Error :  0.6649003660666192
Relative Translation Error :  1.0171339177203294
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.051219657372942616
Strict IR :  0.0207732256203116
Relaxed IR :  0.11963839199846124
model 126 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4642, 32])
F1.shape : torch.Size([5144, 32])
ldmk_t_indices :  tensor([4399, 4458, 4400,  ...,  860, 4108,  879], device='cuda:0')
ldmk_s.shape :  torch.Size([4642, 3])
ldmk_t.shape :  torch.Size([4642, 3])
vec_6d.shape :  torch.Size([4642, 6])
ind.shape :  torch.Size([1, 4642, 2])
bi :  0
si.shape :  torch.Size([4642])
ti.shape :  torch.Size([4642])
s_pos.shape :  torch.Size([4642, 3])
t_pos.shape :  torch.Size([4642, 3])
ind.shape :  torch.Size([1, 4642, 2])
bi :  0
si.shape :  torch.Size([4642])
ti.shape :  torch.Size([4642])
s_pos.shape :  torch.Size([4642, 3])
t_pos.shape :  torch.Size([4642, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1611  out of  4642
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.34704868591124516
vec6d.shape :  torch.Size([4642, 6])
ldmk_s.shape :  torch.Size([4642, 3])
ldmk_t.shape :  torch.Size([4642, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4642, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.971 
full-AccS: 0.000 
full-AccR: 0.811 
full-outlier: 64.104 
vis-epe: 15.634 
vis-AccS: 0.000 
vis-AccR: 1.421 
vis-outlier: 96.544 
occ-epe: 4.767 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 20.937 

Actual rotation :  [[-0.81564788 -0.06094346 -0.57532984]
 [ 0.57678234 -0.16330348 -0.80040871]
 [-0.04517368 -0.98469176  0.16834925]]
Actual translation :  [0.89703757 1.00050158 0.50390294]
Predicted rotation :  [[-0.85265956 -0.04792741 -0.5202639 ]
 [ 0.51479453 -0.24709329 -0.82093324]
 [-0.08920853 -0.96780568  0.23535932]]
Predicted translation :  [ 0.01961657  0.00065593 -0.01248145]
Relative Rotation Error :  0.10628274935858233
Relative Translation Error :  1.4269589248974335
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04729833594462232
Strict IR :  0.0
Relaxed IR :  0.03438256658595642
model 167 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([1999, 32])
F1.shape : torch.Size([2143, 32])
ldmk_t_indices :  tensor([2053, 2053, 2060,  ..., 2042, 1291,  694], device='cuda:0')
ldmk_s.shape :  torch.Size([1999, 3])
ldmk_t.shape :  torch.Size([1999, 3])
vec_6d.shape :  torch.Size([1999, 6])
ind.shape :  torch.Size([1, 1999, 2])
bi :  0
si.shape :  torch.Size([1999])
ti.shape :  torch.Size([1999])
s_pos.shape :  torch.Size([1999, 3])
t_pos.shape :  torch.Size([1999, 3])
ind.shape :  torch.Size([1, 1999, 2])
bi :  0
si.shape :  torch.Size([1999])
ti.shape :  torch.Size([1999])
s_pos.shape :  torch.Size([1999, 3])
t_pos.shape :  torch.Size([1999, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  916  out of  1999
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.45822911455727866
vec6d.shape :  torch.Size([1999, 6])
ldmk_s.shape :  torch.Size([1999, 3])
ldmk_t.shape :  torch.Size([1999, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1999, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.211 
full-AccS: 0.740 
full-AccR: 15.948 
full-outlier: 84.027 
vis-epe: 10.059 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.774 
occ-epe: 3.506 
occ-AccS: 1.703 
occ-AccR: 36.700 
occ-outlier: 63.535 

Actual rotation :  [[-0.81029619  0.58572329  0.0186628 ]
 [ 0.42981428  0.61565456 -0.66047646]
 [-0.39834628 -0.52716002 -0.75061478]]
Actual translation :  [0.2961076  0.17846237 1.41276713]
Predicted rotation :  [[-0.61414159  0.78875272  0.02644181]
 [ 0.6687811   0.53793285 -0.51318615]
 [-0.41900093 -0.29748523 -0.8578698 ]]
Predicted translation :  [-0.00245324  0.01273986 -0.00814733]
Relative Rotation Error :  0.3402233763600793
Relative Translation Error :  1.4613693666568137
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03720456885808091
Strict IR :  0.009951518244450114
Relaxed IR :  0.36539933656545037
model 207 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([2183, 32])
F1.shape : torch.Size([2080, 32])
ldmk_t_indices :  tensor([  94, 1192,  108,  ...,  344,  473, 1205], device='cuda:0')
ldmk_s.shape :  torch.Size([2183, 3])
ldmk_t.shape :  torch.Size([2183, 3])
vec_6d.shape :  torch.Size([2183, 6])
ind.shape :  torch.Size([1, 2183, 2])
bi :  0
si.shape :  torch.Size([2183])
ti.shape :  torch.Size([2183])
s_pos.shape :  torch.Size([2183, 3])
t_pos.shape :  torch.Size([2183, 3])
ind.shape :  torch.Size([1, 2183, 2])
bi :  0
si.shape :  torch.Size([2183])
ti.shape :  torch.Size([2183])
s_pos.shape :  torch.Size([2183, 3])
t_pos.shape :  torch.Size([2183, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1167  out of  2183
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.5345854328905176
vec6d.shape :  torch.Size([2183, 6])
ldmk_s.shape :  torch.Size([2183, 3])
ldmk_t.shape :  torch.Size([2183, 3])
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2183, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.413 
full-AccS: 0.145 
full-AccR: 28.724 
full-outlier: 18.963 
vis-epe: 9.119 
vis-AccS: 0.261 
vis-AccR: 5.096 
vis-outlier: 34.103 
occ-epe: 3.024 
occ-AccS: 0.000 
occ-AccR: 58.320 
occ-outlier: 0.000 

Actual rotation :  [[-0.32787446  0.25529739 -0.9095722 ]
 [ 0.93634976  0.21570775 -0.27698246]
 [ 0.12548888 -0.94249319 -0.30977271]]
Actual translation :  [0.74584319 0.0201462  0.21741575]
Predicted rotation :  [[-0.57466281  0.09569658 -0.81277586]
 [ 0.79372278  0.307168   -0.52502566]
 [ 0.19941558 -0.94683152 -0.2524746 ]]
Predicted translation :  [-0.0222861   0.00907981 -0.01170164]
Relative Rotation Error :  0.31332714431680025
Relative Translation Error :  0.8016482046719439
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.030188822440036355
Strict IR :  0.0
Relaxed IR :  0.601356260595786
