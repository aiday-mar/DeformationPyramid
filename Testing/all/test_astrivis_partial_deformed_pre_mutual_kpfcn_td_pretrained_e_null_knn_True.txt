model 002 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([132, 528])
F1.shape : torch.Size([123, 528])
ldmk_t_indices :  tensor([ 55,  71,  55,  88,  93,  47,  70,  75,  38,  22,  42,  94,  55,  57,
         47,  16,  57,  57,  25,  47, 108,  91,  32,  67,  70,  31,  29,  66,
         71,  85,  26,  22,  83,  32,  93,  46,  48,  46, 114,  38,  48,  22,
         42,  79,  70,  22,  67,  57,  93,  47,  23,  11,  75,  13,  95,  62,
         47,  93,  45,  57, 122,  41,  47,  38,  60,  41,  40,  22,  22,  93,
         67,  71,  86,  60,  55, 116,  66,  48,  38,  67,  48,  47,  82,  41,
         57,  24, 114,  38,  55,  88,   6,  75,  30,  47,  82,  47,  40,  22,
         67, 121,  11, 121,  34, 110,  47,  61,  82,  88,  81,  77,  56,  70,
         82,  82,  26,   2,  42,  82,  70, 108,  31,  88,  47,  47,  37,   2,
         46,  34,  56,  47,  70,  93], device='cuda:0')
ldmk_s.shape :  torch.Size([132, 3])
ldmk_t.shape :  torch.Size([132, 3])
vec_6d.shape :  torch.Size([132, 6])
ind.shape :  torch.Size([1, 132, 2])
bi :  0
si.shape :  torch.Size([132])
ti.shape :  torch.Size([132])
s_pos.shape :  torch.Size([132, 3])
t_pos.shape :  torch.Size([132, 3])
ind.shape :  torch.Size([1, 132, 2])
bi :  0
si.shape :  torch.Size([132])
ti.shape :  torch.Size([132])
s_pos.shape :  torch.Size([132, 3])
t_pos.shape :  torch.Size([132, 3])
number of true landmarks correspondences returned from KNN matching :  8  out of  132
fraction of true landmark correspondences returned from KNN matching :  0.06060606060606061
vec6d.shape :  torch.Size([132, 6])
ldmk_s.shape :  torch.Size([132, 3])
ldmk_t.shape :  torch.Size([132, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([132, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.242 
full-AccS: 0.053 
full-AccR: 0.956 
full-outlier: 93.666 
vis-epe: 18.067 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 98.213 
occ-epe: 14.659 
occ-AccS: 0.098 
occ-AccR: 1.785 
occ-outlier: 89.721 

Actual rotation :  [[-0.40974485 -0.0177874  -0.91202674]
 [ 0.82672423  0.41532003 -0.37952117]
 [ 0.38553367 -0.90950145 -0.15546996]]
Actual translation :  [ 1.97322969 -0.31353126  0.18591825]
Predicted rotation :  [[ 0.5071846  -0.37915666 -0.77395346]
 [ 0.42467646  0.89138273 -0.15838721]
 [ 0.74994233 -0.24834831  0.61311455]]
Predicted translation :  [-0.00069798 -0.08493789  0.02093268]
Relative Rotation Error :  1.2100820959828824
Relative Translation Error :  1.9939572767584348
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12755198668890103
Strict IR :  0.0006302521008403362
Relaxed IR :  0.04086134453781513
model 042 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([117, 528])
F1.shape : torch.Size([114, 528])
ldmk_t_indices :  tensor([ 85,  13,  84,  62,  84,  62, 107,  47, 107,  66,  54,   3, 111,  62,
         32,  29,  66,  62,  57,  33,  15,  46,   3,  62,  40,  33,  62,  62,
         29,  10,  95,  10,  35,  40,  79,  62,  18,  40,  95,  99,   3,  59,
         25,  87,  82,  71,  37,  62,  40,  59,  29,  40,  95,  89,  71,   3,
         25,  91,  31,  59,  79,  62,  62,  89,   3,  18,  87,  62,  46,  71,
         62,  45,  62,  40,  62,   3,  25,  45,  62,   3,  91,  91,  57,  62,
         85,  54,  25,  71,  33,  91,  71, 110,  95,   3,  62,  29,  31,  33,
         91,  62,  24,  59,  99,  96,  45,  89,  62,  85,  85,  33,  47,  91,
         85,   3,  59,  62,  36], device='cuda:0')
ldmk_s.shape :  torch.Size([117, 3])
ldmk_t.shape :  torch.Size([117, 3])
vec_6d.shape :  torch.Size([117, 6])
ind.shape :  torch.Size([1, 117, 2])
bi :  0
si.shape :  torch.Size([117])
ti.shape :  torch.Size([117])
s_pos.shape :  torch.Size([117, 3])
t_pos.shape :  torch.Size([117, 3])
ind.shape :  torch.Size([1, 117, 2])
bi :  0
si.shape :  torch.Size([117])
ti.shape :  torch.Size([117])
s_pos.shape :  torch.Size([117, 3])
t_pos.shape :  torch.Size([117, 3])
number of true landmarks correspondences returned from KNN matching :  6  out of  117
fraction of true landmark correspondences returned from KNN matching :  0.05128205128205128
vec6d.shape :  torch.Size([117, 6])
ldmk_s.shape :  torch.Size([117, 3])
ldmk_t.shape :  torch.Size([117, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([117, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.172 
full-AccS: 0.034 
full-AccR: 0.656 
full-outlier: 98.994 
vis-epe: 24.797 
vis-AccS: 0.016 
vis-AccR: 0.327 
vis-outlier: 99.377 
occ-epe: 15.212 
occ-AccS: 0.083 
occ-AccR: 1.528 
occ-outlier: 97.977 

Actual rotation :  [[-0.87462848 -0.4705988  -0.11645507]
 [ 0.24256895 -0.63279443  0.73534448]
 [-0.41974435  0.61490485  0.66761269]]
Actual translation :  [ 1.20593496  0.83257865 -0.4390415 ]
Predicted rotation :  [[ 0.84662664  0.13509188 -0.5147556 ]
 [-0.23709338  0.96169794 -0.13756436]
 [ 0.47645562  0.23851082  0.84622848]]
Predicted translation :  [0.00881307 0.057149   0.04506151]
Relative Rotation Error :  3.1246504864413622
Relative Translation Error :  1.5062362699182839
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13511481194602823
Strict IR :  0.0015831731312902862
Relaxed IR :  0.02193825624787968
model 085 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([73, 528])
F1.shape : torch.Size([57, 528])
ldmk_t_indices :  tensor([48, 28, 27, 34, 45, 23, 28, 37, 28, 53, 25, 34, 33, 28,  7, 42, 28, 50,
        14, 37, 47, 25, 26, 17, 17, 30, 17, 48, 53, 23, 48, 17, 43, 17, 41, 23,
        20, 42, 20, 17, 48,  7, 48, 48, 48, 53, 23, 30, 23, 14, 48, 20, 48, 41,
        30, 28, 48, 48, 26, 23, 12, 20, 41, 41, 48, 42, 30, 50, 44, 28, 38, 26,
        20], device='cuda:0')
ldmk_s.shape :  torch.Size([73, 3])
ldmk_t.shape :  torch.Size([73, 3])
vec_6d.shape :  torch.Size([73, 6])
ind.shape :  torch.Size([1, 73, 2])
bi :  0
si.shape :  torch.Size([73])
ti.shape :  torch.Size([73])
s_pos.shape :  torch.Size([73, 3])
t_pos.shape :  torch.Size([73, 3])
ind.shape :  torch.Size([1, 73, 2])
bi :  0
si.shape :  torch.Size([73])
ti.shape :  torch.Size([73])
s_pos.shape :  torch.Size([73, 3])
t_pos.shape :  torch.Size([73, 3])
number of true landmarks correspondences returned from KNN matching :  2  out of  73
fraction of true landmark correspondences returned from KNN matching :  0.0273972602739726
vec6d.shape :  torch.Size([73, 6])
ldmk_s.shape :  torch.Size([73, 3])
ldmk_t.shape :  torch.Size([73, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([73, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.576 
full-AccS: 0.000 
full-AccR: 1.443 
full-outlier: 33.930 
vis-epe: 13.784 
vis-AccS: 0.000 
vis-AccR: 2.060 
vis-outlier: 69.706 
occ-epe: 6.286 
occ-AccS: 0.000 
occ-AccR: 0.960 
occ-outlier: 5.963 

Actual rotation :  [[-0.08515318 -0.0477966  -0.99522079]
 [-0.17928303  0.98328076 -0.03188333]
 [ 0.98010537  0.17571123 -0.0922986 ]]
Actual translation :  [ 0.67656808  0.74129062 -0.19986074]
Predicted rotation :  [[ 0.93943413 -0.19232594 -0.28368001]
 [ 0.21359704  0.97584993  0.0457527 ]
 [ 0.2680297  -0.10357483  0.95782697]]
Predicted translation :  [ 0.02294074 -0.04511035 -0.07586507]
Relative Rotation Error :  1.4265999697469178
Relative Translation Error :  1.0300631578676602
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07140481208640191
Strict IR :  0.0
Relaxed IR :  0.04885554914406617
model 126 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([128, 528])
F1.shape : torch.Size([132, 528])
ldmk_t_indices :  tensor([102, 106,  54, 124,  35,  72,  70,  23, 124, 111,  93,  85,  30,  30,
         67, 111,  37,  63,  91, 117,   9,  53,  68, 111,  85, 111,  43,  66,
        106,  56,  95,  66,  93,  43,  72, 111,  21, 111, 110,  90,  90,  72,
        126,  29,  27, 126,  37,  36,  75,  72,  80,  91,  68,  93,  69,  25,
         65, 104, 111, 119,  27, 111,  90, 105,  97,  23,  72,  28, 104, 104,
         96,  69,  36,  25, 111, 113,   2,  81, 111,  75,  49,  28,  80,  57,
        111,  28,  56,  19,  94,  80,  37,  63,  58,  21, 122, 122,  65,  43,
        109,  80,  28,  59, 111,  35,  80,  28,  80,  72, 111, 111,  72, 102,
         27, 111,  45,  53,   9,  30,  72, 111,  58,  75, 111,  35,  75,  37,
        122, 111], device='cuda:0')
ldmk_s.shape :  torch.Size([128, 3])
ldmk_t.shape :  torch.Size([128, 3])
vec_6d.shape :  torch.Size([128, 6])
ind.shape :  torch.Size([1, 128, 2])
bi :  0
si.shape :  torch.Size([128])
ti.shape :  torch.Size([128])
s_pos.shape :  torch.Size([128, 3])
t_pos.shape :  torch.Size([128, 3])
ind.shape :  torch.Size([1, 128, 2])
bi :  0
si.shape :  torch.Size([128])
ti.shape :  torch.Size([128])
s_pos.shape :  torch.Size([128, 3])
t_pos.shape :  torch.Size([128, 3])
number of true landmarks correspondences returned from KNN matching :  9  out of  128
fraction of true landmark correspondences returned from KNN matching :  0.0703125
vec6d.shape :  torch.Size([128, 6])
ldmk_s.shape :  torch.Size([128, 3])
ldmk_t.shape :  torch.Size([128, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([128, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 17.611 
full-AccS: 0.000 
full-AccR: 1.162 
full-outlier: 95.230 
vis-epe: 22.050 
vis-AccS: 0.000 
vis-AccR: 0.212 
vis-outlier: 98.282 
occ-epe: 11.705 
occ-AccS: 0.000 
occ-AccR: 2.427 
occ-outlier: 91.168 

Actual rotation :  [[-0.81564788 -0.06094346 -0.57532984]
 [ 0.57678234 -0.16330348 -0.80040871]
 [-0.04517368 -0.98469176  0.16834925]]
Actual translation :  [0.89703757 1.00050158 0.50390294]
Predicted rotation :  [[-0.06116116 -0.82980421 -0.5546928 ]
 [ 0.91624813  0.17376001 -0.3609665 ]
 [ 0.39591497 -0.53031348  0.7496792 ]]
Predicted translation :  [ 0.00859014 -0.02151234 -0.05324231]
Relative Rotation Error :  1.1378316014159897
Relative Translation Error :  1.464329921477856
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11640231111863855
Strict IR :  0.0020581113801452786
Relaxed IR :  0.0635593220338983
model 167 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([61, 528])
F1.shape : torch.Size([52, 528])
ldmk_t_indices :  tensor([45, 51, 48, 32, 45, 26, 43, 23, 32, 45, 47, 19, 45, 32, 19, 27, 48, 27,
        47, 26,  4, 46, 23, 19, 33, 41, 41, 32, 32, 29, 46, 23, 47,  4, 19, 26,
        48, 40,  4, 43, 19, 47, 27, 26,  4, 19, 51, 47, 44, 26, 47, 40, 34, 19,
        47, 45, 44, 51, 47, 46, 45], device='cuda:0')
ldmk_s.shape :  torch.Size([61, 3])
ldmk_t.shape :  torch.Size([61, 3])
vec_6d.shape :  torch.Size([61, 6])
ind.shape :  torch.Size([1, 61, 2])
bi :  0
si.shape :  torch.Size([61])
ti.shape :  torch.Size([61])
s_pos.shape :  torch.Size([61, 3])
t_pos.shape :  torch.Size([61, 3])
ind.shape :  torch.Size([1, 61, 2])
bi :  0
si.shape :  torch.Size([61])
ti.shape :  torch.Size([61])
s_pos.shape :  torch.Size([61, 3])
t_pos.shape :  torch.Size([61, 3])
number of true landmarks correspondences returned from KNN matching :  0  out of  61
fraction of true landmark correspondences returned from KNN matching :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([61, 6])
ldmk_s.shape :  torch.Size([61, 3])
ldmk_t.shape :  torch.Size([61, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([61, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.892 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 100.000 
vis-epe: 16.413 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 10.613 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

Actual rotation :  [[-0.81029619  0.58572329  0.0186628 ]
 [ 0.42981428  0.61565456 -0.66047646]
 [-0.39834628 -0.52716002 -0.75061478]]
Actual translation :  [0.2961076  0.17846237 1.41276713]
Predicted rotation :  [[ 0.57675199  0.26245538 -0.77361117]
 [ 0.48043657  0.6569319   0.58105161]
 [ 0.66071002 -0.70679378  0.25279369]]
Predicted translation :  [ 0.01519746  0.02087748 -0.02373713]
Relative Rotation Error :  2.2026167012792923
Relative Translation Error :  1.4721711836844584
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10362070511130153
Strict IR :  0.0
Relaxed IR :  0.04873692268435825
model 207 file1 020 file2 104
0 to 1
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([51, 528])
F1.shape : torch.Size([52, 528])
ldmk_t_indices :  tensor([36, 13, 24, 22, 12, 13, 32, 13, 36, 13, 36, 38, 47, 30, 27, 12, 12, 23,
        17, 36, 36, 33, 13,  6,  6, 21, 24,  9, 23, 13, 38, 44, 51, 38, 12, 17,
        28,  6, 17, 23,  6, 51, 47, 13, 45, 23,  8, 44, 36,  6, 38],
       device='cuda:0')
ldmk_s.shape :  torch.Size([51, 3])
ldmk_t.shape :  torch.Size([51, 3])
vec_6d.shape :  torch.Size([51, 6])
ind.shape :  torch.Size([1, 51, 2])
bi :  0
si.shape :  torch.Size([51])
ti.shape :  torch.Size([51])
s_pos.shape :  torch.Size([51, 3])
t_pos.shape :  torch.Size([51, 3])
ind.shape :  torch.Size([1, 51, 2])
bi :  0
si.shape :  torch.Size([51])
ti.shape :  torch.Size([51])
s_pos.shape :  torch.Size([51, 3])
t_pos.shape :  torch.Size([51, 3])
number of true landmarks correspondences returned from KNN matching :  3  out of  51
fraction of true landmark correspondences returned from KNN matching :  0.058823529411764705
vec6d.shape :  torch.Size([51, 6])
ldmk_s.shape :  torch.Size([51, 3])
ldmk_t.shape :  torch.Size([51, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([51, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.580 
full-AccS: 0.000 
full-AccR: 0.484 
full-outlier: 52.216 
vis-epe: 14.754 
vis-AccS: 0.000 
vis-AccR: 0.871 
vis-outlier: 67.160 
occ-epe: 9.857 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 33.497 

Actual rotation :  [[-0.32787446  0.25529739 -0.9095722 ]
 [ 0.93634976  0.21570775 -0.27698246]
 [ 0.12548888 -0.94249319 -0.30977271]]
Actual translation :  [0.74584319 0.0201462  0.21741575]
Predicted rotation :  [[ 0.84995562 -0.11659156  0.51379152]
 [ 0.33113623 -0.64029277 -0.69308999]
 [ 0.4097855   0.75923068 -0.50561265]]
Predicted translation :  [ 0.02586022 -0.00816212 -0.05472172]
Relative Rotation Error :  2.8566916631374233
Relative Translation Error :  0.7702179167260526
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09091223985785489
Strict IR :  0.0
Relaxed IR :  0.061758294986679584
