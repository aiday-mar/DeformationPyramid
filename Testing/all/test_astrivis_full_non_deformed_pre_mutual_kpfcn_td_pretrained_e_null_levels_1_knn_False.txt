model 002
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([5, 3])
bi :  tensor([0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5])
ti.shape :  torch.Size([5])
s_pos.shape :  torch.Size([5, 3])
t_pos.shape :  torch.Size([5, 3])
ind.shape :  torch.Size([5, 3])
bi :  tensor([0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5])
ti.shape :  torch.Size([5])
s_pos.shape :  torch.Size([5, 3])
t_pos.shape :  torch.Size([5, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  5
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 25.930 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.746 
vis-epe: 25.930 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.746 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[-0.53486491 -0.60002104  0.59489014]
 [-0.74890142  0.66266287 -0.00495792]
 [-0.39123675 -0.44816589 -0.80379173]]
Actual translation :  [0.89692495 0.43777249 1.20478005]
Predicted rotation :  [[-0.2762394   0.95032561  0.14343345]
 [ 0.34840986  0.23810852 -0.90659523]
 [-0.89571333 -0.20046365 -0.39687788]]
Predicted translation :  [ 0.07515227  0.04578515 -0.06047301]
Relative Rotation Error :  1.9158516561409116
Relative Translation Error :  1.558791107681669
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15726843926824302
Strict IR :  0.0
Relaxed IR :  0.0
model 042
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([4, 3])
bi :  tensor([0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4])
ti.shape :  torch.Size([4])
s_pos.shape :  torch.Size([4, 3])
t_pos.shape :  torch.Size([4, 3])
ind.shape :  torch.Size([4, 3])
bi :  tensor([0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4])
ti.shape :  torch.Size([4])
s_pos.shape :  torch.Size([4, 3])
t_pos.shape :  torch.Size([4, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  4
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([4, 6])
ldmk_s.shape :  torch.Size([4, 3])
ldmk_t.shape :  torch.Size([4, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  4
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 30.108 
full-AccS: 0.000 
full-AccR: 0.182 
full-outlier: 99.356 
vis-epe: 30.108 
vis-AccS: 0.000 
vis-AccR: 0.182 
vis-outlier: 99.356 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[-0.40066553 -0.11995433 -0.90833809]
 [ 0.24675989  0.94063308 -0.23306431]
 [ 0.88236993 -0.31752224 -0.34727933]]
Actual translation :  [1.20244689 0.33445861 0.35577331]
Predicted rotation :  [[ 0.12570393  0.61584908  0.77777141]
 [-0.98691756  0.15741009  0.03486699]
 [-0.10095626 -0.77197921  0.62757939]]
Predicted translation :  [0.0135923  0.02063874 0.04206942]
Relative Rotation Error :  3.080074682375486
Relative Translation Error :  1.268963463049532
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.21014448786158924
Strict IR :  0.0
Relaxed IR :  0.017854973885582413
model 085
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([7, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([7])
ti.shape :  torch.Size([7])
s_pos.shape :  torch.Size([7, 3])
t_pos.shape :  torch.Size([7, 3])
ind.shape :  torch.Size([7, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([7])
ti.shape :  torch.Size([7])
s_pos.shape :  torch.Size([7, 3])
t_pos.shape :  torch.Size([7, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  7
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([6, 6])
ldmk_s.shape :  torch.Size([6, 3])
ldmk_t.shape :  torch.Size([6, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  6
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([6, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.759 
full-AccS: 0.000 
full-AccR: 0.490 
full-outlier: 98.975 
vis-epe: 26.759 
vis-AccS: 0.000 
vis-AccR: 0.490 
vis-outlier: 98.975 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[ 0.76902396  0.10084417  0.63121518]
 [-0.46095699 -0.59664159  0.65691511]
 [ 0.44285529 -0.79614651 -0.41234685]]
Actual translation :  [-0.53063257  0.48585253  1.09298804]
Predicted rotation :  [[ 0.79699916 -0.50111985 -0.33715165]
 [ 0.29166609  0.80814421 -0.51169699]
 [ 0.52888864  0.30948639  0.79024994]]
Predicted translation :  [ 0.01193557  0.02699147 -0.03755737]
Relative Rotation Error :  2.8985713088574236
Relative Translation Error :  1.3353151674941324
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1678470621967193
Strict IR :  0.0
Relaxed IR :  0.015597147950089126
model 126
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([8, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([8])
ti.shape :  torch.Size([8])
s_pos.shape :  torch.Size([8, 3])
t_pos.shape :  torch.Size([8, 3])
ind.shape :  torch.Size([8, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([8])
ti.shape :  torch.Size([8])
s_pos.shape :  torch.Size([8, 3])
t_pos.shape :  torch.Size([8, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  8
fraction of true landmark correspondences returned from Lepard :  0.125
vec6d.shape :  torch.Size([7, 6])
ldmk_s.shape :  torch.Size([7, 3])
ldmk_t.shape :  torch.Size([7, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  7
fraction of true landmark correspondences returned from Outlier Rejection :  0.14285714285714285
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([7, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.583 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 98.474 
vis-epe: 26.583 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 98.474 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[ 0.63814927 -0.15503533 -0.7541416 ]
 [-0.61475232 -0.69230752 -0.37787548]
 [-0.46351385  0.70475126 -0.53710387]]
Actual translation :  [0.96696898 0.79531393 0.98999611]
Predicted rotation :  [[ 0.71819443 -0.19622815  0.66760123]
 [ 0.31288558 -0.76588523 -0.56171399]
 [ 0.62152988  0.6123026  -0.48865771]]
Predicted translation :  [0.00230231 0.02283012 0.03381161]
Relative Rotation Error :  1.6001486013372737
Relative Translation Error :  1.5625625824528924
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13967138338909074
Strict IR :  0.0018197088465845466
Relaxed IR :  0.02757558790593505
model 167
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  10
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([9, 6])
ldmk_s.shape :  torch.Size([9, 3])
ldmk_t.shape :  torch.Size([9, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  9
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([9, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.908 
full-AccS: 0.156 
full-AccR: 2.148 
full-outlier: 74.626 
vis-epe: 13.908 
vis-AccS: 0.156 
vis-AccR: 2.148 
vis-outlier: 74.626 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[ 0.39671545  0.36679516 -0.8414738 ]
 [-0.57527497  0.81369012  0.08346918]
 [ 0.71531501  0.4509653   0.53381151]]
Actual translation :  [ 0.05762421 -0.46980197  0.32040084]
Predicted rotation :  [[ 0.71096212 -0.20020378  0.67413002]
 [ 0.68615794  0.40743679 -0.60264623]
 [-0.15401334  0.89101833  0.42704356]]
Predicted translation :  [-0.02367155  0.02913008 -0.01329485]
Relative Rotation Error :  2.067204351226065
Relative Translation Error :  0.6057185855937468
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12281116531178497
Strict IR :  0.0037359900373599006
Relaxed IR :  0.04389788293897883
model 207
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.01
preprocessing :  mutual
confidence threshold used in the matching :  0.01
preprocessing :  mutual
ind.shape :  torch.Size([15, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([15])
ti.shape :  torch.Size([15])
s_pos.shape :  torch.Size([15, 3])
t_pos.shape :  torch.Size([15, 3])
ind.shape :  torch.Size([15, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([15])
ti.shape :  torch.Size([15])
s_pos.shape :  torch.Size([15, 3])
t_pos.shape :  torch.Size([15, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  15
fraction of true landmark correspondences returned from Lepard :  0.06666666666666667
vec6d.shape :  torch.Size([13, 6])
ldmk_s.shape :  torch.Size([13, 3])
ldmk_t.shape :  torch.Size([13, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  13
fraction of true landmark correspondences returned from Outlier Rejection :  0.07692307692307693
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([13, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.671 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 100.000 
vis-epe: 23.671 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

Actual rotation :  [[-0.69578084  0.62399956  0.35568745]
 [ 0.66485052  0.37215059  0.64767101]
 [ 0.27177713  0.68711606 -0.67380168]]
Actual translation :  [ 0.44784053 -0.19352481 -0.1776428 ]
Predicted rotation :  [[ 0.55706751  0.73759472 -0.3816148 ]
 [-0.49686989  0.66422009  0.55850875]
 [ 0.66542935 -0.12151417  0.73650402]]
Predicted translation :  [ 0.04314643  0.03986562 -0.0036798 ]
Relative Rotation Error :  2.2039632993828193
Relative Translation Error :  0.49850931175445506
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1335938281719747
Strict IR :  0.0
Relaxed IR :  0.0
