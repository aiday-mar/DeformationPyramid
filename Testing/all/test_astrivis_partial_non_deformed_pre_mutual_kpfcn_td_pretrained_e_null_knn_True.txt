model 002
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([123, 528])
F1.shape : torch.Size([132, 528])
ldmk_t_indices :  tensor([  0, 128, 117,   7,  50,  42, 127, 130, 116,  42,  34, 127, 127,  50,
          1,  66,  66, 111,  33, 130,  42,   1,  42, 112,  66, 112,  42,  42,
        112, 112,  33,  42,  24,   1,  41,  33,  62,  88, 125,  66,  50,  33,
         95,   7,  66,  50,   7,   7,   7,   4, 127,  92,  95,  90,  50,   7,
         95,  88,  88,  95,  96,  33,  86,  50,   7,  13,  50, 117,  42,  33,
        117,  42,  42,  78,  90,  33,  85,  93,  42,  73,   1,  95, 101,  71,
         92,  92,  69,  50,   7,   1,  73,  95,  61,  58,  42,  98,  33,  73,
         88,  33, 117,   4,  96,  21, 128,   1,  42,  42,  50,  90,  90, 130,
        111,  92,   1, 125,  30,  50,  42,  50,  92,  95, 123],
       device='cuda:0')
ldmk_s.shape :  torch.Size([123, 3])
ldmk_t.shape :  torch.Size([123, 3])
vec_6d.shape :  torch.Size([123, 6])
ind.shape :  torch.Size([1, 123, 2])
bi :  0
si.shape :  torch.Size([123])
ti.shape :  torch.Size([123])
s_pos.shape :  torch.Size([123, 3])
t_pos.shape :  torch.Size([123, 3])
ind.shape :  torch.Size([1, 123, 2])
bi :  0
si.shape :  torch.Size([123])
ti.shape :  torch.Size([123])
s_pos.shape :  torch.Size([123, 3])
t_pos.shape :  torch.Size([123, 3])
number of true landmarks correspondences returned from KNN matching :  6  out of  123
fraction of true landmark correspondences returned from KNN matching :  0.04878048780487805
vec6d.shape :  torch.Size([123, 6])
ldmk_s.shape :  torch.Size([123, 3])
ldmk_t.shape :  torch.Size([123, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([123, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.740 
full-AccS: 0.000 
full-AccR: 0.352 
full-outlier: 99.829 
vis-epe: 21.215 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 20.351 
occ-AccS: 0.000 
occ-AccR: 0.641 
occ-outlier: 99.689 

Actual rotation :  [[-0.01511908  0.6490511  -0.76059456]
 [ 0.47666865  0.67335838  0.56513316]
 [ 0.87895302 -0.35400729 -0.31956287]]
Actual translation :  [ 0.93734424 -0.40657474 -0.29944652]
Predicted rotation :  [[ 0.49762881  0.61934277 -0.6072728 ]
 [-0.86409968  0.41489949 -0.28493929]
 [ 0.07548211  0.66653811  0.74163967]]
Predicted translation :  [-0.07677907  0.05162744  0.12899091]
Relative Rotation Error :  2.006339932864231
Relative Translation Error :  1.19245710556024
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1843277808182295
Strict IR :  0.0
Relaxed IR :  0.023134328358208955
model 042
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([117, 528])
F1.shape : torch.Size([115, 528])
ldmk_t_indices :  tensor([ 96,  18,  72,  10,  38,  18,  68,  28,  75,  68,  82,  17,  11, 100,
          7,  17,  92, 111,  96, 108,  90,  64,  95,  53, 103,   7,  96,  11,
         33,  92,  64, 100,   7,  90,  45,  26,  92,  10,  43,  43,  71,  48,
         10,  45,  96,  86, 100,  72,  90,  75, 101,  53,  40,  95,  17,  86,
         90,  30,  18,  93,  35,  75,  10,  71,  16, 100,  95,  10,  30,  90,
         86,  91,  64,  32,  48,  11,  35,  10,  10,  10,  33,  92,  35,  68,
         96,  92,  32,  48, 104,  47, 111,  74,  48,  40,  96,  62,  85,  30,
         48,  16,  48,  96,  95,  35,  50,   7, 100,  48, 104,  53,  48,  48,
         71, 100,  47,  74,  68], device='cuda:0')
ldmk_s.shape :  torch.Size([117, 3])
ldmk_t.shape :  torch.Size([117, 3])
vec_6d.shape :  torch.Size([117, 6])
ind.shape :  torch.Size([1, 117, 2])
bi :  0
si.shape :  torch.Size([117])
ti.shape :  torch.Size([117])
s_pos.shape :  torch.Size([117, 3])
t_pos.shape :  torch.Size([117, 3])
ind.shape :  torch.Size([1, 117, 2])
bi :  0
si.shape :  torch.Size([117])
ti.shape :  torch.Size([117])
s_pos.shape :  torch.Size([117, 3])
t_pos.shape :  torch.Size([117, 3])
number of true landmarks correspondences returned from KNN matching :  15  out of  117
fraction of true landmark correspondences returned from KNN matching :  0.1282051282051282
vec6d.shape :  torch.Size([117, 6])
ldmk_s.shape :  torch.Size([117, 3])
ldmk_t.shape :  torch.Size([117, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([117, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.010 
full-AccS: 0.318 
full-AccR: 2.278 
full-outlier: 94.841 
vis-epe: 15.031 
vis-AccS: 0.045 
vis-AccR: 1.372 
vis-outlier: 97.257 
occ-epe: 11.183 
occ-AccS: 1.073 
occ-AccR: 4.787 
occ-outlier: 88.155 

Actual rotation :  [[-0.11586111  0.98316587 -0.14128365]
 [-0.23037909  0.11176292  0.96666154]
 [ 0.96617891  0.14454728  0.21355188]]
Actual translation :  [ 0.37739668  0.30691966 -0.00802446]
Predicted rotation :  [[-0.19272744  0.9810927  -0.01770568]
 [-0.45921682 -0.0742339   0.88521712]
 [ 0.86716553  0.17873633  0.4648411 ]]
Predicted translation :  [-0.03414684 -0.07318545  0.02319334]
Relative Rotation Error :  0.30854757836401964
Relative Translation Error :  0.5610904711684866
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08385913033021733
Strict IR :  0.019058050383351587
Relaxed IR :  0.18565169769989048
model 085
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([69, 528])
F1.shape : torch.Size([64, 528])
ldmk_t_indices :  tensor([20,  5, 37, 20,  4, 60, 19,  8, 41, 14, 46, 55, 28, 27, 57, 26,  0, 12,
        26, 12, 60, 37, 33, 31, 60, 19, 51, 28, 51, 39, 19, 60, 60, 33, 17, 37,
        28, 14, 17, 28,  2, 59, 14, 60, 26,  4, 14, 60, 44, 19, 60, 49,  5, 33,
        49,  0, 27, 53, 54, 53,  3, 20, 29,  0, 59,  3, 60,  7, 54],
       device='cuda:0')
ldmk_s.shape :  torch.Size([69, 3])
ldmk_t.shape :  torch.Size([69, 3])
vec_6d.shape :  torch.Size([69, 6])
ind.shape :  torch.Size([1, 69, 2])
bi :  0
si.shape :  torch.Size([69])
ti.shape :  torch.Size([69])
s_pos.shape :  torch.Size([69, 3])
t_pos.shape :  torch.Size([69, 3])
ind.shape :  torch.Size([1, 69, 2])
bi :  0
si.shape :  torch.Size([69])
ti.shape :  torch.Size([69])
s_pos.shape :  torch.Size([69, 3])
t_pos.shape :  torch.Size([69, 3])
number of true landmarks correspondences returned from KNN matching :  10  out of  69
fraction of true landmark correspondences returned from KNN matching :  0.14492753623188406
vec6d.shape :  torch.Size([69, 6])
ldmk_s.shape :  torch.Size([69, 3])
ldmk_t.shape :  torch.Size([69, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([69, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.953 
full-AccS: 0.057 
full-AccR: 1.354 
full-outlier: 97.329 
vis-epe: 17.401 
vis-AccS: 0.114 
vis-AccR: 1.068 
vis-outlier: 98.474 
occ-epe: 8.502 
occ-AccS: 0.000 
occ-AccR: 1.641 
occ-outlier: 96.183 

Actual rotation :  [[-0.57899306  0.15459214 -0.80054251]
 [-0.44369772 -0.88348371  0.15029591]
 [-0.6840317   0.44221917  0.58012312]]
Actual translation :  [0.3859729  1.90526434 0.1799051 ]
Predicted rotation :  [[ 0.45073635  0.75413449  0.47761717]
 [-0.58075055  0.65407247 -0.48468361]
 [-0.67791276 -0.05891185  0.73277817]]
Predicted translation :  [-0.04722264  0.00891144  0.04248311]
Relative Rotation Error :  2.12763489067112
Relative Translation Error :  1.9500506378576732
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08093840088635214
Strict IR :  0.0
Relaxed IR :  0.03605494086226631
model 126
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([129, 528])
F1.shape : torch.Size([129, 528])
ldmk_t_indices :  tensor([ 14, 119,  21, 115, 119,  31,  48,  73,  76, 125, 125,  18,  18,  12,
         60, 119,  82, 113, 115,  85,  78, 119,  12, 127, 119,  78, 126,  29,
        115, 108, 115, 119,  84, 115,  84, 114,  12, 119,  25, 124,  35,  12,
        119, 114, 108, 119,  53, 125,  50,  84, 128, 128, 127,  92,  14, 119,
         29,  60,  78, 119,  21, 113,  82, 103,  83,  53,  30,  12,  99, 119,
         12,  60,  41,  17,  85, 127, 128, 103,  76,  12,  83,  81, 114, 119,
         30, 125,  49,  70, 119,  18, 119,  18,  14, 113, 103, 119, 127, 103,
         12,  81,  83, 103,  65, 110,  65,  86,  14,  92,  49,  41, 108, 110,
        108,  30,  60,  91,  60, 119,  56, 119,  81, 119,  95,  84,  12,  81,
        123, 115,  83], device='cuda:0')
ldmk_s.shape :  torch.Size([129, 3])
ldmk_t.shape :  torch.Size([129, 3])
vec_6d.shape :  torch.Size([129, 6])
ind.shape :  torch.Size([1, 129, 2])
bi :  0
si.shape :  torch.Size([129])
ti.shape :  torch.Size([129])
s_pos.shape :  torch.Size([129, 3])
t_pos.shape :  torch.Size([129, 3])
ind.shape :  torch.Size([1, 129, 2])
bi :  0
si.shape :  torch.Size([129])
ti.shape :  torch.Size([129])
s_pos.shape :  torch.Size([129, 3])
t_pos.shape :  torch.Size([129, 3])
number of true landmarks correspondences returned from KNN matching :  10  out of  129
fraction of true landmark correspondences returned from KNN matching :  0.07751937984496124
vec6d.shape :  torch.Size([129, 6])
ldmk_s.shape :  torch.Size([129, 3])
ldmk_t.shape :  torch.Size([129, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([129, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.748 
full-AccS: 0.012 
full-AccR: 1.989 
full-outlier: 92.968 
vis-epe: 16.753 
vis-AccS: 0.000 
vis-AccR: 0.022 
vis-outlier: 98.854 
occ-epe: 12.363 
occ-AccS: 0.026 
occ-AccR: 4.328 
occ-outlier: 85.965 

Actual rotation :  [[ 0.24307924  0.85381521 -0.46033908]
 [-0.25108054  0.51378222  0.82035748]
 [ 0.93694773 -0.08382969  0.33926617]]
Actual translation :  [ 0.76110673 -0.4081355  -0.54307167]
Predicted rotation :  [[ 0.51399032  0.80809597 -0.28774075]
 [-0.71775475  0.588846    0.37160272]
 [ 0.46972562  0.01552711  0.88267601]]
Predicted translation :  [-0.01789899  0.11834559  0.00241796]
Relative Rotation Error :  0.7427432557812654
Relative Translation Error :  1.087010211743606
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1103903844758521
Strict IR :  0.00802587446094873
Relaxed IR :  0.08756588404408241
model 167
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([54, 528])
F1.shape : torch.Size([52, 528])
ldmk_t_indices :  tensor([22,  4, 40, 25, 22,  3,  4, 47, 18,  1, 18, 51, 51, 18, 51, 27, 43,  2,
        22, 39, 17, 12, 18, 34, 17,  1, 33, 17, 17,  1, 18, 14, 38,  4, 24, 51,
        38, 40, 48, 27, 42, 40, 42, 48, 17, 51, 39, 32, 51, 48, 48, 18, 27, 42],
       device='cuda:0')
ldmk_s.shape :  torch.Size([54, 3])
ldmk_t.shape :  torch.Size([54, 3])
vec_6d.shape :  torch.Size([54, 6])
ind.shape :  torch.Size([1, 54, 2])
bi :  0
si.shape :  torch.Size([54])
ti.shape :  torch.Size([54])
s_pos.shape :  torch.Size([54, 3])
t_pos.shape :  torch.Size([54, 3])
ind.shape :  torch.Size([1, 54, 2])
bi :  0
si.shape :  torch.Size([54])
ti.shape :  torch.Size([54])
s_pos.shape :  torch.Size([54, 3])
t_pos.shape :  torch.Size([54, 3])
number of true landmarks correspondences returned from KNN matching :  4  out of  54
fraction of true landmark correspondences returned from KNN matching :  0.07407407407407407
vec6d.shape :  torch.Size([54, 6])
ldmk_s.shape :  torch.Size([54, 3])
ldmk_t.shape :  torch.Size([54, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([54, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.444 
full-AccS: 0.000 
full-AccR: 0.179 
full-outlier: 99.030 
vis-epe: 16.644 
vis-AccS: 0.000 
vis-AccR: 0.344 
vis-outlier: 98.378 
occ-epe: 12.067 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.735 

Actual rotation :  [[-0.99327492 -0.01998061  0.11404261]
 [ 0.03301676  0.8952149   0.44440992]
 [-0.11097222  0.44518654 -0.88853481]]
Actual translation :  [ 1.44910973 -0.21174583  0.20930933]
Predicted rotation :  [[ 0.79327981  0.54152838  0.2783059 ]
 [-0.59828178  0.60847754  0.5213578 ]
 [ 0.11298716 -0.58008799  0.80667949]]
Predicted translation :  [0.00116066 0.00325043 0.00850798]
Relative Rotation Error :  3.09591018951252
Relative Translation Error :  1.4775320888845307
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11467223768252914
Strict IR :  0.0025516713447307987
Relaxed IR :  0.024496044909415666
model 207
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.1
preprocessing :  mutual
confidence threshold used in the matching :  0.1
preprocessing :  mutual
F0.shape : torch.Size([47, 528])
F1.shape : torch.Size([62, 528])
ldmk_t_indices :  tensor([14, 54, 14, 20, 54, 11,  6, 60, 41, 14,  4, 49, 14, 31, 54,  0, 14, 54,
         6, 10, 54, 54, 15, 54,  6, 43,  0, 41, 54, 14,  6, 10, 14, 59, 54, 11,
         0, 59, 14, 11,  9, 54, 49, 14, 57,  6,  6], device='cuda:0')
ldmk_s.shape :  torch.Size([47, 3])
ldmk_t.shape :  torch.Size([47, 3])
vec_6d.shape :  torch.Size([47, 6])
ind.shape :  torch.Size([1, 47, 2])
bi :  0
si.shape :  torch.Size([47])
ti.shape :  torch.Size([47])
s_pos.shape :  torch.Size([47, 3])
t_pos.shape :  torch.Size([47, 3])
ind.shape :  torch.Size([1, 47, 2])
bi :  0
si.shape :  torch.Size([47])
ti.shape :  torch.Size([47])
s_pos.shape :  torch.Size([47, 3])
t_pos.shape :  torch.Size([47, 3])
number of true landmarks correspondences returned from KNN matching :  4  out of  47
fraction of true landmark correspondences returned from KNN matching :  0.0851063829787234
vec6d.shape :  torch.Size([47, 6])
ldmk_s.shape :  torch.Size([47, 3])
ldmk_t.shape :  torch.Size([47, 3])
k0 :  -8
levels :  10
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([47, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.407 
full-AccS: 0.000 
full-AccR: 2.511 
full-outlier: 33.681 
vis-epe: 14.369 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 54.651 
occ-epe: 7.432 
occ-AccS: 0.000 
occ-AccR: 5.879 
occ-outlier: 5.546 

Actual rotation :  [[-0.87307663 -0.48120204  0.07862435]
 [ 0.28082325 -0.36444525  0.88787272]
 [-0.39859189  0.79726047  0.45332135]]
Actual translation :  [1.8123437  0.01131148 0.68376541]
Predicted rotation :  [[ 0.32394664  0.19686142  0.92536721]
 [ 0.87444447 -0.43564902 -0.21344055]
 [ 0.36111696  0.87832543 -0.31327142]]
Predicted translation :  [ 0.03194001 -0.09698568  0.06251647]
Relative Rotation Error :  1.9154142757224548
Relative Translation Error :  1.8887868635547438
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07477203258111446
Strict IR :  0.0037896731406916154
Relaxed IR :  0.11061108479393653
