model 002 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4980, 32])
F1.shape : torch.Size([4883, 32])
ldmk_t_indices :  tensor([4806, 4806, 1730,  ..., 1283, 1012, 3461], device='cuda:0')
ldmk_s.shape :  torch.Size([4980, 3])
ldmk_t.shape :  torch.Size([4980, 3])
vec_6d.shape :  torch.Size([4980, 6])
ind.shape :  torch.Size([1, 4980, 2])
bi :  0
si.shape :  torch.Size([4980])
ti.shape :  torch.Size([4980])
s_pos.shape :  torch.Size([4980, 3])
t_pos.shape :  torch.Size([4980, 3])
ind.shape :  torch.Size([1, 4980, 2])
bi :  0
si.shape :  torch.Size([4980])
ti.shape :  torch.Size([4980])
s_pos.shape :  torch.Size([4980, 3])
t_pos.shape :  torch.Size([4980, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1900  out of  4980
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.3815261044176707
vec6d.shape :  torch.Size([4980, 6])
ldmk_s.shape :  torch.Size([4980, 3])
ldmk_t.shape :  torch.Size([4980, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4980, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.711 
full-AccS: 0.095 
full-AccR: 1.324 
full-outlier: 75.210 
vis-epe: 15.222 
vis-AccS: 0.204 
vis-AccR: 1.651 
vis-outlier: 91.814 
occ-epe: 8.666 
occ-AccS: 0.000 
occ-AccR: 1.040 
occ-outlier: 60.808 

Actual rotation :  [[-0.40974485 -0.0177874  -0.91202674]
 [ 0.82672423  0.41532003 -0.37952117]
 [ 0.38553367 -0.90950145 -0.15546996]]
Actual translation :  [ 1.97322969 -0.31353126  0.18591825]
Predicted rotation :  [[-4.10038608e-01 -1.18372014e-01 -9.04354140e-01]
 [ 8.68290396e-01  2.52842056e-01 -4.26781917e-01]
 [ 2.79177862e-01 -9.60239220e-01 -8.93781484e-04]]
Predicted translation :  [ 0.00641009 -0.08761542  0.04195606]
Relative Rotation Error :  0.1982077749821554
Relative Translation Error :  1.9849791963145043
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07629067454822663
Strict IR :  0.007247899159663866
Relaxed IR :  0.08865546218487395
model 042 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4933, 32])
F1.shape : torch.Size([5209, 32])
ldmk_t_indices :  tensor([5078, 1578, 1547,  ..., 2095, 2095, 1950], device='cuda:0')
ldmk_s.shape :  torch.Size([4933, 3])
ldmk_t.shape :  torch.Size([4933, 3])
vec_6d.shape :  torch.Size([4933, 6])
ind.shape :  torch.Size([1, 4933, 2])
bi :  0
si.shape :  torch.Size([4933])
ti.shape :  torch.Size([4933])
s_pos.shape :  torch.Size([4933, 3])
t_pos.shape :  torch.Size([4933, 3])
ind.shape :  torch.Size([1, 4933, 2])
bi :  0
si.shape :  torch.Size([4933])
ti.shape :  torch.Size([4933])
s_pos.shape :  torch.Size([4933, 3])
t_pos.shape :  torch.Size([4933, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1192  out of  4933
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.24163794851003445
vec6d.shape :  torch.Size([4933, 6])
ldmk_s.shape :  torch.Size([4933, 3])
ldmk_t.shape :  torch.Size([4933, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4933, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.190 
full-AccS: 0.215 
full-AccR: 2.635 
full-outlier: 94.549 
vis-epe: 19.519 
vis-AccS: 0.047 
vis-AccR: 1.604 
vis-outlier: 97.539 
occ-epe: 7.366 
occ-AccS: 0.661 
occ-AccR: 5.367 
occ-outlier: 86.623 

Actual rotation :  [[-0.87462848 -0.4705988  -0.11645507]
 [ 0.24256895 -0.63279443  0.73534448]
 [-0.41974435  0.61490485  0.66761269]]
Actual translation :  [ 1.20593496  0.83257865 -0.4390415 ]
Predicted rotation :  [[-0.84683303 -0.43845674 -0.30104799]
 [ 0.18210424 -0.77084652  0.61043761]
 [-0.49971219  0.46211655  0.7326229 ]]
Predicted translation :  [ 0.0493886  -0.04891639  0.02085984]
Relative Rotation Error :  0.23307907606568
Relative Translation Error :  1.5251695734986017
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06416837662834224
Strict IR :  0.007689698066267104
Relaxed IR :  0.16284066493271515
model 085 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([2677, 32])
F1.shape : torch.Size([2310, 32])
ldmk_t_indices :  tensor([ 40,  24,  46,  ..., 978, 965, 702], device='cuda:0')
ldmk_s.shape :  torch.Size([2677, 3])
ldmk_t.shape :  torch.Size([2677, 3])
vec_6d.shape :  torch.Size([2677, 6])
ind.shape :  torch.Size([1, 2677, 2])
bi :  0
si.shape :  torch.Size([2677])
ti.shape :  torch.Size([2677])
s_pos.shape :  torch.Size([2677, 3])
t_pos.shape :  torch.Size([2677, 3])
ind.shape :  torch.Size([1, 2677, 2])
bi :  0
si.shape :  torch.Size([2677])
ti.shape :  torch.Size([2677])
s_pos.shape :  torch.Size([2677, 3])
t_pos.shape :  torch.Size([2677, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  329  out of  2677
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.12289876727680239
vec6d.shape :  torch.Size([2677, 6])
ldmk_s.shape :  torch.Size([2677, 3])
ldmk_t.shape :  torch.Size([2677, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2677, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.900 
full-AccS: 0.000 
full-AccR: 0.692 
full-outlier: 40.219 
vis-epe: 14.229 
vis-AccS: 0.000 
vis-AccR: 1.315 
vis-outlier: 78.737 
occ-epe: 6.515 
occ-AccS: 0.000 
occ-AccR: 0.206 
occ-outlier: 10.110 

Actual rotation :  [[-0.08515318 -0.0477966  -0.99522079]
 [-0.17928303  0.98328076 -0.03188333]
 [ 0.98010537  0.17571123 -0.0922986 ]]
Actual translation :  [ 0.67656808  0.74129062 -0.19986074]
Predicted rotation :  [[-0.10342004 -0.20178114 -0.97395522]
 [-0.75154453  0.65726979 -0.05636802]
 [ 0.6515254   0.72614104 -0.2196225 ]]
Predicted translation :  [ 0.09835644 -0.02262505 -0.01778215]
Relative Rotation Error :  0.6785286320101117
Relative Translation Error :  0.9752171332954371
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06540297158187408
Strict IR :  0.0
Relaxed IR :  0.027120600115406807
model 126 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([4642, 32])
F1.shape : torch.Size([5144, 32])
ldmk_t_indices :  tensor([4399, 4458, 4400,  ...,  860, 4108,  879], device='cuda:0')
ldmk_s.shape :  torch.Size([4642, 3])
ldmk_t.shape :  torch.Size([4642, 3])
vec_6d.shape :  torch.Size([4642, 6])
ind.shape :  torch.Size([1, 4642, 2])
bi :  0
si.shape :  torch.Size([4642])
ti.shape :  torch.Size([4642])
s_pos.shape :  torch.Size([4642, 3])
t_pos.shape :  torch.Size([4642, 3])
ind.shape :  torch.Size([1, 4642, 2])
bi :  0
si.shape :  torch.Size([4642])
ti.shape :  torch.Size([4642])
s_pos.shape :  torch.Size([4642, 3])
t_pos.shape :  torch.Size([4642, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1611  out of  4642
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.34704868591124516
vec6d.shape :  torch.Size([4642, 6])
ldmk_s.shape :  torch.Size([4642, 3])
ldmk_t.shape :  torch.Size([4642, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4642, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.909 
full-AccS: 0.000 
full-AccR: 0.569 
full-outlier: 97.700 
vis-epe: 17.975 
vis-AccS: 0.000 
vis-AccR: 0.297 
vis-outlier: 98.643 
occ-epe: 8.499 
occ-AccS: 0.000 
occ-AccR: 0.931 
occ-outlier: 96.445 

Actual rotation :  [[-0.81564788 -0.06094346 -0.57532984]
 [ 0.57678234 -0.16330348 -0.80040871]
 [-0.04517368 -0.98469176  0.16834925]]
Actual translation :  [0.89703757 1.00050158 0.50390294]
Predicted rotation :  [[-0.88276378 -0.08347401 -0.46234199]
 [ 0.46972212 -0.17658426 -0.86497334]
 [-0.00943956 -0.9807395   0.19509184]]
Predicted translation :  [ 0.05524851  0.05708201 -0.03187649]
Relative Rotation Error :  0.1335034779115299
Relative Translation Error :  1.3732111594802756
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06984846428348875
Strict IR :  0.002542372881355932
Relaxed IR :  0.13486682808716707
model 167 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([1999, 32])
F1.shape : torch.Size([2143, 32])
ldmk_t_indices :  tensor([2053, 2053, 2060,  ..., 2042, 1291,  694], device='cuda:0')
ldmk_s.shape :  torch.Size([1999, 3])
ldmk_t.shape :  torch.Size([1999, 3])
vec_6d.shape :  torch.Size([1999, 6])
ind.shape :  torch.Size([1, 1999, 2])
bi :  0
si.shape :  torch.Size([1999])
ti.shape :  torch.Size([1999])
s_pos.shape :  torch.Size([1999, 3])
t_pos.shape :  torch.Size([1999, 3])
ind.shape :  torch.Size([1, 1999, 2])
bi :  0
si.shape :  torch.Size([1999])
ti.shape :  torch.Size([1999])
s_pos.shape :  torch.Size([1999, 3])
t_pos.shape :  torch.Size([1999, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  916  out of  1999
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.45822911455727866
vec6d.shape :  torch.Size([1999, 6])
ldmk_s.shape :  torch.Size([1999, 3])
ldmk_t.shape :  torch.Size([1999, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1999, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.222 
full-AccS: 0.230 
full-AccR: 15.463 
full-outlier: 85.404 
vis-epe: 10.664 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 5.044 
occ-AccS: 0.528 
occ-AccR: 35.584 
occ-outlier: 66.412 

Actual rotation :  [[-0.81029619  0.58572329  0.0186628 ]
 [ 0.42981428  0.61565456 -0.66047646]
 [-0.39834628 -0.52716002 -0.75061478]]
Actual translation :  [0.2961076  0.17846237 1.41276713]
Predicted rotation :  [[-0.64810158  0.76138944  0.01582035]
 [ 0.63784687  0.55405654 -0.53495104]
 [-0.41607149 -0.33661175 -0.84473481]]
Predicted translation :  [ 0.01706563  0.05377373 -0.02307018]
Relative Rotation Error :  0.2886502158201656
Relative Translation Error :  1.4680056036135105
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.046801882111906994
Strict IR :  0.03266139321255422
Relaxed IR :  0.517734115845879
model 207 file1 020 file2 104
0 to 1
feature_extractor :  fcgf
feature extractor inside of get_dataloader :  fcgf
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  fcgf
coarse_level :  None


knn_matching :  True
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
confidence threshold used in the matching :  0.0001
preprocessing :  mutual
F0.shape : torch.Size([2183, 32])
F1.shape : torch.Size([2080, 32])
ldmk_t_indices :  tensor([  94, 1192,  108,  ...,  344,  473, 1205], device='cuda:0')
ldmk_s.shape :  torch.Size([2183, 3])
ldmk_t.shape :  torch.Size([2183, 3])
vec_6d.shape :  torch.Size([2183, 6])
ind.shape :  torch.Size([1, 2183, 2])
bi :  0
si.shape :  torch.Size([2183])
ti.shape :  torch.Size([2183])
s_pos.shape :  torch.Size([2183, 3])
t_pos.shape :  torch.Size([2183, 3])
ind.shape :  torch.Size([1, 2183, 2])
bi :  0
si.shape :  torch.Size([2183])
ti.shape :  torch.Size([2183])
s_pos.shape :  torch.Size([2183, 3])
t_pos.shape :  torch.Size([2183, 3])
number of true landmarks correspondences returned from FCGF based KNN matching :  1167  out of  2183
fraction of true landmark correspondences returned from FCGF based KNN matching :  0.5345854328905176
vec6d.shape :  torch.Size([2183, 6])
ldmk_s.shape :  torch.Size([2183, 3])
ldmk_t.shape :  torch.Size([2183, 3])
k0 :  -8
levels :  8
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2183, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.845 
full-AccS: 0.000 
full-AccR: 3.197 
full-outlier: 26.035 
vis-epe: 11.225 
vis-AccS: 0.000 
vis-AccR: 0.871 
vis-outlier: 46.821 
occ-epe: 5.864 
occ-AccS: 0.000 
occ-AccR: 6.110 
occ-outlier: 0.000 

Actual rotation :  [[-0.32787446  0.25529739 -0.9095722 ]
 [ 0.93634976  0.21570775 -0.27698246]
 [ 0.12548888 -0.94249319 -0.30977271]]
Actual translation :  [0.74584319 0.0201462  0.21741575]
Predicted rotation :  [[-0.52193225  0.10690115 -0.84626152]
 [ 0.83754907  0.25212638 -0.48471003]
 [ 0.16154878 -0.96177145 -0.22112788]]
Predicted translation :  [-0.06008303  0.00853893 -0.01499025]
Relative Rotation Error :  0.25312032748233776
Relative Translation Error :  0.8388470303573416
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04982469920505926
Strict IR :  0.028336158876241222
Relaxed IR :  0.2727052555098087
