model 002
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  85  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.017
vec6d.shape :  torch.Size([3400, 6])
ldmk_s.shape :  torch.Size([3400, 3])
ldmk_t.shape :  torch.Size([3400, 3])
number of true landmark correspondences returned from Outlier Rejection :  75  out of  3400
fraction of true landmark correspondences returned from Outlier Rejection :  0.022058823529411766
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3400, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.942 
full-AccS: 0.034 
full-AccR: 0.797 
full-outlier: 95.490 
vis-epe: 18.942 
vis-AccS: 0.034 
vis-AccR: 0.797 
vis-outlier: 95.490 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.035521486423300996
Strict IR :  0.010512037978975925
Relaxed IR :  0.3923363852153272
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  84  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0168
vec6d.shape :  torch.Size([3206, 6])
ldmk_s.shape :  torch.Size([3206, 3])
ldmk_t.shape :  torch.Size([3206, 3])
number of true landmark correspondences returned from Outlier Rejection :  66  out of  3206
fraction of true landmark correspondences returned from Outlier Rejection :  0.020586400499064253
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3206, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.139 
full-AccS: 0.000 
full-AccR: 1.765 
full-outlier: 39.307 
vis-epe: 12.436 
vis-AccS: 0.000 
vis-AccR: 1.832 
vis-outlier: 84.622 
occ-epe: 4.413 
occ-AccS: 0.000 
occ-AccR: 1.707 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04167875749363714
Strict IR :  0.0
Relaxed IR :  0.15546218487394958
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  96  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0192
vec6d.shape :  torch.Size([4304, 6])
ldmk_s.shape :  torch.Size([4304, 3])
ldmk_t.shape :  torch.Size([4304, 3])
number of true landmark correspondences returned from Outlier Rejection :  83  out of  4304
fraction of true landmark correspondences returned from Outlier Rejection :  0.01928438661710037
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4304, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.578 
full-AccS: 0.000 
full-AccR: 0.051 
full-outlier: 91.736 
vis-epe: 23.208 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 94.472 
occ-epe: 9.873 
occ-AccS: 0.000 
occ-AccR: 1.075 
occ-outlier: 36.559 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10739565271618855
Strict IR :  0.001226993865030675
Relaxed IR :  0.015746421267893662
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  73  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0146
vec6d.shape :  torch.Size([3916, 6])
ldmk_s.shape :  torch.Size([3916, 3])
ldmk_t.shape :  torch.Size([3916, 3])
number of true landmark correspondences returned from Outlier Rejection :  66  out of  3916
fraction of true landmark correspondences returned from Outlier Rejection :  0.016853932584269662
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3916, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.080 
full-AccS: 0.000 
full-AccR: 7.047 
full-outlier: 49.403 
vis-epe: 13.186 
vis-AccS: 0.000 
vis-AccR: 0.165 
vis-outlier: 99.196 
occ-epe: 3.884 
occ-AccS: 0.000 
occ-AccR: 12.701 
occ-outlier: 8.487 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03855636818348539
Strict IR :  0.0
Relaxed IR :  0.21705756929637526
model 002
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  85  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.017
vec6d.shape :  torch.Size([3400, 6])
ldmk_s.shape :  torch.Size([3400, 3])
ldmk_t.shape :  torch.Size([3400, 3])
number of true landmark correspondences returned from Outlier Rejection :  75  out of  3400
fraction of true landmark correspondences returned from Outlier Rejection :  0.022058823529411766
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3400, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.942 
full-AccS: 0.034 
full-AccR: 0.797 
full-outlier: 95.490 
vis-epe: 18.942 
vis-AccS: 0.034 
vis-AccR: 0.797 
vis-outlier: 95.490 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.035521486423300996
Strict IR :  0.010512037978975925
Relaxed IR :  0.3923363852153272
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  84  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0168
vec6d.shape :  torch.Size([3206, 6])
ldmk_s.shape :  torch.Size([3206, 3])
ldmk_t.shape :  torch.Size([3206, 3])
number of true landmark correspondences returned from Outlier Rejection :  66  out of  3206
fraction of true landmark correspondences returned from Outlier Rejection :  0.020586400499064253
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3206, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.139 
full-AccS: 0.000 
full-AccR: 1.765 
full-outlier: 39.307 
vis-epe: 12.436 
vis-AccS: 0.000 
vis-AccR: 1.832 
vis-outlier: 84.622 
occ-epe: 4.413 
occ-AccS: 0.000 
occ-AccR: 1.707 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04167875749363714
Strict IR :  0.0
Relaxed IR :  0.15546218487394958
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  96  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0192
vec6d.shape :  torch.Size([4304, 6])
ldmk_s.shape :  torch.Size([4304, 3])
ldmk_t.shape :  torch.Size([4304, 3])
number of true landmark correspondences returned from Outlier Rejection :  83  out of  4304
fraction of true landmark correspondences returned from Outlier Rejection :  0.01928438661710037
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4304, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.578 
full-AccS: 0.000 
full-AccR: 0.051 
full-outlier: 91.736 
vis-epe: 23.208 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 94.472 
occ-epe: 9.873 
occ-AccS: 0.000 
occ-AccR: 1.075 
occ-outlier: 36.559 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10739565271618855
Strict IR :  0.001226993865030675
Relaxed IR :  0.015746421267893662
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  73  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0146
vec6d.shape :  torch.Size([3916, 6])
ldmk_s.shape :  torch.Size([3916, 3])
ldmk_t.shape :  torch.Size([3916, 3])
number of true landmark correspondences returned from Outlier Rejection :  66  out of  3916
fraction of true landmark correspondences returned from Outlier Rejection :  0.016853932584269662
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3916, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.080 
full-AccS: 0.000 
full-AccR: 7.047 
full-outlier: 49.403 
vis-epe: 13.186 
vis-AccS: 0.000 
vis-AccR: 0.165 
vis-outlier: 99.196 
occ-epe: 3.884 
occ-AccS: 0.000 
occ-AccR: 12.701 
occ-outlier: 8.487 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03855636818348539
Strict IR :  0.0
Relaxed IR :  0.21705756929637526
model 002
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([4458, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4458])
ti.shape :  torch.Size([4458])
s_pos.shape :  torch.Size([4458, 3])
t_pos.shape :  torch.Size([4458, 3])
ind.shape :  torch.Size([4458, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4458])
ti.shape :  torch.Size([4458])
s_pos.shape :  torch.Size([4458, 3])
t_pos.shape :  torch.Size([4458, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  4458
fraction of true landmark correspondences returned from Lepard :  0.01816958277254374
vec6d.shape :  torch.Size([3046, 6])
ldmk_s.shape :  torch.Size([3046, 3])
ldmk_t.shape :  torch.Size([3046, 3])
number of true landmark correspondences returned from Outlier Rejection :  71  out of  3046
fraction of true landmark correspondences returned from Outlier Rejection :  0.023309258043335522
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3046, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.983 
full-AccS: 0.051 
full-AccR: 0.797 
full-outlier: 95.541 
vis-epe: 18.983 
vis-AccS: 0.051 
vis-AccR: 0.797 
vis-outlier: 95.541 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03581350152088356
Strict IR :  0.007968802984062395
Relaxed IR :  0.38741946422516105
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3348, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3348])
ti.shape :  torch.Size([3348])
s_pos.shape :  torch.Size([3348, 3])
t_pos.shape :  torch.Size([3348, 3])
ind.shape :  torch.Size([3348, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3348])
ti.shape :  torch.Size([3348])
s_pos.shape :  torch.Size([3348, 3])
t_pos.shape :  torch.Size([3348, 3])
number of true landmarks correspondences returned from Lepard :  77  out of  3348
fraction of true landmark correspondences returned from Lepard :  0.022998805256869773
vec6d.shape :  torch.Size([2209, 6])
ldmk_s.shape :  torch.Size([2209, 3])
ldmk_t.shape :  torch.Size([2209, 3])
number of true landmark correspondences returned from Outlier Rejection :  59  out of  2209
fraction of true landmark correspondences returned from Outlier Rejection :  0.026708918062471707
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2209, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.021 
full-AccS: 0.000 
full-AccR: 0.588 
full-outlier: 39.811 
vis-epe: 12.453 
vis-AccS: 0.000 
vis-AccR: 0.972 
vis-outlier: 85.708 
occ-epe: 4.177 
occ-AccS: 0.000 
occ-AccR: 0.255 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04022561812440937
Strict IR :  0.0
Relaxed IR :  0.07153361344537815
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3968, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3968])
ti.shape :  torch.Size([3968])
s_pos.shape :  torch.Size([3968, 3])
t_pos.shape :  torch.Size([3968, 3])
ind.shape :  torch.Size([3968, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3968])
ti.shape :  torch.Size([3968])
s_pos.shape :  torch.Size([3968, 3])
t_pos.shape :  torch.Size([3968, 3])
number of true landmarks correspondences returned from Lepard :  89  out of  3968
fraction of true landmark correspondences returned from Lepard :  0.02242943548387097
vec6d.shape :  torch.Size([3432, 6])
ldmk_s.shape :  torch.Size([3432, 3])
ldmk_t.shape :  torch.Size([3432, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  3432
fraction of true landmark correspondences returned from Outlier Rejection :  0.022144522144522144
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3432, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.522 
full-AccS: 0.000 
full-AccR: 1.050 
full-outlier: 85.656 
vis-epe: 19.115 
vis-AccS: 0.000 
vis-AccR: 0.942 
vis-outlier: 89.424 
occ-epe: 6.566 
occ-AccS: 0.000 
occ-AccR: 3.226 
occ-outlier: 9.677 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.060252830449933396
Strict IR :  0.006134969325153374
Relaxed IR :  0.0703476482617587
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3431, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3431])
ti.shape :  torch.Size([3431])
s_pos.shape :  torch.Size([3431, 3])
t_pos.shape :  torch.Size([3431, 3])
ind.shape :  torch.Size([3431, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3431])
ti.shape :  torch.Size([3431])
s_pos.shape :  torch.Size([3431, 3])
t_pos.shape :  torch.Size([3431, 3])
number of true landmarks correspondences returned from Lepard :  66  out of  3431
fraction of true landmark correspondences returned from Lepard :  0.019236374234916934
vec6d.shape :  torch.Size([2681, 6])
ldmk_s.shape :  torch.Size([2681, 3])
ldmk_t.shape :  torch.Size([2681, 3])
number of true landmark correspondences returned from Outlier Rejection :  60  out of  2681
fraction of true landmark correspondences returned from Outlier Rejection :  0.02237970906378217
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2681, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.950 
full-AccS: 0.000 
full-AccR: 0.085 
full-outlier: 46.578 
vis-epe: 13.549 
vis-AccS: 0.000 
vis-AccR: 0.189 
vis-outlier: 99.126 
occ-epe: 3.349 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 3.399 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03328848967897605
Strict IR :  0.0
Relaxed IR :  0.0
model 002
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([9, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([9])
ti.shape :  torch.Size([9])
s_pos.shape :  torch.Size([9, 3])
t_pos.shape :  torch.Size([9, 3])
ind.shape :  torch.Size([9, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([9])
ti.shape :  torch.Size([9])
s_pos.shape :  torch.Size([9, 3])
t_pos.shape :  torch.Size([9, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  9
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([9, 6])
ldmk_s.shape :  torch.Size([9, 3])
ldmk_t.shape :  torch.Size([9, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  9
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([9, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.580 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.881 
vis-epe: 26.580 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.881 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.16925603926921245
Strict IR :  0.0
Relaxed IR :  0.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([71, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([71])
ti.shape :  torch.Size([71])
s_pos.shape :  torch.Size([71, 3])
t_pos.shape :  torch.Size([71, 3])
ind.shape :  torch.Size([71, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([71])
ti.shape :  torch.Size([71])
s_pos.shape :  torch.Size([71, 3])
t_pos.shape :  torch.Size([71, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  71
fraction of true landmark correspondences returned from Lepard :  0.08450704225352113
vec6d.shape :  torch.Size([56, 6])
ldmk_s.shape :  torch.Size([56, 3])
ldmk_t.shape :  torch.Size([56, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  56
fraction of true landmark correspondences returned from Outlier Rejection :  0.08928571428571429
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([56, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.358 
full-AccS: 0.000 
full-AccR: 2.426 
full-outlier: 42.920 
vis-epe: 12.850 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 92.402 
occ-epe: 4.461 
occ-AccS: 0.000 
occ-AccR: 4.531 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04249293678019756
Strict IR :  0.0005252100840336134
Relaxed IR :  0.11796218487394958
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([50, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([50])
ti.shape :  torch.Size([50])
s_pos.shape :  torch.Size([50, 3])
t_pos.shape :  torch.Size([50, 3])
ind.shape :  torch.Size([50, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([50])
ti.shape :  torch.Size([50])
s_pos.shape :  torch.Size([50, 3])
t_pos.shape :  torch.Size([50, 3])
number of true landmarks correspondences returned from Lepard :  5  out of  50
fraction of true landmark correspondences returned from Lepard :  0.1
vec6d.shape :  torch.Size([41, 6])
ldmk_s.shape :  torch.Size([41, 3])
ldmk_t.shape :  torch.Size([41, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  41
fraction of true landmark correspondences returned from Outlier Rejection :  0.12195121951219512
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([41, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 17.488 
full-AccS: 0.000 
full-AccR: 0.779 
full-outlier: 85.436 
vis-epe: 18.078 
vis-AccS: 0.000 
vis-AccR: 0.764 
vis-outlier: 89.477 
occ-epe: 5.574 
occ-AccS: 0.000 
occ-AccR: 1.075 
occ-outlier: 3.943 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05837202847037688
Strict IR :  0.0
Relaxed IR :  0.1488752556237219
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([44, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([44])
ti.shape :  torch.Size([44])
s_pos.shape :  torch.Size([44, 3])
t_pos.shape :  torch.Size([44, 3])
ind.shape :  torch.Size([44, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([44])
ti.shape :  torch.Size([44])
s_pos.shape :  torch.Size([44, 3])
t_pos.shape :  torch.Size([44, 3])
number of true landmarks correspondences returned from Lepard :  5  out of  44
fraction of true landmark correspondences returned from Lepard :  0.11363636363636363
vec6d.shape :  torch.Size([41, 6])
ldmk_s.shape :  torch.Size([41, 3])
ldmk_t.shape :  torch.Size([41, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  41
fraction of true landmark correspondences returned from Outlier Rejection :  0.12195121951219512
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([41, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.691 
full-AccS: 0.000 
full-AccR: 42.377 
full-outlier: 44.872 
vis-epe: 13.863 
vis-AccS: 0.000 
vis-AccR: 0.709 
vis-outlier: 97.991 
occ-epe: 2.620 
occ-AccS: 0.000 
occ-AccR: 76.617 
occ-outlier: 1.224 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.02649453545495531
Strict IR :  0.0
Relaxed IR :  0.8005330490405117
model 002
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 042
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  75  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.015
vec6d.shape :  torch.Size([3035, 6])
ldmk_s.shape :  torch.Size([3035, 3])
ldmk_t.shape :  torch.Size([3035, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  3035
fraction of true landmark correspondences returned from Outlier Rejection :  0.015485996705107084
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3035, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.558 
full-AccS: 0.000 
full-AccR: 0.595 
full-outlier: 97.304 
vis-epe: 22.558 
vis-AccS: 0.000 
vis-AccR: 0.595 
vis-outlier: 97.304 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15189000821945467
Strict IR :  0.0
Relaxed IR :  0.018219361107737156
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  92  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0184
vec6d.shape :  torch.Size([3835, 6])
ldmk_s.shape :  torch.Size([3835, 3])
ldmk_t.shape :  torch.Size([3835, 3])
number of true landmark correspondences returned from Outlier Rejection :  78  out of  3835
fraction of true landmark correspondences returned from Outlier Rejection :  0.020338983050847456
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3835, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.337 
full-AccS: 0.102 
full-AccR: 13.830 
full-outlier: 78.559 
vis-epe: 15.726 
vis-AccS: 0.140 
vis-AccR: 2.523 
vis-outlier: 95.468 
occ-epe: 3.350 
occ-AccS: 0.000 
occ-AccR: 43.807 
occ-outlier: 33.732 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.039454412056918374
Strict IR :  0.0006785027705529798
Relaxed IR :  0.4402352142937917
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  21  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0042
vec6d.shape :  torch.Size([3297, 6])
ldmk_s.shape :  torch.Size([3297, 3])
ldmk_t.shape :  torch.Size([3297, 3])
number of true landmark correspondences returned from Outlier Rejection :  19  out of  3297
fraction of true landmark correspondences returned from Outlier Rejection :  0.005762814680012132
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3297, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.914 
full-AccS: 0.000 
full-AccR: 0.061 
full-outlier: 97.229 
vis-epe: 23.851 
vis-AccS: 0.000 
vis-AccR: 0.095 
vis-outlier: 96.136 
occ-epe: 21.238 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.183 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18177949045816155
Strict IR :  0.004022015241320914
Relaxed IR :  0.0285774767146486
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  92  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0184
vec6d.shape :  torch.Size([3770, 6])
ldmk_s.shape :  torch.Size([3770, 3])
ldmk_t.shape :  torch.Size([3770, 3])
number of true landmark correspondences returned from Outlier Rejection :  70  out of  3770
fraction of true landmark correspondences returned from Outlier Rejection :  0.01856763925729443
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3770, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.395 
full-AccS: 0.646 
full-AccR: 6.528 
full-outlier: 87.733 
vis-epe: 13.798 
vis-AccS: 0.000 
vis-AccR: 1.655 
vis-outlier: 96.526 
occ-epe: 4.744 
occ-AccS: 2.435 
occ-AccR: 20.017 
occ-outlier: 63.392 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05004692084726731
Strict IR :  0.010843373493975903
Relaxed IR :  0.2009857612267251
model 042
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  75  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.015
vec6d.shape :  torch.Size([3035, 6])
ldmk_s.shape :  torch.Size([3035, 3])
ldmk_t.shape :  torch.Size([3035, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  3035
fraction of true landmark correspondences returned from Outlier Rejection :  0.015485996705107084
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3035, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.558 
full-AccS: 0.000 
full-AccR: 0.595 
full-outlier: 97.304 
vis-epe: 22.558 
vis-AccS: 0.000 
vis-AccR: 0.595 
vis-outlier: 97.304 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15189000821945467
Strict IR :  0.0
Relaxed IR :  0.018219361107737156
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  92  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0184
vec6d.shape :  torch.Size([3835, 6])
ldmk_s.shape :  torch.Size([3835, 3])
ldmk_t.shape :  torch.Size([3835, 3])
number of true landmark correspondences returned from Outlier Rejection :  78  out of  3835
fraction of true landmark correspondences returned from Outlier Rejection :  0.020338983050847456
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3835, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.337 
full-AccS: 0.102 
full-AccR: 13.830 
full-outlier: 78.559 
vis-epe: 15.726 
vis-AccS: 0.140 
vis-AccR: 2.523 
vis-outlier: 95.468 
occ-epe: 3.350 
occ-AccS: 0.000 
occ-AccR: 43.807 
occ-outlier: 33.732 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.039454412056918374
Strict IR :  0.0006785027705529798
Relaxed IR :  0.4402352142937917
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  21  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0042
vec6d.shape :  torch.Size([3297, 6])
ldmk_s.shape :  torch.Size([3297, 3])
ldmk_t.shape :  torch.Size([3297, 3])
number of true landmark correspondences returned from Outlier Rejection :  19  out of  3297
fraction of true landmark correspondences returned from Outlier Rejection :  0.005762814680012132
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3297, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.914 
full-AccS: 0.000 
full-AccR: 0.061 
full-outlier: 97.229 
vis-epe: 23.851 
vis-AccS: 0.000 
vis-AccR: 0.095 
vis-outlier: 96.136 
occ-epe: 21.238 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.183 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18177949045816155
Strict IR :  0.004022015241320914
Relaxed IR :  0.0285774767146486
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  92  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0184
vec6d.shape :  torch.Size([3770, 6])
ldmk_s.shape :  torch.Size([3770, 3])
ldmk_t.shape :  torch.Size([3770, 3])
number of true landmark correspondences returned from Outlier Rejection :  70  out of  3770
fraction of true landmark correspondences returned from Outlier Rejection :  0.01856763925729443
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3770, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.395 
full-AccS: 0.646 
full-AccR: 6.528 
full-outlier: 87.733 
vis-epe: 13.798 
vis-AccS: 0.000 
vis-AccR: 1.655 
vis-outlier: 96.526 
occ-epe: 4.744 
occ-AccS: 2.435 
occ-AccR: 20.017 
occ-outlier: 63.392 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05004692084726731
Strict IR :  0.010843373493975903
Relaxed IR :  0.2009857612267251
model 042
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3885, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3885])
ti.shape :  torch.Size([3885])
s_pos.shape :  torch.Size([3885, 3])
t_pos.shape :  torch.Size([3885, 3])
ind.shape :  torch.Size([3885, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3885])
ti.shape :  torch.Size([3885])
s_pos.shape :  torch.Size([3885, 3])
t_pos.shape :  torch.Size([3885, 3])
number of true landmarks correspondences returned from Lepard :  66  out of  3885
fraction of true landmark correspondences returned from Lepard :  0.01698841698841699
vec6d.shape :  torch.Size([2387, 6])
ldmk_s.shape :  torch.Size([2387, 3])
ldmk_t.shape :  torch.Size([2387, 3])
number of true landmark correspondences returned from Outlier Rejection :  42  out of  2387
fraction of true landmark correspondences returned from Outlier Rejection :  0.017595307917888565
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2387, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.512 
full-AccS: 0.049 
full-AccR: 0.413 
full-outlier: 97.571 
vis-epe: 19.512 
vis-AccS: 0.049 
vis-AccR: 0.413 
vis-outlier: 97.571 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1426662936755799
Strict IR :  0.006316045184015547
Relaxed IR :  0.04202599295518037
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3297, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3297])
ti.shape :  torch.Size([3297])
s_pos.shape :  torch.Size([3297, 3])
t_pos.shape :  torch.Size([3297, 3])
ind.shape :  torch.Size([3297, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3297])
ti.shape :  torch.Size([3297])
s_pos.shape :  torch.Size([3297, 3])
t_pos.shape :  torch.Size([3297, 3])
number of true landmarks correspondences returned from Lepard :  85  out of  3297
fraction of true landmark correspondences returned from Lepard :  0.025781013042159538
vec6d.shape :  torch.Size([2595, 6])
ldmk_s.shape :  torch.Size([2595, 3])
ldmk_t.shape :  torch.Size([2595, 3])
number of true landmark correspondences returned from Outlier Rejection :  73  out of  2595
fraction of true landmark correspondences returned from Outlier Rejection :  0.02813102119460501
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2595, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.079 
full-AccS: 0.057 
full-AccR: 15.334 
full-outlier: 75.155 
vis-epe: 15.477 
vis-AccS: 0.078 
vis-AccR: 2.601 
vis-outlier: 95.343 
occ-epe: 3.069 
occ-AccS: 0.000 
occ-AccR: 49.092 
occ-outlier: 21.635 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03793242750931003
Strict IR :  0.0041841004184100415
Relaxed IR :  0.4809453805269705
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3445, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3445])
ti.shape :  torch.Size([3445])
s_pos.shape :  torch.Size([3445, 3])
t_pos.shape :  torch.Size([3445, 3])
ind.shape :  torch.Size([3445, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3445])
ti.shape :  torch.Size([3445])
s_pos.shape :  torch.Size([3445, 3])
t_pos.shape :  torch.Size([3445, 3])
number of true landmarks correspondences returned from Lepard :  15  out of  3445
fraction of true landmark correspondences returned from Lepard :  0.0043541364296081275
vec6d.shape :  torch.Size([2339, 6])
ldmk_s.shape :  torch.Size([2339, 3])
ldmk_t.shape :  torch.Size([2339, 3])
number of true landmark correspondences returned from Outlier Rejection :  13  out of  2339
fraction of true landmark correspondences returned from Outlier Rejection :  0.0055579307396323215
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2339, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.720 
full-AccS: 0.000 
full-AccR: 0.037 
full-outlier: 97.217 
vis-epe: 23.716 
vis-AccS: 0.000 
vis-AccR: 0.057 
vis-outlier: 96.231 
occ-epe: 20.940 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 98.979 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18055626914060358
Strict IR :  0.002540220152413209
Relaxed IR :  0.02307366638441998
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3242, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3242])
ti.shape :  torch.Size([3242])
s_pos.shape :  torch.Size([3242, 3])
t_pos.shape :  torch.Size([3242, 3])
ind.shape :  torch.Size([3242, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3242])
ti.shape :  torch.Size([3242])
s_pos.shape :  torch.Size([3242, 3])
t_pos.shape :  torch.Size([3242, 3])
number of true landmarks correspondences returned from Lepard :  91  out of  3242
fraction of true landmark correspondences returned from Lepard :  0.028069093152375078
vec6d.shape :  torch.Size([2516, 6])
ldmk_s.shape :  torch.Size([2516, 3])
ldmk_t.shape :  torch.Size([2516, 3])
number of true landmark correspondences returned from Outlier Rejection :  69  out of  2516
fraction of true landmark correspondences returned from Outlier Rejection :  0.027424483306836247
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2516, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.546 
full-AccS: 0.197 
full-AccR: 3.549 
full-outlier: 93.823 
vis-epe: 15.868 
vis-AccS: 0.000 
vis-AccR: 0.075 
vis-outlier: 99.165 
occ-epe: 7.117 
occ-AccS: 0.743 
occ-AccR: 13.165 
occ-outlier: 79.034 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07671996862726621
Strict IR :  0.004381161007667032
Relaxed IR :  0.08587075575027382
model 042
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([22, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([22])
ti.shape :  torch.Size([22])
s_pos.shape :  torch.Size([22, 3])
t_pos.shape :  torch.Size([22, 3])
ind.shape :  torch.Size([22, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([22])
ti.shape :  torch.Size([22])
s_pos.shape :  torch.Size([22, 3])
t_pos.shape :  torch.Size([22, 3])
number of true landmarks correspondences returned from Lepard :  4  out of  22
fraction of true landmark correspondences returned from Lepard :  0.18181818181818182
vec6d.shape :  torch.Size([21, 6])
ldmk_s.shape :  torch.Size([21, 3])
ldmk_t.shape :  torch.Size([21, 3])
number of true landmark correspondences returned from Outlier Rejection :  4  out of  21
fraction of true landmark correspondences returned from Outlier Rejection :  0.19047619047619047
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([21, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 30.319 
full-AccS: 0.000 
full-AccR: 0.121 
full-outlier: 99.405 
vis-epe: 30.319 
vis-AccS: 0.000 
vis-AccR: 0.121 
vis-outlier: 99.405 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.22218242100431904
Strict IR :  0.0
Relaxed IR :  0.014089639256650067
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([29, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([29])
ti.shape :  torch.Size([29])
s_pos.shape :  torch.Size([29, 3])
t_pos.shape :  torch.Size([29, 3])
ind.shape :  torch.Size([29, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([29])
ti.shape :  torch.Size([29])
s_pos.shape :  torch.Size([29, 3])
t_pos.shape :  torch.Size([29, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  29
fraction of true landmark correspondences returned from Lepard :  0.20689655172413793
vec6d.shape :  torch.Size([27, 6])
ldmk_s.shape :  torch.Size([27, 3])
ldmk_t.shape :  torch.Size([27, 3])
number of true landmark correspondences returned from Outlier Rejection :  6  out of  27
fraction of true landmark correspondences returned from Outlier Rejection :  0.2222222222222222
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([27, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.203 
full-AccS: 0.271 
full-AccR: 5.643 
full-outlier: 86.792 
vis-epe: 16.320 
vis-AccS: 0.047 
vis-AccR: 2.102 
vis-outlier: 95.888 
occ-epe: 4.941 
occ-AccS: 0.867 
occ-AccR: 15.029 
occ-outlier: 62.675 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05021104930656146
Strict IR :  0.01164763089449282
Relaxed IR :  0.2924346941083343
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([32, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([32])
ti.shape :  torch.Size([32])
s_pos.shape :  torch.Size([32, 3])
t_pos.shape :  torch.Size([32, 3])
ind.shape :  torch.Size([32, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([32])
ti.shape :  torch.Size([32])
s_pos.shape :  torch.Size([32, 3])
t_pos.shape :  torch.Size([32, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  32
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([32, 6])
ldmk_s.shape :  torch.Size([32, 3])
ldmk_t.shape :  torch.Size([32, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  32
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([32, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.057 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 98.267 
vis-epe: 24.072 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 97.297 
occ-epe: 21.244 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1855444156951145
Strict IR :  0.0
Relaxed IR :  0.018839966130397966
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([38, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([38])
ti.shape :  torch.Size([38])
s_pos.shape :  torch.Size([38, 3])
t_pos.shape :  torch.Size([38, 3])
ind.shape :  torch.Size([38, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([38])
ti.shape :  torch.Size([38])
s_pos.shape :  torch.Size([38, 3])
t_pos.shape :  torch.Size([38, 3])
number of true landmarks correspondences returned from Lepard :  3  out of  38
fraction of true landmark correspondences returned from Lepard :  0.07894736842105263
vec6d.shape :  torch.Size([35, 6])
ldmk_s.shape :  torch.Size([35, 3])
ldmk_t.shape :  torch.Size([35, 3])
number of true landmark correspondences returned from Outlier Rejection :  3  out of  35
fraction of true landmark correspondences returned from Outlier Rejection :  0.08571428571428572
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([35, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.692 
full-AccS: 0.000 
full-AccR: 6.857 
full-outlier: 86.627 
vis-epe: 13.016 
vis-AccS: 0.000 
vis-AccR: 1.416 
vis-outlier: 96.273 
occ-epe: 4.258 
occ-AccS: 0.000 
occ-AccR: 21.915 
occ-outlier: 59.926 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03967498087609597
Strict IR :  0.014895947426067908
Relaxed IR :  0.33767798466593646
model 042
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 085
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  46  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0092
vec6d.shape :  torch.Size([3355, 6])
ldmk_s.shape :  torch.Size([3355, 3])
ldmk_t.shape :  torch.Size([3355, 3])
number of true landmark correspondences returned from Outlier Rejection :  27  out of  3355
fraction of true landmark correspondences returned from Outlier Rejection :  0.00804769001490313
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3355, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 27.162 
full-AccS: 0.134 
full-AccR: 0.758 
full-outlier: 98.886 
vis-epe: 27.162 
vis-AccS: 0.134 
vis-AccR: 0.758 
vis-outlier: 98.886 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.16218843749247583
Strict IR :  0.00267379679144385
Relaxed IR :  0.021836007130124777
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4159, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4159])
ti.shape :  torch.Size([4159])
s_pos.shape :  torch.Size([4159, 3])
t_pos.shape :  torch.Size([4159, 3])
ind.shape :  torch.Size([4159, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4159])
ti.shape :  torch.Size([4159])
s_pos.shape :  torch.Size([4159, 3])
t_pos.shape :  torch.Size([4159, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  4159
fraction of true landmark correspondences returned from Lepard :  0.013705217600384708
vec6d.shape :  torch.Size([3381, 6])
ldmk_s.shape :  torch.Size([3381, 3])
ldmk_t.shape :  torch.Size([3381, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  3381
fraction of true landmark correspondences returned from Outlier Rejection :  0.013901212658976633
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3381, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.042 
full-AccS: 0.000 
full-AccR: 1.135 
full-outlier: 76.822 
vis-epe: 18.674 
vis-AccS: 0.000 
vis-AccR: 0.438 
vis-outlier: 81.236 
occ-epe: 13.984 
occ-AccS: 0.000 
occ-AccR: 1.679 
occ-outlier: 73.372 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14097763435858976
Strict IR :  0.0
Relaxed IR :  0.023850740527024426
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  46  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0092
vec6d.shape :  torch.Size([3332, 6])
ldmk_s.shape :  torch.Size([3332, 3])
ldmk_t.shape :  torch.Size([3332, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  3332
fraction of true landmark correspondences returned from Outlier Rejection :  0.009903961584633853
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3332, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.042 
full-AccS: 0.045 
full-AccR: 2.094 
full-outlier: 77.317 
vis-epe: 13.947 
vis-AccS: 0.000 
vis-AccR: 0.996 
vis-outlier: 88.239 
occ-epe: 7.234 
occ-AccS: 0.157 
occ-AccR: 4.867 
occ-outlier: 49.765 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.055842375245926966
Strict IR :  0.01610824742268041
Relaxed IR :  0.18363402061855671
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4121, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4121])
ti.shape :  torch.Size([4121])
s_pos.shape :  torch.Size([4121, 3])
t_pos.shape :  torch.Size([4121, 3])
ind.shape :  torch.Size([4121, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4121])
ti.shape :  torch.Size([4121])
s_pos.shape :  torch.Size([4121, 3])
t_pos.shape :  torch.Size([4121, 3])
number of true landmarks correspondences returned from Lepard :  51  out of  4121
fraction of true landmark correspondences returned from Lepard :  0.012375636981315215
vec6d.shape :  torch.Size([3186, 6])
ldmk_s.shape :  torch.Size([3186, 3])
ldmk_t.shape :  torch.Size([3186, 3])
number of true landmark correspondences returned from Outlier Rejection :  43  out of  3186
fraction of true landmark correspondences returned from Outlier Rejection :  0.01349654739485248
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3186, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.706 
full-AccS: 0.038 
full-AccR: 1.297 
full-outlier: 98.150 
vis-epe: 23.025 
vis-AccS: 0.000 
vis-AccR: 0.420 
vis-outlier: 99.466 
occ-epe: 14.383 
occ-AccS: 0.076 
occ-AccR: 2.176 
occ-outlier: 96.832 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1414807271834406
Strict IR :  0.0013353681800839375
Relaxed IR :  0.018313620755436855
model 085
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  46  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0092
vec6d.shape :  torch.Size([3355, 6])
ldmk_s.shape :  torch.Size([3355, 3])
ldmk_t.shape :  torch.Size([3355, 3])
number of true landmark correspondences returned from Outlier Rejection :  27  out of  3355
fraction of true landmark correspondences returned from Outlier Rejection :  0.00804769001490313
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3355, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 27.162 
full-AccS: 0.134 
full-AccR: 0.758 
full-outlier: 98.886 
vis-epe: 27.162 
vis-AccS: 0.134 
vis-AccR: 0.758 
vis-outlier: 98.886 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.16218843749247583
Strict IR :  0.00267379679144385
Relaxed IR :  0.021836007130124777
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3646, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3646])
ti.shape :  torch.Size([3646])
s_pos.shape :  torch.Size([3646, 3])
t_pos.shape :  torch.Size([3646, 3])
ind.shape :  torch.Size([3646, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3646])
ti.shape :  torch.Size([3646])
s_pos.shape :  torch.Size([3646, 3])
t_pos.shape :  torch.Size([3646, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  3646
fraction of true landmark correspondences returned from Lepard :  0.015633571036752607
vec6d.shape :  torch.Size([2950, 6])
ldmk_s.shape :  torch.Size([2950, 3])
ldmk_t.shape :  torch.Size([2950, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  2950
fraction of true landmark correspondences returned from Outlier Rejection :  0.015932203389830507
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2950, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.209 
full-AccS: 0.000 
full-AccR: 2.981 
full-outlier: 57.069 
vis-epe: 12.664 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 70.057 
occ-epe: 8.290 
occ-AccS: 0.000 
occ-AccR: 5.312 
occ-outlier: 46.916 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08132617958109038
Strict IR :  0.0
Relaxed IR :  0.04885554914406617
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([4676, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4676])
ti.shape :  torch.Size([4676])
s_pos.shape :  torch.Size([4676, 3])
t_pos.shape :  torch.Size([4676, 3])
ind.shape :  torch.Size([4676, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4676])
ti.shape :  torch.Size([4676])
s_pos.shape :  torch.Size([4676, 3])
t_pos.shape :  torch.Size([4676, 3])
number of true landmarks correspondences returned from Lepard :  44  out of  4676
fraction of true landmark correspondences returned from Lepard :  0.009409751924721984
vec6d.shape :  torch.Size([3281, 6])
ldmk_s.shape :  torch.Size([3281, 3])
ldmk_t.shape :  torch.Size([3281, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  3281
fraction of true landmark correspondences returned from Outlier Rejection :  0.010057909174032308
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3281, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.721 
full-AccS: 0.045 
full-AccR: 1.827 
full-outlier: 80.348 
vis-epe: 14.659 
vis-AccS: 0.000 
vis-AccR: 1.120 
vis-outlier: 89.235 
occ-epe: 7.832 
occ-AccS: 0.157 
occ-AccR: 3.611 
occ-outlier: 57.928 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06053455083851554
Strict IR :  0.01675257731958763
Relaxed IR :  0.14368556701030927
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3048, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3048])
ti.shape :  torch.Size([3048])
s_pos.shape :  torch.Size([3048, 3])
t_pos.shape :  torch.Size([3048, 3])
ind.shape :  torch.Size([3048, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3048])
ti.shape :  torch.Size([3048])
s_pos.shape :  torch.Size([3048, 3])
t_pos.shape :  torch.Size([3048, 3])
number of true landmarks correspondences returned from Lepard :  51  out of  3048
fraction of true landmark correspondences returned from Lepard :  0.01673228346456693
vec6d.shape :  torch.Size([2414, 6])
ldmk_s.shape :  torch.Size([2414, 3])
ldmk_t.shape :  torch.Size([2414, 3])
number of true landmark correspondences returned from Outlier Rejection :  43  out of  2414
fraction of true landmark correspondences returned from Outlier Rejection :  0.017812758906379452
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2414, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.987 
full-AccS: 0.000 
full-AccR: 0.610 
full-outlier: 98.130 
vis-epe: 19.285 
vis-AccS: 0.000 
vis-AccR: 0.229 
vis-outlier: 99.047 
occ-epe: 10.686 
occ-AccS: 0.000 
occ-AccR: 0.992 
occ-outlier: 97.214 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10686351707776036
Strict IR :  0.0
Relaxed IR :  0.017741320106829453
model 085
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([2234, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2234])
ti.shape :  torch.Size([2234])
s_pos.shape :  torch.Size([2234, 3])
t_pos.shape :  torch.Size([2234, 3])
ind.shape :  torch.Size([2234, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2234])
ti.shape :  torch.Size([2234])
s_pos.shape :  torch.Size([2234, 3])
t_pos.shape :  torch.Size([2234, 3])
number of true landmarks correspondences returned from Lepard :  11  out of  2234
fraction of true landmark correspondences returned from Lepard :  0.004923903312444047
vec6d.shape :  torch.Size([1477, 6])
ldmk_s.shape :  torch.Size([1477, 3])
ldmk_t.shape :  torch.Size([1477, 3])
number of true landmark correspondences returned from Outlier Rejection :  4  out of  1477
fraction of true landmark correspondences returned from Outlier Rejection :  0.002708192281651997
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1477, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.757 
full-AccS: 0.045 
full-AccR: 0.802 
full-outlier: 98.841 
vis-epe: 26.757 
vis-AccS: 0.045 
vis-AccR: 0.802 
vis-outlier: 98.841 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.16220564355516437
Strict IR :  0.001336898395721925
Relaxed IR :  0.0213903743315508
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1692, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1692])
ti.shape :  torch.Size([1692])
s_pos.shape :  torch.Size([1692, 3])
t_pos.shape :  torch.Size([1692, 3])
ind.shape :  torch.Size([1692, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1692])
ti.shape :  torch.Size([1692])
s_pos.shape :  torch.Size([1692, 3])
t_pos.shape :  torch.Size([1692, 3])
number of true landmarks correspondences returned from Lepard :  55  out of  1692
fraction of true landmark correspondences returned from Lepard :  0.03250591016548463
vec6d.shape :  torch.Size([1416, 6])
ldmk_s.shape :  torch.Size([1416, 3])
ldmk_t.shape :  torch.Size([1416, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  1416
fraction of true landmark correspondences returned from Outlier Rejection :  0.033192090395480225
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1416, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.726 
full-AccS: 0.000 
full-AccR: 5.732 
full-outlier: 20.812 
vis-epe: 9.052 
vis-AccS: 0.000 
vis-AccR: 7.979 
vis-outlier: 47.435 
occ-epe: 4.908 
occ-AccS: 0.000 
occ-AccR: 3.975 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.048541106921007236
Strict IR :  0.006155029813425659
Relaxed IR :  0.12233121754183497
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([2398, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2398])
ti.shape :  torch.Size([2398])
s_pos.shape :  torch.Size([2398, 3])
t_pos.shape :  torch.Size([2398, 3])
ind.shape :  torch.Size([2398, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2398])
ti.shape :  torch.Size([2398])
s_pos.shape :  torch.Size([2398, 3])
t_pos.shape :  torch.Size([2398, 3])
number of true landmarks correspondences returned from Lepard :  26  out of  2398
fraction of true landmark correspondences returned from Lepard :  0.010842368640533779
vec6d.shape :  torch.Size([1863, 6])
ldmk_s.shape :  torch.Size([1863, 3])
ldmk_t.shape :  torch.Size([1863, 3])
number of true landmark correspondences returned from Outlier Rejection :  22  out of  1863
fraction of true landmark correspondences returned from Outlier Rejection :  0.011808910359634998
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1863, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.157 
full-AccS: 0.134 
full-AccR: 1.471 
full-outlier: 84.225 
vis-epe: 16.296 
vis-AccS: 0.187 
vis-AccR: 0.996 
vis-outlier: 92.159 
occ-epe: 8.762 
occ-AccS: 0.000 
occ-AccR: 2.669 
occ-outlier: 64.207 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07824523402824773
Strict IR :  0.006443298969072165
Relaxed IR :  0.10438144329896908
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1283, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1283])
ti.shape :  torch.Size([1283])
s_pos.shape :  torch.Size([1283, 3])
t_pos.shape :  torch.Size([1283, 3])
ind.shape :  torch.Size([1283, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1283])
ti.shape :  torch.Size([1283])
s_pos.shape :  torch.Size([1283, 3])
t_pos.shape :  torch.Size([1283, 3])
number of true landmarks correspondences returned from Lepard :  49  out of  1283
fraction of true landmark correspondences returned from Lepard :  0.03819173811379579
vec6d.shape :  torch.Size([1074, 6])
ldmk_s.shape :  torch.Size([1074, 3])
ldmk_t.shape :  torch.Size([1074, 3])
number of true landmark correspondences returned from Outlier Rejection :  46  out of  1074
fraction of true landmark correspondences returned from Outlier Rejection :  0.04283054003724395
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1074, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.486 
full-AccS: 0.076 
full-AccR: 18.791 
full-outlier: 78.233 
vis-epe: 12.985 
vis-AccS: 0.153 
vis-AccR: 1.449 
vis-outlier: 98.131 
occ-epe: 3.984 
occ-AccS: 0.000 
occ-AccR: 36.145 
occ-outlier: 58.321 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03953929119440775
Strict IR :  0.0
Relaxed IR :  0.39412438000763067
model 085
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([16, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([16])
ti.shape :  torch.Size([16])
s_pos.shape :  torch.Size([16, 3])
t_pos.shape :  torch.Size([16, 3])
ind.shape :  torch.Size([16, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([16])
ti.shape :  torch.Size([16])
s_pos.shape :  torch.Size([16, 3])
t_pos.shape :  torch.Size([16, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  16
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([15, 6])
ldmk_s.shape :  torch.Size([15, 3])
ldmk_t.shape :  torch.Size([15, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  15
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([15, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.934 
full-AccS: 0.000 
full-AccR: 0.357 
full-outlier: 99.242 
vis-epe: 26.934 
vis-AccS: 0.000 
vis-AccR: 0.357 
vis-outlier: 99.242 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17105085446642085
Strict IR :  0.0
Relaxed IR :  0.009358288770053475
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([52, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([52])
ti.shape :  torch.Size([52])
s_pos.shape :  torch.Size([52, 3])
t_pos.shape :  torch.Size([52, 3])
ind.shape :  torch.Size([52, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([52])
ti.shape :  torch.Size([52])
s_pos.shape :  torch.Size([52, 3])
t_pos.shape :  torch.Size([52, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  52
fraction of true landmark correspondences returned from Lepard :  0.11538461538461539
vec6d.shape :  torch.Size([47, 6])
ldmk_s.shape :  torch.Size([47, 3])
ldmk_t.shape :  torch.Size([47, 3])
number of true landmark correspondences returned from Outlier Rejection :  6  out of  47
fraction of true landmark correspondences returned from Outlier Rejection :  0.1276595744680851
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([47, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.197 
full-AccS: 0.000 
full-AccR: 1.539 
full-outlier: 63.762 
vis-epe: 13.910 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 96.054 
occ-epe: 9.076 
occ-AccS: 0.000 
occ-AccR: 2.742 
occ-outlier: 38.520 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10464630537490466
Strict IR :  0.0
Relaxed IR :  0.024620119253702635
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([6, 3])
bi :  tensor([0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([6])
ti.shape :  torch.Size([6])
s_pos.shape :  torch.Size([6, 3])
t_pos.shape :  torch.Size([6, 3])
ind.shape :  torch.Size([6, 3])
bi :  tensor([0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([6])
ti.shape :  torch.Size([6])
s_pos.shape :  torch.Size([6, 3])
t_pos.shape :  torch.Size([6, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  6
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([5, 6])
ldmk_s.shape :  torch.Size([5, 3])
ldmk_t.shape :  torch.Size([5, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  5
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([5, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.634 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 98.351 
vis-epe: 26.161 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 97.822 
occ-epe: 13.738 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.686 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17453822750017176
Strict IR :  0.0
Relaxed IR :  0.0
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([87, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([87])
ti.shape :  torch.Size([87])
s_pos.shape :  torch.Size([87, 3])
t_pos.shape :  torch.Size([87, 3])
ind.shape :  torch.Size([87, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([87])
ti.shape :  torch.Size([87])
s_pos.shape :  torch.Size([87, 3])
t_pos.shape :  torch.Size([87, 3])
number of true landmarks correspondences returned from Lepard :  15  out of  87
fraction of true landmark correspondences returned from Lepard :  0.1724137931034483
vec6d.shape :  torch.Size([83, 6])
ldmk_s.shape :  torch.Size([83, 3])
ldmk_t.shape :  torch.Size([83, 3])
number of true landmark correspondences returned from Outlier Rejection :  14  out of  83
fraction of true landmark correspondences returned from Outlier Rejection :  0.1686746987951807
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([83, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.894 
full-AccS: 0.038 
full-AccR: 50.763 
full-outlier: 48.913 
vis-epe: 11.880 
vis-AccS: 0.076 
vis-AccR: 1.564 
vis-outlier: 97.788 
occ-epe: 1.904 
occ-AccS: 0.000 
occ-AccR: 100.000 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019027639094551733
Strict IR :  0.0
Relaxed IR :  1.0
model 085
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  3
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 17.685 
full-AccS: 0.134 
full-AccR: 1.641 
full-outlier: 97.367 
vis-epe: 20.788 
vis-AccS: 0.038 
vis-AccR: 0.648 
vis-outlier: 98.970 
occ-epe: 14.581 
occ-AccS: 0.229 
occ-AccR: 2.634 
occ-outlier: 95.763 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1505782888883428
Strict IR :  0.009919877909194963
Relaxed IR :  0.08565433040824114
model 126
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0162
vec6d.shape :  torch.Size([2508, 6])
ldmk_s.shape :  torch.Size([2508, 3])
ldmk_t.shape :  torch.Size([2508, 3])
number of true landmark correspondences returned from Outlier Rejection :  56  out of  2508
fraction of true landmark correspondences returned from Outlier Rejection :  0.022328548644338118
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2508, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.272 
full-AccS: 0.098 
full-AccR: 0.952 
full-outlier: 93.743 
vis-epe: 19.272 
vis-AccS: 0.098 
vis-AccR: 0.952 
vis-outlier: 93.743 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.037919455832568824
Strict IR :  0.0
Relaxed IR :  0.24398096304591266
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  88  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0176
vec6d.shape :  torch.Size([3187, 6])
ldmk_s.shape :  torch.Size([3187, 3])
ldmk_t.shape :  torch.Size([3187, 3])
number of true landmark correspondences returned from Outlier Rejection :  61  out of  3187
fraction of true landmark correspondences returned from Outlier Rejection :  0.019140257295262003
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3187, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.914 
full-AccS: 0.000 
full-AccR: 12.748 
full-outlier: 59.649 
vis-epe: 16.235 
vis-AccS: 0.000 
vis-AccR: 1.527 
vis-outlier: 96.735 
occ-epe: 3.834 
occ-AccS: 0.000 
occ-AccR: 27.681 
occ-outlier: 10.299 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04449450186371594
Strict IR :  0.0023002421307506053
Relaxed IR :  0.22832929782082326
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  85  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.017
vec6d.shape :  torch.Size([3233, 6])
ldmk_s.shape :  torch.Size([3233, 3])
ldmk_t.shape :  torch.Size([3233, 3])
number of true landmark correspondences returned from Outlier Rejection :  59  out of  3233
fraction of true landmark correspondences returned from Outlier Rejection :  0.01824930405196412
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3233, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.973 
full-AccS: 0.056 
full-AccR: 3.387 
full-outlier: 70.549 
vis-epe: 14.746 
vis-AccS: 0.060 
vis-AccR: 1.868 
vis-outlier: 75.938 
occ-epe: 3.857 
occ-AccS: 0.000 
occ-AccR: 23.274 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03788803371646539
Strict IR :  0.033099297893681046
Relaxed IR :  0.39301237044466736
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  97  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0194
vec6d.shape :  torch.Size([3622, 6])
ldmk_s.shape :  torch.Size([3622, 3])
ldmk_t.shape :  torch.Size([3622, 3])
number of true landmark correspondences returned from Outlier Rejection :  84  out of  3622
fraction of true landmark correspondences returned from Outlier Rejection :  0.02319160684704583
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3622, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.291 
full-AccS: 0.311 
full-AccR: 39.303 
full-outlier: 52.707 
vis-epe: 13.290 
vis-AccS: 0.000 
vis-AccR: 2.138 
vis-outlier: 97.002 
occ-epe: 2.343 
occ-AccS: 0.682 
occ-AccR: 83.526 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0248986655221012
Strict IR :  0.04108768567321514
Relaxed IR :  0.7816243411595591
model 126
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0162
vec6d.shape :  torch.Size([2508, 6])
ldmk_s.shape :  torch.Size([2508, 3])
ldmk_t.shape :  torch.Size([2508, 3])
number of true landmark correspondences returned from Outlier Rejection :  56  out of  2508
fraction of true landmark correspondences returned from Outlier Rejection :  0.022328548644338118
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2508, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.272 
full-AccS: 0.098 
full-AccR: 0.952 
full-outlier: 93.743 
vis-epe: 19.272 
vis-AccS: 0.098 
vis-AccR: 0.952 
vis-outlier: 93.743 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.037919455832568824
Strict IR :  0.0
Relaxed IR :  0.24398096304591266
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  88  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0176
vec6d.shape :  torch.Size([3187, 6])
ldmk_s.shape :  torch.Size([3187, 3])
ldmk_t.shape :  torch.Size([3187, 3])
number of true landmark correspondences returned from Outlier Rejection :  61  out of  3187
fraction of true landmark correspondences returned from Outlier Rejection :  0.019140257295262003
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3187, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.914 
full-AccS: 0.000 
full-AccR: 12.748 
full-outlier: 59.649 
vis-epe: 16.235 
vis-AccS: 0.000 
vis-AccR: 1.527 
vis-outlier: 96.735 
occ-epe: 3.834 
occ-AccS: 0.000 
occ-AccR: 27.681 
occ-outlier: 10.299 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04449450186371594
Strict IR :  0.0023002421307506053
Relaxed IR :  0.22832929782082326
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  85  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.017
vec6d.shape :  torch.Size([3233, 6])
ldmk_s.shape :  torch.Size([3233, 3])
ldmk_t.shape :  torch.Size([3233, 3])
number of true landmark correspondences returned from Outlier Rejection :  59  out of  3233
fraction of true landmark correspondences returned from Outlier Rejection :  0.01824930405196412
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3233, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.973 
full-AccS: 0.056 
full-AccR: 3.387 
full-outlier: 70.549 
vis-epe: 14.746 
vis-AccS: 0.060 
vis-AccR: 1.868 
vis-outlier: 75.938 
occ-epe: 3.857 
occ-AccS: 0.000 
occ-AccR: 23.274 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03788803371646539
Strict IR :  0.033099297893681046
Relaxed IR :  0.39301237044466736
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  97  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0194
vec6d.shape :  torch.Size([3622, 6])
ldmk_s.shape :  torch.Size([3622, 3])
ldmk_t.shape :  torch.Size([3622, 3])
number of true landmark correspondences returned from Outlier Rejection :  84  out of  3622
fraction of true landmark correspondences returned from Outlier Rejection :  0.02319160684704583
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3622, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.291 
full-AccS: 0.311 
full-AccR: 39.303 
full-outlier: 52.707 
vis-epe: 13.290 
vis-AccS: 0.000 
vis-AccR: 2.138 
vis-outlier: 97.002 
occ-epe: 2.343 
occ-AccS: 0.682 
occ-AccR: 83.526 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0248986655221012
Strict IR :  0.04108768567321514
Relaxed IR :  0.7816243411595591
model 126
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3904, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3904])
ti.shape :  torch.Size([3904])
s_pos.shape :  torch.Size([3904, 3])
t_pos.shape :  torch.Size([3904, 3])
ind.shape :  torch.Size([3904, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3904])
ti.shape :  torch.Size([3904])
s_pos.shape :  torch.Size([3904, 3])
t_pos.shape :  torch.Size([3904, 3])
number of true landmarks correspondences returned from Lepard :  65  out of  3904
fraction of true landmark correspondences returned from Lepard :  0.016649590163934427
vec6d.shape :  torch.Size([2068, 6])
ldmk_s.shape :  torch.Size([2068, 3])
ldmk_t.shape :  torch.Size([2068, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  2068
fraction of true landmark correspondences returned from Outlier Rejection :  0.023694390715667313
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2068, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.285 
full-AccS: 0.084 
full-AccR: 0.952 
full-outlier: 93.659 
vis-epe: 19.285 
vis-AccS: 0.084 
vis-AccR: 0.952 
vis-outlier: 93.659 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.039965033803429334
Strict IR :  0.0
Relaxed IR :  0.20716685330347145
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3517, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3517])
ti.shape :  torch.Size([3517])
s_pos.shape :  torch.Size([3517, 3])
t_pos.shape :  torch.Size([3517, 3])
ind.shape :  torch.Size([3517, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3517])
ti.shape :  torch.Size([3517])
s_pos.shape :  torch.Size([3517, 3])
t_pos.shape :  torch.Size([3517, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  3517
fraction of true landmark correspondences returned from Lepard :  0.02303099232300256
vec6d.shape :  torch.Size([2300, 6])
ldmk_s.shape :  torch.Size([2300, 3])
ldmk_t.shape :  torch.Size([2300, 3])
number of true landmark correspondences returned from Outlier Rejection :  60  out of  2300
fraction of true landmark correspondences returned from Outlier Rejection :  0.02608695652173913
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2300, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.865 
full-AccS: 0.000 
full-AccR: 10.944 
full-outlier: 60.048 
vis-epe: 16.128 
vis-AccS: 0.000 
vis-AccR: 1.824 
vis-outlier: 96.501 
occ-epe: 3.862 
occ-AccS: 0.000 
occ-AccR: 23.081 
occ-outlier: 11.541 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04430368212868654
Strict IR :  0.0021791767554479417
Relaxed IR :  0.20024213075060532
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([4614, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4614])
ti.shape :  torch.Size([4614])
s_pos.shape :  torch.Size([4614, 3])
t_pos.shape :  torch.Size([4614, 3])
ind.shape :  torch.Size([4614, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4614])
ti.shape :  torch.Size([4614])
s_pos.shape :  torch.Size([4614, 3])
t_pos.shape :  torch.Size([4614, 3])
number of true landmarks correspondences returned from Lepard :  80  out of  4614
fraction of true landmark correspondences returned from Lepard :  0.017338534893801473
vec6d.shape :  torch.Size([2964, 6])
ldmk_s.shape :  torch.Size([2964, 3])
ldmk_t.shape :  torch.Size([2964, 3])
number of true landmark correspondences returned from Outlier Rejection :  57  out of  2964
fraction of true landmark correspondences returned from Outlier Rejection :  0.019230769230769232
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2964, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.047 
full-AccS: 0.098 
full-AccR: 3.387 
full-outlier: 69.317 
vis-epe: 14.827 
vis-AccS: 0.105 
vis-AccR: 1.944 
vis-outlier: 74.612 
occ-epe: 3.827 
occ-AccS: 0.000 
occ-AccR: 22.288 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03403264813962463
Strict IR :  0.043463724506853894
Relaxed IR :  0.4791039786024741
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3121, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3121])
ti.shape :  torch.Size([3121])
s_pos.shape :  torch.Size([3121, 3])
t_pos.shape :  torch.Size([3121, 3])
ind.shape :  torch.Size([3121, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3121])
ti.shape :  torch.Size([3121])
s_pos.shape :  torch.Size([3121, 3])
t_pos.shape :  torch.Size([3121, 3])
number of true landmarks correspondences returned from Lepard :  91  out of  3121
fraction of true landmark correspondences returned from Lepard :  0.029157321371355335
vec6d.shape :  torch.Size([2418, 6])
ldmk_s.shape :  torch.Size([2418, 3])
ldmk_t.shape :  torch.Size([2418, 3])
number of true landmark correspondences returned from Outlier Rejection :  81  out of  2418
fraction of true landmark correspondences returned from Outlier Rejection :  0.033498759305210915
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2418, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.346 
full-AccS: 0.132 
full-AccR: 30.678 
full-outlier: 54.324 
vis-epe: 13.092 
vis-AccS: 0.000 
vis-AccR: 1.918 
vis-outlier: 97.068 
occ-epe: 2.698 
occ-AccS: 0.289 
occ-AccR: 64.900 
occ-outlier: 3.463 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.028599771876054687
Strict IR :  0.05929563967417346
Relaxed IR :  0.5909199808337326
model 126
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([31, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([31])
ti.shape :  torch.Size([31])
s_pos.shape :  torch.Size([31, 3])
t_pos.shape :  torch.Size([31, 3])
ind.shape :  torch.Size([31, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([31])
ti.shape :  torch.Size([31])
s_pos.shape :  torch.Size([31, 3])
t_pos.shape :  torch.Size([31, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  31
fraction of true landmark correspondences returned from Lepard :  0.03225806451612903
vec6d.shape :  torch.Size([30, 6])
ldmk_s.shape :  torch.Size([30, 3])
ldmk_t.shape :  torch.Size([30, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  30
fraction of true landmark correspondences returned from Outlier Rejection :  0.03333333333333333
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([30, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 29.007 
full-AccS: 0.042 
full-AccR: 1.008 
full-outlier: 95.143 
vis-epe: 29.007 
vis-AccS: 0.042 
vis-AccR: 1.008 
vis-outlier: 95.143 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.2201268687885959
Strict IR :  0.0
Relaxed IR :  0.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([41, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([41])
ti.shape :  torch.Size([41])
s_pos.shape :  torch.Size([41, 3])
t_pos.shape :  torch.Size([41, 3])
ind.shape :  torch.Size([41, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([41])
ti.shape :  torch.Size([41])
s_pos.shape :  torch.Size([41, 3])
t_pos.shape :  torch.Size([41, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  41
fraction of true landmark correspondences returned from Lepard :  0.14634146341463414
vec6d.shape :  torch.Size([35, 6])
ldmk_s.shape :  torch.Size([35, 3])
ldmk_t.shape :  torch.Size([35, 3])
number of true landmark correspondences returned from Outlier Rejection :  6  out of  35
fraction of true landmark correspondences returned from Outlier Rejection :  0.17142857142857143
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([35, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.366 
full-AccS: 0.000 
full-AccR: 19.806 
full-outlier: 55.073 
vis-epe: 15.917 
vis-AccS: 0.000 
vis-AccR: 0.848 
vis-outlier: 96.459 
occ-epe: 2.980 
occ-AccS: 0.000 
occ-AccR: 45.034 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03190786279629894
Strict IR :  0.0029055690072639223
Relaxed IR :  0.5616222760290557
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  3
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 25.483 
full-AccS: 0.000 
full-AccR: 0.098 
full-outlier: 86.324 
vis-epe: 26.976 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 92.873 
occ-epe: 5.940 
occ-AccS: 0.000 
occ-AccR: 1.381 
occ-outlier: 0.592 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.21992251762292145
Strict IR :  0.0
Relaxed IR :  0.0038448679371447677
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([79, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([79])
ti.shape :  torch.Size([79])
s_pos.shape :  torch.Size([79, 3])
t_pos.shape :  torch.Size([79, 3])
ind.shape :  torch.Size([79, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([79])
ti.shape :  torch.Size([79])
s_pos.shape :  torch.Size([79, 3])
t_pos.shape :  torch.Size([79, 3])
number of true landmarks correspondences returned from Lepard :  12  out of  79
fraction of true landmark correspondences returned from Lepard :  0.1518987341772152
vec6d.shape :  torch.Size([68, 6])
ldmk_s.shape :  torch.Size([68, 3])
ldmk_t.shape :  torch.Size([68, 3])
number of true landmark correspondences returned from Outlier Rejection :  10  out of  68
fraction of true landmark correspondences returned from Outlier Rejection :  0.14705882352941177
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([68, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.386 
full-AccS: 0.000 
full-AccR: 2.695 
full-outlier: 91.076 
vis-epe: 12.671 
vis-AccS: 0.000 
vis-AccR: 0.904 
vis-outlier: 97.884 
occ-epe: 5.478 
occ-AccS: 0.000 
occ-AccR: 4.827 
occ-outlier: 82.975 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05582384357748253
Strict IR :  0.0
Relaxed IR :  0.12937230474365116
model 126
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  1
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([0, 6])
ldmk_s.shape :  torch.Size([0, 3])
ldmk_t.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
number of true landmark correspondences returned from Outlier Rejection :  0  out of  0
fraction of true landmark correspondences returned from Outlier Rejection :  0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.851 
full-AccS: 0.085 
full-AccR: 0.448 
full-outlier: 98.862 
vis-epe: 29.722 
vis-AccS: 0.148 
vis-AccR: 0.785 
vis-outlier: 98.367 
occ-epe: 16.039 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.520 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1720644467598004
Strict IR :  0.0
Relaxed IR :  0.0
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  3
fraction of true landmark correspondences returned from Lepard :  0.6666666666666666
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.6666666666666666
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.113 
full-AccS: 3.845 
full-AccR: 46.586 
full-outlier: 52.983 
vis-epe: 13.566 
vis-AccS: 0.000 
vis-AccR: 1.698 
vis-outlier: 97.509 
occ-epe: 1.625 
occ-AccS: 8.421 
occ-AccR: 100.000 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.017061775543533574
Strict IR :  0.0610924772400575
Relaxed IR :  1.0
model 167
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([3711, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3711])
ti.shape :  torch.Size([3711])
s_pos.shape :  torch.Size([3711, 3])
t_pos.shape :  torch.Size([3711, 3])
ind.shape :  torch.Size([3711, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3711])
ti.shape :  torch.Size([3711])
s_pos.shape :  torch.Size([3711, 3])
t_pos.shape :  torch.Size([3711, 3])
number of true landmarks correspondences returned from Lepard :  56  out of  3711
fraction of true landmark correspondences returned from Lepard :  0.01509027216383724
vec6d.shape :  torch.Size([2850, 6])
ldmk_s.shape :  torch.Size([2850, 3])
ldmk_t.shape :  torch.Size([2850, 3])
number of true landmark correspondences returned from Outlier Rejection :  43  out of  2850
fraction of true landmark correspondences returned from Outlier Rejection :  0.015087719298245613
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2850, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.841 
full-AccS: 0.872 
full-AccR: 7.316 
full-outlier: 25.934 
vis-epe: 7.841 
vis-AccS: 0.872 
vis-AccR: 7.316 
vis-outlier: 25.934 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0762163043828095
Strict IR :  0.0062266500622665
Relaxed IR :  0.08779576587795766
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([3018, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3018])
ti.shape :  torch.Size([3018])
s_pos.shape :  torch.Size([3018, 3])
t_pos.shape :  torch.Size([3018, 3])
ind.shape :  torch.Size([3018, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3018])
ti.shape :  torch.Size([3018])
s_pos.shape :  torch.Size([3018, 3])
t_pos.shape :  torch.Size([3018, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  3018
fraction of true landmark correspondences returned from Lepard :  0.018886679920477135
vec6d.shape :  torch.Size([2048, 6])
ldmk_s.shape :  torch.Size([2048, 3])
ldmk_t.shape :  torch.Size([2048, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  2048
fraction of true landmark correspondences returned from Outlier Rejection :  0.021484375
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2048, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.034 
full-AccS: 0.026 
full-AccR: 0.638 
full-outlier: 99.388 
vis-epe: 17.974 
vis-AccS: 0.045 
vis-AccR: 0.226 
vis-outlier: 99.774 
occ-epe: 8.908 
occ-AccS: 0.000 
occ-AccR: 1.174 
occ-outlier: 98.884 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09380983542994958
Strict IR :  0.0
Relaxed IR :  0.007910181168665476
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([3528, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3528])
ti.shape :  torch.Size([3528])
s_pos.shape :  torch.Size([3528, 3])
t_pos.shape :  torch.Size([3528, 3])
ind.shape :  torch.Size([3528, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3528])
ti.shape :  torch.Size([3528])
s_pos.shape :  torch.Size([3528, 3])
t_pos.shape :  torch.Size([3528, 3])
number of true landmarks correspondences returned from Lepard :  59  out of  3528
fraction of true landmark correspondences returned from Lepard :  0.016723356009070295
vec6d.shape :  torch.Size([2973, 6])
ldmk_s.shape :  torch.Size([2973, 3])
ldmk_t.shape :  torch.Size([2973, 3])
number of true landmark correspondences returned from Outlier Rejection :  48  out of  2973
fraction of true landmark correspondences returned from Outlier Rejection :  0.016145307769929364
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2973, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.108 
full-AccS: 0.093 
full-AccR: 0.965 
full-outlier: 84.963 
vis-epe: 23.374 
vis-AccS: 0.107 
vis-AccR: 1.072 
vis-outlier: 87.956 
occ-epe: 13.551 
occ-AccS: 0.000 
occ-AccR: 0.242 
occ-outlier: 64.734 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12967478034097635
Strict IR :  0.0
Relaxed IR :  0.02540156892043332
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2738, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2738])
ti.shape :  torch.Size([2738])
s_pos.shape :  torch.Size([2738, 3])
t_pos.shape :  torch.Size([2738, 3])
ind.shape :  torch.Size([2738, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2738])
ti.shape :  torch.Size([2738])
s_pos.shape :  torch.Size([2738, 3])
t_pos.shape :  torch.Size([2738, 3])
number of true landmarks correspondences returned from Lepard :  44  out of  2738
fraction of true landmark correspondences returned from Lepard :  0.016070124178232285
vec6d.shape :  torch.Size([2300, 6])
ldmk_s.shape :  torch.Size([2300, 3])
ldmk_t.shape :  torch.Size([2300, 3])
number of true landmark correspondences returned from Outlier Rejection :  28  out of  2300
fraction of true landmark correspondences returned from Outlier Rejection :  0.01217391304347826
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2300, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.607 
full-AccS: 0.026 
full-AccR: 1.046 
full-outlier: 96.070 
vis-epe: 17.283 
vis-AccS: 0.000 
vis-AccR: 0.541 
vis-outlier: 96.904 
occ-epe: 11.718 
occ-AccS: 0.053 
occ-AccR: 1.592 
occ-outlier: 95.170 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1104960235094771
Strict IR :  0.0028068384792038787
Relaxed IR :  0.04261291145700434
model 167
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3147, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3147])
ti.shape :  torch.Size([3147])
s_pos.shape :  torch.Size([3147, 3])
t_pos.shape :  torch.Size([3147, 3])
ind.shape :  torch.Size([3147, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3147])
ti.shape :  torch.Size([3147])
s_pos.shape :  torch.Size([3147, 3])
t_pos.shape :  torch.Size([3147, 3])
number of true landmarks correspondences returned from Lepard :  54  out of  3147
fraction of true landmark correspondences returned from Lepard :  0.017159199237368923
vec6d.shape :  torch.Size([2359, 6])
ldmk_s.shape :  torch.Size([2359, 3])
ldmk_t.shape :  torch.Size([2359, 3])
number of true landmark correspondences returned from Outlier Rejection :  39  out of  2359
fraction of true landmark correspondences returned from Outlier Rejection :  0.016532428995337006
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2359, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.096 
full-AccS: 0.872 
full-AccR: 6.974 
full-outlier: 28.549 
vis-epe: 8.096 
vis-AccS: 0.872 
vis-AccR: 6.974 
vis-outlier: 28.549 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07860351214555722
Strict IR :  0.006537982565379826
Relaxed IR :  0.0821917808219178
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2407, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2407])
ti.shape :  torch.Size([2407])
s_pos.shape :  torch.Size([2407, 3])
t_pos.shape :  torch.Size([2407, 3])
ind.shape :  torch.Size([2407, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2407])
ti.shape :  torch.Size([2407])
s_pos.shape :  torch.Size([2407, 3])
t_pos.shape :  torch.Size([2407, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  2407
fraction of true landmark correspondences returned from Lepard :  0.023680930619027835
vec6d.shape :  torch.Size([1673, 6])
ldmk_s.shape :  torch.Size([1673, 3])
ldmk_t.shape :  torch.Size([1673, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  1673
fraction of true landmark correspondences returned from Outlier Rejection :  0.029288702928870293
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1673, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.607 
full-AccS: 0.000 
full-AccR: 0.179 
full-outlier: 99.898 
vis-epe: 15.672 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 8.619 
occ-AccS: 0.000 
occ-AccR: 0.411 
occ-outlier: 99.765 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08569246246332755
Strict IR :  0.0
Relaxed IR :  0.008675682572084715
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2899, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2899])
ti.shape :  torch.Size([2899])
s_pos.shape :  torch.Size([2899, 3])
t_pos.shape :  torch.Size([2899, 3])
ind.shape :  torch.Size([2899, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2899])
ti.shape :  torch.Size([2899])
s_pos.shape :  torch.Size([2899, 3])
t_pos.shape :  torch.Size([2899, 3])
number of true landmarks correspondences returned from Lepard :  59  out of  2899
fraction of true landmark correspondences returned from Lepard :  0.020351845463953088
vec6d.shape :  torch.Size([2420, 6])
ldmk_s.shape :  torch.Size([2420, 3])
ldmk_t.shape :  torch.Size([2420, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  2420
fraction of true landmark correspondences returned from Outlier Rejection :  0.02024793388429752
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2420, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.843 
full-AccS: 0.000 
full-AccR: 0.685 
full-outlier: 80.137 
vis-epe: 16.696 
vis-AccS: 0.000 
vis-AccR: 0.107 
vis-outlier: 83.846 
occ-epe: 10.075 
occ-AccS: 0.000 
occ-AccR: 4.589 
occ-outlier: 55.072 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07889417718435907
Strict IR :  0.00635039223010833
Relaxed IR :  0.06985431453119163
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2072, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2072])
ti.shape :  torch.Size([2072])
s_pos.shape :  torch.Size([2072, 3])
t_pos.shape :  torch.Size([2072, 3])
ind.shape :  torch.Size([2072, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2072])
ti.shape :  torch.Size([2072])
s_pos.shape :  torch.Size([2072, 3])
t_pos.shape :  torch.Size([2072, 3])
number of true landmarks correspondences returned from Lepard :  44  out of  2072
fraction of true landmark correspondences returned from Lepard :  0.021235521235521235
vec6d.shape :  torch.Size([1733, 6])
ldmk_s.shape :  torch.Size([1733, 3])
ldmk_t.shape :  torch.Size([1733, 3])
number of true landmark correspondences returned from Outlier Rejection :  36  out of  1733
fraction of true landmark correspondences returned from Outlier Rejection :  0.0207732256203116
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1733, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.818 
full-AccS: 0.000 
full-AccR: 1.301 
full-outlier: 95.662 
vis-epe: 14.928 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.951 
occ-epe: 8.458 
occ-AccS: 0.000 
occ-AccR: 2.707 
occ-outlier: 91.030 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08977647951925079
Strict IR :  0.0
Relaxed IR :  0.014799693799438633
model 167
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1498, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1498])
ti.shape :  torch.Size([1498])
s_pos.shape :  torch.Size([1498, 3])
t_pos.shape :  torch.Size([1498, 3])
ind.shape :  torch.Size([1498, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1498])
ti.shape :  torch.Size([1498])
s_pos.shape :  torch.Size([1498, 3])
t_pos.shape :  torch.Size([1498, 3])
number of true landmarks correspondences returned from Lepard :  35  out of  1498
fraction of true landmark correspondences returned from Lepard :  0.02336448598130841
vec6d.shape :  torch.Size([1170, 6])
ldmk_s.shape :  torch.Size([1170, 3])
ldmk_t.shape :  torch.Size([1170, 3])
number of true landmark correspondences returned from Outlier Rejection :  21  out of  1170
fraction of true landmark correspondences returned from Outlier Rejection :  0.017948717948717947
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1170, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.863 
full-AccS: 0.062 
full-AccR: 1.090 
full-outlier: 83.281 
vis-epe: 16.863 
vis-AccS: 0.062 
vis-AccR: 1.090 
vis-outlier: 83.281 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13473825753824445
Strict IR :  0.0021793275217932753
Relaxed IR :  0.022727272727272728
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1159, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1159])
ti.shape :  torch.Size([1159])
s_pos.shape :  torch.Size([1159, 3])
t_pos.shape :  torch.Size([1159, 3])
ind.shape :  torch.Size([1159, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1159])
ti.shape :  torch.Size([1159])
s_pos.shape :  torch.Size([1159, 3])
t_pos.shape :  torch.Size([1159, 3])
number of true landmarks correspondences returned from Lepard :  50  out of  1159
fraction of true landmark correspondences returned from Lepard :  0.04314063848144953
vec6d.shape :  torch.Size([954, 6])
ldmk_s.shape :  torch.Size([954, 3])
ldmk_t.shape :  torch.Size([954, 3])
number of true landmark correspondences returned from Outlier Rejection :  50  out of  954
fraction of true landmark correspondences returned from Outlier Rejection :  0.05241090146750524
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([954, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.479 
full-AccS: 0.000 
full-AccR: 37.612 
full-outlier: 60.322 
vis-epe: 9.639 
vis-AccS: 0.000 
vis-AccR: 0.045 
vis-outlier: 99.865 
occ-epe: 2.366 
occ-AccS: 0.000 
occ-AccR: 86.494 
occ-outlier: 8.867 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.02449103636996985
Strict IR :  0.0
Relaxed IR :  0.8504720591987752
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1485, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1485])
ti.shape :  torch.Size([1485])
s_pos.shape :  torch.Size([1485, 3])
t_pos.shape :  torch.Size([1485, 3])
ind.shape :  torch.Size([1485, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1485])
ti.shape :  torch.Size([1485])
s_pos.shape :  torch.Size([1485, 3])
t_pos.shape :  torch.Size([1485, 3])
number of true landmarks correspondences returned from Lepard :  48  out of  1485
fraction of true landmark correspondences returned from Lepard :  0.03232323232323232
vec6d.shape :  torch.Size([1241, 6])
ldmk_s.shape :  torch.Size([1241, 3])
ldmk_t.shape :  torch.Size([1241, 3])
number of true landmark correspondences returned from Outlier Rejection :  43  out of  1241
fraction of true landmark correspondences returned from Outlier Rejection :  0.0346494762288477
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1241, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.508 
full-AccS: 0.125 
full-AccR: 1.806 
full-outlier: 75.872 
vis-epe: 16.410 
vis-AccS: 0.000 
vis-AccR: 0.715 
vis-outlier: 80.272 
occ-epe: 9.406 
occ-AccS: 0.966 
occ-AccR: 9.179 
occ-outlier: 46.135 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0732039523655278
Strict IR :  0.0029884198729921555
Relaxed IR :  0.07508404930892791
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([998, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([998])
ti.shape :  torch.Size([998])
s_pos.shape :  torch.Size([998, 3])
t_pos.shape :  torch.Size([998, 3])
ind.shape :  torch.Size([998, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([998])
ti.shape :  torch.Size([998])
s_pos.shape :  torch.Size([998, 3])
t_pos.shape :  torch.Size([998, 3])
number of true landmarks correspondences returned from Lepard :  44  out of  998
fraction of true landmark correspondences returned from Lepard :  0.04408817635270541
vec6d.shape :  torch.Size([850, 6])
ldmk_s.shape :  torch.Size([850, 3])
ldmk_t.shape :  torch.Size([850, 3])
number of true landmark correspondences returned from Outlier Rejection :  38  out of  850
fraction of true landmark correspondences returned from Outlier Rejection :  0.04470588235294118
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([850, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.449 
full-AccS: 0.128 
full-AccR: 18.168 
full-outlier: 44.067 
vis-epe: 9.242 
vis-AccS: 0.246 
vis-AccR: 5.504 
vis-outlier: 79.263 
occ-epe: 3.432 
occ-AccS: 0.000 
occ-AccR: 31.847 
occ-outlier: 6.051 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.033193725032931075
Strict IR :  0.0
Relaxed IR :  0.44169430977290125
model 167
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([38, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([38])
ti.shape :  torch.Size([38])
s_pos.shape :  torch.Size([38, 3])
t_pos.shape :  torch.Size([38, 3])
ind.shape :  torch.Size([38, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([38])
ti.shape :  torch.Size([38])
s_pos.shape :  torch.Size([38, 3])
t_pos.shape :  torch.Size([38, 3])
number of true landmarks correspondences returned from Lepard :  3  out of  38
fraction of true landmark correspondences returned from Lepard :  0.07894736842105263
vec6d.shape :  torch.Size([35, 6])
ldmk_s.shape :  torch.Size([35, 3])
ldmk_t.shape :  torch.Size([35, 3])
number of true landmark correspondences returned from Outlier Rejection :  3  out of  35
fraction of true landmark correspondences returned from Outlier Rejection :  0.08571428571428572
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([35, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.373 
full-AccS: 0.000 
full-AccR: 1.245 
full-outlier: 77.771 
vis-epe: 15.373 
vis-AccS: 0.000 
vis-AccR: 1.245 
vis-outlier: 77.771 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12842478583090822
Strict IR :  0.001556662515566625
Relaxed IR :  0.025529265255292654
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([87, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([87])
ti.shape :  torch.Size([87])
s_pos.shape :  torch.Size([87, 3])
t_pos.shape :  torch.Size([87, 3])
ind.shape :  torch.Size([87, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([87])
ti.shape :  torch.Size([87])
s_pos.shape :  torch.Size([87, 3])
t_pos.shape :  torch.Size([87, 3])
number of true landmarks correspondences returned from Lepard :  16  out of  87
fraction of true landmark correspondences returned from Lepard :  0.1839080459770115
vec6d.shape :  torch.Size([86, 6])
ldmk_s.shape :  torch.Size([86, 3])
ldmk_t.shape :  torch.Size([86, 3])
number of true landmark correspondences returned from Outlier Rejection :  16  out of  86
fraction of true landmark correspondences returned from Outlier Rejection :  0.18604651162790697
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([86, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.765 
full-AccS: 0.026 
full-AccR: 18.091 
full-outlier: 78.285 
vis-epe: 9.580 
vis-AccS: 0.000 
vis-AccR: 0.090 
vis-outlier: 99.368 
occ-epe: 3.102 
occ-AccS: 0.059 
occ-AccR: 41.515 
occ-outlier: 50.851 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.02924123102753827
Strict IR :  0.0015310028068384791
Relaxed IR :  0.556009186016841
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([17, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([17])
ti.shape :  torch.Size([17])
s_pos.shape :  torch.Size([17, 3])
t_pos.shape :  torch.Size([17, 3])
ind.shape :  torch.Size([17, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([17])
ti.shape :  torch.Size([17])
s_pos.shape :  torch.Size([17, 3])
t_pos.shape :  torch.Size([17, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  17
fraction of true landmark correspondences returned from Lepard :  0.11764705882352941
vec6d.shape :  torch.Size([16, 6])
ldmk_s.shape :  torch.Size([16, 3])
ldmk_t.shape :  torch.Size([16, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  16
fraction of true landmark correspondences returned from Outlier Rejection :  0.125
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([16, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.814 
full-AccS: 0.125 
full-AccR: 5.978 
full-outlier: 48.661 
vis-epe: 13.028 
vis-AccS: 0.071 
vis-AccR: 2.216 
vis-outlier: 55.861 
occ-epe: 3.608 
occ-AccS: 0.483 
occ-AccR: 31.401 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.031599345676295014
Strict IR :  0.07583115427717595
Relaxed IR :  0.5203586103847591
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([82, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([82])
ti.shape :  torch.Size([82])
s_pos.shape :  torch.Size([82, 3])
t_pos.shape :  torch.Size([82, 3])
ind.shape :  torch.Size([82, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([82])
ti.shape :  torch.Size([82])
s_pos.shape :  torch.Size([82, 3])
t_pos.shape :  torch.Size([82, 3])
number of true landmarks correspondences returned from Lepard :  13  out of  82
fraction of true landmark correspondences returned from Lepard :  0.15853658536585366
vec6d.shape :  torch.Size([82, 6])
ldmk_s.shape :  torch.Size([82, 3])
ldmk_t.shape :  torch.Size([82, 3])
number of true landmark correspondences returned from Outlier Rejection :  13  out of  82
fraction of true landmark correspondences returned from Outlier Rejection :  0.15853658536585366
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([82, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 5.552 
full-AccS: 0.000 
full-AccR: 48.380 
full-outlier: 39.066 
vis-epe: 8.721 
vis-AccS: 0.000 
vis-AccR: 5.651 
vis-outlier: 75.233 
occ-epe: 2.129 
occ-AccS: 0.000 
occ-AccR: 94.533 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.021136916547278343
Strict IR :  0.0
Relaxed IR :  0.968104108190865
model 167
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([2, 3])
bi :  tensor([0, 0], device='cuda:0')
si.shape :  torch.Size([2])
ti.shape :  torch.Size([2])
s_pos.shape :  torch.Size([2, 3])
t_pos.shape :  torch.Size([2, 3])
ind.shape :  torch.Size([2, 3])
bi :  tensor([0, 0], device='cuda:0')
si.shape :  torch.Size([2])
ti.shape :  torch.Size([2])
s_pos.shape :  torch.Size([2, 3])
t_pos.shape :  torch.Size([2, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  2
fraction of true landmark correspondences returned from Lepard :  0.5
vec6d.shape :  torch.Size([1, 6])
ldmk_s.shape :  torch.Size([1, 3])
ldmk_t.shape :  torch.Size([1, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  1
fraction of true landmark correspondences returned from Outlier Rejection :  1.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.630 
full-AccS: 0.000 
full-AccR: 1.123 
full-outlier: 97.678 
vis-epe: 23.520 
vis-AccS: 0.000 
vis-AccR: 1.986 
vis-outlier: 95.894 
occ-epe: 23.774 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.22063633813306163
Strict IR :  0.0
Relaxed IR :  0.005613676958407757
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([2, 3])
bi :  tensor([0, 0], device='cuda:0')
si.shape :  torch.Size([2])
ti.shape :  torch.Size([2])
s_pos.shape :  torch.Size([2, 3])
t_pos.shape :  torch.Size([2, 3])
ind.shape :  torch.Size([2, 3])
bi :  tensor([0, 0], device='cuda:0')
si.shape :  torch.Size([2])
ti.shape :  torch.Size([2])
s_pos.shape :  torch.Size([2, 3])
t_pos.shape :  torch.Size([2, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  2
fraction of true landmark correspondences returned from Lepard :  1.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([2, 6])
ldmk_s.shape :  torch.Size([2, 3])
ldmk_t.shape :  torch.Size([2, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  2
fraction of true landmark correspondences returned from Outlier Rejection :  1.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.939 
full-AccS: 0.306 
full-AccR: 1.352 
full-outlier: 96.606 
vis-epe: 21.955 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.361 
occ-epe: 17.762 
occ-AccS: 0.637 
occ-AccR: 2.813 
occ-outlier: 93.631 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18579535262703958
Strict IR :  0.005868844092880837
Relaxed IR :  0.022965042102577188
model 207
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4272, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4272])
ti.shape :  torch.Size([4272])
s_pos.shape :  torch.Size([4272, 3])
t_pos.shape :  torch.Size([4272, 3])
ind.shape :  torch.Size([4272, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4272])
ti.shape :  torch.Size([4272])
s_pos.shape :  torch.Size([4272, 3])
t_pos.shape :  torch.Size([4272, 3])
number of true landmarks correspondences returned from Lepard :  61  out of  4272
fraction of true landmark correspondences returned from Lepard :  0.014279026217228465
vec6d.shape :  torch.Size([3338, 6])
ldmk_s.shape :  torch.Size([3338, 3])
ldmk_t.shape :  torch.Size([3338, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  3338
fraction of true landmark correspondences returned from Outlier Rejection :  0.013181545835829839
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3338, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 24.875 
full-AccS: 0.035 
full-AccR: 0.558 
full-outlier: 99.163 
vis-epe: 24.875 
vis-AccS: 0.035 
vis-AccR: 0.558 
vis-outlier: 99.163 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13597123298428868
Strict IR :  0.0024424284717376133
Relaxed IR :  0.026866713189113746
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2442, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2442])
ti.shape :  torch.Size([2442])
s_pos.shape :  torch.Size([2442, 3])
t_pos.shape :  torch.Size([2442, 3])
ind.shape :  torch.Size([2442, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2442])
ti.shape :  torch.Size([2442])
s_pos.shape :  torch.Size([2442, 3])
t_pos.shape :  torch.Size([2442, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  2442
fraction of true landmark correspondences returned from Lepard :  0.01678951678951679
vec6d.shape :  torch.Size([2351, 6])
ldmk_s.shape :  torch.Size([2351, 3])
ldmk_t.shape :  torch.Size([2351, 3])
number of true landmark correspondences returned from Outlier Rejection :  40  out of  2351
fraction of true landmark correspondences returned from Outlier Rejection :  0.017014036580178648
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2351, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.789 
full-AccS: 0.339 
full-AccR: 3.972 
full-outlier: 65.415 
vis-epe: 16.141 
vis-AccS: 0.000 
vis-AccR: 1.699 
vis-outlier: 75.131 
occ-epe: 10.842 
occ-AccS: 0.764 
occ-AccR: 6.819 
occ-outlier: 53.246 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10595992418576619
Strict IR :  0.007507871155243401
Relaxed IR :  0.06950835553402761
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4152, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4152])
ti.shape :  torch.Size([4152])
s_pos.shape :  torch.Size([4152, 3])
t_pos.shape :  torch.Size([4152, 3])
ind.shape :  torch.Size([4152, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4152])
ti.shape :  torch.Size([4152])
s_pos.shape :  torch.Size([4152, 3])
t_pos.shape :  torch.Size([4152, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  4152
fraction of true landmark correspondences returned from Lepard :  0.013728323699421965
vec6d.shape :  torch.Size([3286, 6])
ldmk_s.shape :  torch.Size([3286, 3])
ldmk_t.shape :  torch.Size([3286, 3])
number of true landmark correspondences returned from Outlier Rejection :  38  out of  3286
fraction of true landmark correspondences returned from Outlier Rejection :  0.011564211807668898
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3286, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 21.808 
full-AccS: 0.035 
full-AccR: 0.417 
full-outlier: 92.420 
vis-epe: 22.056 
vis-AccS: 0.036 
vis-AccR: 0.431 
vis-outlier: 92.250 
occ-epe: 14.025 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 97.753 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12734672765486904
Strict IR :  0.0
Relaxed IR :  0.024946236559139787
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2906, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2906])
ti.shape :  torch.Size([2906])
s_pos.shape :  torch.Size([2906, 3])
t_pos.shape :  torch.Size([2906, 3])
ind.shape :  torch.Size([2906, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2906])
ti.shape :  torch.Size([2906])
s_pos.shape :  torch.Size([2906, 3])
t_pos.shape :  torch.Size([2906, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  2906
fraction of true landmark correspondences returned from Lepard :  0.014108740536820371
vec6d.shape :  torch.Size([2202, 6])
ldmk_s.shape :  torch.Size([2202, 3])
ldmk_t.shape :  torch.Size([2202, 3])
number of true landmark correspondences returned from Outlier Rejection :  32  out of  2202
fraction of true landmark correspondences returned from Outlier Rejection :  0.014532243415077202
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2202, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.747 
full-AccS: 0.024 
full-AccR: 3.671 
full-outlier: 59.877 
vis-epe: 18.823 
vis-AccS: 0.041 
vis-AccR: 1.819 
vis-outlier: 73.667 
occ-epe: 11.620 
occ-AccS: 0.000 
occ-AccR: 6.156 
occ-outlier: 41.375 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11726123301746054
Strict IR :  0.0
Relaxed IR :  0.027475130270014213
model 207
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3186, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3186])
ti.shape :  torch.Size([3186])
s_pos.shape :  torch.Size([3186, 3])
t_pos.shape :  torch.Size([3186, 3])
ind.shape :  torch.Size([3186, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3186])
ti.shape :  torch.Size([3186])
s_pos.shape :  torch.Size([3186, 3])
t_pos.shape :  torch.Size([3186, 3])
number of true landmarks correspondences returned from Lepard :  53  out of  3186
fraction of true landmark correspondences returned from Lepard :  0.016635279347143754
vec6d.shape :  torch.Size([2541, 6])
ldmk_s.shape :  torch.Size([2541, 3])
ldmk_t.shape :  torch.Size([2541, 3])
number of true landmark correspondences returned from Outlier Rejection :  38  out of  2541
fraction of true landmark correspondences returned from Outlier Rejection :  0.0149547422274695
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2541, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 24.921 
full-AccS: 0.035 
full-AccR: 0.593 
full-outlier: 99.163 
vis-epe: 24.921 
vis-AccS: 0.035 
vis-AccR: 0.593 
vis-outlier: 99.163 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13648729735485166
Strict IR :  0.0024424284717376133
Relaxed IR :  0.02512212142358688
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1770, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1770])
ti.shape :  torch.Size([1770])
s_pos.shape :  torch.Size([1770, 3])
t_pos.shape :  torch.Size([1770, 3])
ind.shape :  torch.Size([1770, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1770])
ti.shape :  torch.Size([1770])
s_pos.shape :  torch.Size([1770, 3])
t_pos.shape :  torch.Size([1770, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  1770
fraction of true landmark correspondences returned from Lepard :  0.023163841807909605
vec6d.shape :  torch.Size([1701, 6])
ldmk_s.shape :  torch.Size([1701, 3])
ldmk_t.shape :  torch.Size([1701, 3])
number of true landmark correspondences returned from Outlier Rejection :  40  out of  1701
fraction of true landmark correspondences returned from Outlier Rejection :  0.023515579071134628
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1701, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.734 
full-AccS: 0.727 
full-AccR: 26.592 
full-outlier: 20.901 
vis-epe: 9.742 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 37.587 
occ-epe: 2.967 
occ-AccS: 1.637 
occ-AccR: 59.902 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.031797857137641695
Strict IR :  0.0
Relaxed IR :  0.5335432308064907
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3136, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3136])
ti.shape :  torch.Size([3136])
s_pos.shape :  torch.Size([3136, 3])
t_pos.shape :  torch.Size([3136, 3])
ind.shape :  torch.Size([3136, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3136])
ti.shape :  torch.Size([3136])
s_pos.shape :  torch.Size([3136, 3])
t_pos.shape :  torch.Size([3136, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  3136
fraction of true landmark correspondences returned from Lepard :  0.013073979591836735
vec6d.shape :  torch.Size([2591, 6])
ldmk_s.shape :  torch.Size([2591, 3])
ldmk_t.shape :  torch.Size([2591, 3])
number of true landmark correspondences returned from Outlier Rejection :  31  out of  2591
fraction of true landmark correspondences returned from Outlier Rejection :  0.011964492473948282
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2591, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.807 
full-AccS: 0.035 
full-AccR: 0.695 
full-outlier: 92.942 
vis-epe: 23.093 
vis-AccS: 0.036 
vis-AccR: 0.718 
vis-outlier: 92.824 
occ-epe: 13.877 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 96.629 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13171770255627477
Strict IR :  0.00043010752688172043
Relaxed IR :  0.023655913978494623
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2749, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2749])
ti.shape :  torch.Size([2749])
s_pos.shape :  torch.Size([2749, 3])
t_pos.shape :  torch.Size([2749, 3])
ind.shape :  torch.Size([2749, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2749])
ti.shape :  torch.Size([2749])
s_pos.shape :  torch.Size([2749, 3])
t_pos.shape :  torch.Size([2749, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  2749
fraction of true landmark correspondences returned from Lepard :  0.014914514368861403
vec6d.shape :  torch.Size([2085, 6])
ldmk_s.shape :  torch.Size([2085, 3])
ldmk_t.shape :  torch.Size([2085, 3])
number of true landmark correspondences returned from Outlier Rejection :  34  out of  2085
fraction of true landmark correspondences returned from Outlier Rejection :  0.01630695443645084
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2085, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.725 
full-AccS: 0.024 
full-AccR: 3.742 
full-outlier: 59.758 
vis-epe: 18.834 
vis-AccS: 0.041 
vis-AccR: 1.819 
vis-outlier: 73.832 
occ-epe: 11.554 
occ-AccS: 0.000 
occ-AccR: 6.323 
occ-outlier: 40.876 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11676860102454323
Strict IR :  0.0
Relaxed IR :  0.030080530554239697
model 207
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1566, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1566])
ti.shape :  torch.Size([1566])
s_pos.shape :  torch.Size([1566, 3])
t_pos.shape :  torch.Size([1566, 3])
ind.shape :  torch.Size([1566, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1566])
ti.shape :  torch.Size([1566])
s_pos.shape :  torch.Size([1566, 3])
t_pos.shape :  torch.Size([1566, 3])
number of true landmarks correspondences returned from Lepard :  18  out of  1566
fraction of true landmark correspondences returned from Lepard :  0.011494252873563218
vec6d.shape :  torch.Size([1244, 6])
ldmk_s.shape :  torch.Size([1244, 3])
ldmk_t.shape :  torch.Size([1244, 3])
number of true landmark correspondences returned from Outlier Rejection :  16  out of  1244
fraction of true landmark correspondences returned from Outlier Rejection :  0.012861736334405145
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1244, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 24.834 
full-AccS: 0.070 
full-AccR: 0.558 
full-outlier: 99.163 
vis-epe: 24.834 
vis-AccS: 0.070 
vis-AccR: 0.558 
vis-outlier: 99.163 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13560374115140794
Strict IR :  0.0027913468248429866
Relaxed IR :  0.026517794836008374
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([821, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([821])
ti.shape :  torch.Size([821])
s_pos.shape :  torch.Size([821, 3])
t_pos.shape :  torch.Size([821, 3])
ind.shape :  torch.Size([821, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([821])
ti.shape :  torch.Size([821])
s_pos.shape :  torch.Size([821, 3])
t_pos.shape :  torch.Size([821, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  821
fraction of true landmark correspondences returned from Lepard :  0.049939098660170524
vec6d.shape :  torch.Size([791, 6])
ldmk_s.shape :  torch.Size([791, 3])
ldmk_t.shape :  torch.Size([791, 3])
number of true landmark correspondences returned from Outlier Rejection :  41  out of  791
fraction of true landmark correspondences returned from Outlier Rejection :  0.051833122629582805
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([791, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 5.874 
full-AccS: 2.664 
full-AccR: 45.750 
full-outlier: 17.559 
vis-epe: 8.947 
vis-AccS: 0.000 
vis-AccR: 4.965 
vis-outlier: 31.577 
occ-epe: 2.026 
occ-AccS: 6.001 
occ-AccR: 96.836 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.020930461345921685
Strict IR :  0.06878178735771373
Relaxed IR :  0.9300072656817632
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1534, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1534])
ti.shape :  torch.Size([1534])
s_pos.shape :  torch.Size([1534, 3])
t_pos.shape :  torch.Size([1534, 3])
ind.shape :  torch.Size([1534, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1534])
ti.shape :  torch.Size([1534])
s_pos.shape :  torch.Size([1534, 3])
t_pos.shape :  torch.Size([1534, 3])
number of true landmarks correspondences returned from Lepard :  15  out of  1534
fraction of true landmark correspondences returned from Lepard :  0.009778357235984355
vec6d.shape :  torch.Size([1345, 6])
ldmk_s.shape :  torch.Size([1345, 3])
ldmk_t.shape :  torch.Size([1345, 3])
number of true landmark correspondences returned from Outlier Rejection :  15  out of  1345
fraction of true landmark correspondences returned from Outlier Rejection :  0.011152416356877323
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1345, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.961 
full-AccS: 0.070 
full-AccR: 1.704 
full-outlier: 86.196 
vis-epe: 21.532 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 88.913 
occ-epe: 3.082 
occ-AccS: 2.247 
occ-AccR: 55.056 
occ-outlier: 1.124 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12731577387159332
Strict IR :  0.00043010752688172043
Relaxed IR :  0.03225806451612903
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1403, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1403])
ti.shape :  torch.Size([1403])
s_pos.shape :  torch.Size([1403, 3])
t_pos.shape :  torch.Size([1403, 3])
ind.shape :  torch.Size([1403, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1403])
ti.shape :  torch.Size([1403])
s_pos.shape :  torch.Size([1403, 3])
t_pos.shape :  torch.Size([1403, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  1403
fraction of true landmark correspondences returned from Lepard :  0.029223093371347115
vec6d.shape :  torch.Size([1084, 6])
ldmk_s.shape :  torch.Size([1084, 3])
ldmk_t.shape :  torch.Size([1084, 3])
number of true landmark correspondences returned from Outlier Rejection :  34  out of  1084
fraction of true landmark correspondences returned from Outlier Rejection :  0.03136531365313653
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1084, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.665 
full-AccS: 0.024 
full-AccR: 3.766 
full-outlier: 59.782 
vis-epe: 18.775 
vis-AccS: 0.041 
vis-AccR: 1.778 
vis-outlier: 73.915 
occ-epe: 11.491 
occ-AccS: 0.000 
occ-AccR: 6.434 
occ-outlier: 40.821 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11624467779812607
Strict IR :  0.0
Relaxed IR :  0.02936996684036002
model 207
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([67, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([67])
ti.shape :  torch.Size([67])
s_pos.shape :  torch.Size([67, 3])
t_pos.shape :  torch.Size([67, 3])
ind.shape :  torch.Size([67, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([67])
ti.shape :  torch.Size([67])
s_pos.shape :  torch.Size([67, 3])
t_pos.shape :  torch.Size([67, 3])
number of true landmarks correspondences returned from Lepard :  5  out of  67
fraction of true landmark correspondences returned from Lepard :  0.07462686567164178
vec6d.shape :  torch.Size([60, 6])
ldmk_s.shape :  torch.Size([60, 3])
ldmk_t.shape :  torch.Size([60, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  60
fraction of true landmark correspondences returned from Outlier Rejection :  0.08333333333333333
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([60, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.223 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.895 
vis-epe: 23.223 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.895 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13666654219443944
Strict IR :  0.0027913468248429866
Relaxed IR :  0.03558967201674808
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([122, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([122])
ti.shape :  torch.Size([122])
s_pos.shape :  torch.Size([122, 3])
t_pos.shape :  torch.Size([122, 3])
ind.shape :  torch.Size([122, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([122])
ti.shape :  torch.Size([122])
s_pos.shape :  torch.Size([122, 3])
t_pos.shape :  torch.Size([122, 3])
number of true landmarks correspondences returned from Lepard :  15  out of  122
fraction of true landmark correspondences returned from Lepard :  0.12295081967213115
vec6d.shape :  torch.Size([113, 6])
ldmk_s.shape :  torch.Size([113, 3])
ldmk_t.shape :  torch.Size([113, 3])
number of true landmark correspondences returned from Outlier Rejection :  15  out of  113
fraction of true landmark correspondences returned from Outlier Rejection :  0.13274336283185842
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([113, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 5.948 
full-AccS: 6.273 
full-AccR: 45.289 
full-outlier: 17.898 
vis-epe: 9.106 
vis-AccS: 0.000 
vis-AccR: 3.484 
vis-outlier: 32.186 
occ-epe: 1.993 
occ-AccS: 14.130 
occ-AccR: 97.654 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.020423614766152648
Strict IR :  0.15548558973116977
Relaxed IR :  0.9348510535238557
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([55, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([55])
ti.shape :  torch.Size([55])
s_pos.shape :  torch.Size([55, 3])
t_pos.shape :  torch.Size([55, 3])
ind.shape :  torch.Size([55, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([55])
ti.shape :  torch.Size([55])
s_pos.shape :  torch.Size([55, 3])
t_pos.shape :  torch.Size([55, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  55
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([51, 6])
ldmk_s.shape :  torch.Size([51, 3])
ldmk_t.shape :  torch.Size([51, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  51
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([51, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 21.712 
full-AccS: 0.174 
full-AccR: 1.287 
full-outlier: 85.779 
vis-epe: 22.288 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 88.482 
occ-epe: 3.701 
occ-AccS: 5.618 
occ-AccR: 41.573 
occ-outlier: 1.124 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1321602562286511
Strict IR :  0.005591397849462366
Relaxed IR :  0.05161290322580645
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([44, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([44])
ti.shape :  torch.Size([44])
s_pos.shape :  torch.Size([44, 3])
t_pos.shape :  torch.Size([44, 3])
ind.shape :  torch.Size([44, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([44])
ti.shape :  torch.Size([44])
s_pos.shape :  torch.Size([44, 3])
t_pos.shape :  torch.Size([44, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  44
fraction of true landmark correspondences returned from Lepard :  0.13636363636363635
vec6d.shape :  torch.Size([42, 6])
ldmk_s.shape :  torch.Size([42, 3])
ldmk_t.shape :  torch.Size([42, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  42
fraction of true landmark correspondences returned from Outlier Rejection :  0.11904761904761904
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([42, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.338 
full-AccS: 1.540 
full-AccR: 41.402 
full-outlier: 17.243 
vis-epe: 10.649 
vis-AccS: 0.000 
vis-AccR: 3.886 
vis-outlier: 30.095 
occ-epe: 2.896 
occ-AccS: 3.605 
occ-AccR: 91.736 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.025449108618989864
Strict IR :  0.07224064424443392
Relaxed IR :  0.716958787304595
model 207
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  3
fraction of true landmark correspondences returned from Lepard :  0.3333333333333333
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.3333333333333333
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.165 
full-AccS: 7.290 
full-AccR: 34.512 
full-outlier: 18.019 
vis-epe: 9.119 
vis-AccS: 0.305 
vis-AccR: 6.664 
vis-outlier: 32.404 
occ-epe: 2.466 
occ-AccS: 16.039 
occ-AccR: 69.394 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0331039115511442
Strict IR :  0.05739888592879632
Relaxed IR :  0.5221603293775733
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  1
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([1, 6])
ldmk_s.shape :  torch.Size([1, 3])
ldmk_t.shape :  torch.Size([1, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  1
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.460 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 94.611 
vis-epe: 22.739 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 94.582 
occ-epe: 13.720 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 95.506 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13618544344920439
Strict IR :  0.0
Relaxed IR :  0.0
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  1
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([1, 6])
ldmk_s.shape :  torch.Size([1, 3])
ldmk_t.shape :  torch.Size([1, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  1
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.976 
full-AccS: 0.000 
full-AccR: 3.340 
full-outlier: 68.025 
vis-epe: 23.616 
vis-AccS: 0.000 
vis-AccR: 0.041 
vis-outlier: 79.826 
occ-epe: 15.092 
occ-AccS: 0.000 
occ-AccR: 7.765 
occ-outlier: 52.191 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18371394591131193
Strict IR :  0.0
Relaxed IR :  0.020606347702510658
