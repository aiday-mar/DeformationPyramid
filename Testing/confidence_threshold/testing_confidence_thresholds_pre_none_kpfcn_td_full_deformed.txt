model 002
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  122  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0244
vec6d.shape :  torch.Size([3377, 6])
ldmk_s.shape :  torch.Size([3377, 3])
ldmk_t.shape :  torch.Size([3377, 3])
number of true landmark correspondences returned from Outlier Rejection :  113  out of  3377
fraction of true landmark correspondences returned from Outlier Rejection :  0.033461652354160494
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3377, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.484 
full-AccS: 0.000 
full-AccR: 0.882 
full-outlier: 95.185 
vis-epe: 18.484 
vis-AccS: 0.000 
vis-AccR: 0.882 
vis-outlier: 95.185 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019009659753704604
Strict IR :  0.0
Relaxed IR :  1.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  45  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.009
vec6d.shape :  torch.Size([3408, 6])
ldmk_s.shape :  torch.Size([3408, 3])
ldmk_t.shape :  torch.Size([3408, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  3408
fraction of true landmark correspondences returned from Outlier Rejection :  0.009683098591549295
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3408, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.017 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.643 
vis-epe: 22.246 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.706 
occ-epe: 21.819 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.588 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.19816524483086725
Strict IR :  0.0
Relaxed IR :  0.011449579831932772
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  110  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.022
vec6d.shape :  torch.Size([4507, 6])
ldmk_s.shape :  torch.Size([4507, 3])
ldmk_t.shape :  torch.Size([4507, 3])
number of true landmark correspondences returned from Outlier Rejection :  98  out of  4507
fraction of true landmark correspondences returned from Outlier Rejection :  0.02174395384956734
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4507, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.079 
full-AccS: 0.339 
full-AccR: 5.555 
full-outlier: 83.370 
vis-epe: 16.779 
vis-AccS: 0.107 
vis-AccR: 1.333 
vis-outlier: 87.504 
occ-epe: 1.956 
occ-AccS: 5.018 
occ-AccR: 90.681 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.022667827740484498
Strict IR :  0.026584867075664622
Relaxed IR :  0.8646216768916155
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  45  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.009
vec6d.shape :  torch.Size([3714, 6])
ldmk_s.shape :  torch.Size([3714, 3])
ldmk_t.shape :  torch.Size([3714, 3])
number of true landmark correspondences returned from Outlier Rejection :  42  out of  3714
fraction of true landmark correspondences returned from Outlier Rejection :  0.011308562197092083
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3714, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.907 
full-AccS: 0.000 
full-AccR: 0.256 
full-outlier: 99.222 
vis-epe: 23.142 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 19.071 
occ-AccS: 0.000 
occ-AccR: 0.466 
occ-outlier: 98.582 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17923116303941783
Strict IR :  0.0
Relaxed IR :  0.018763326226012792
model 002
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  122  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0244
vec6d.shape :  torch.Size([3377, 6])
ldmk_s.shape :  torch.Size([3377, 3])
ldmk_t.shape :  torch.Size([3377, 3])
number of true landmark correspondences returned from Outlier Rejection :  113  out of  3377
fraction of true landmark correspondences returned from Outlier Rejection :  0.033461652354160494
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3377, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.484 
full-AccS: 0.000 
full-AccR: 0.882 
full-outlier: 95.185 
vis-epe: 18.484 
vis-AccS: 0.000 
vis-AccR: 0.882 
vis-outlier: 95.185 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019009659753704604
Strict IR :  0.0
Relaxed IR :  1.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  45  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.009
vec6d.shape :  torch.Size([3408, 6])
ldmk_s.shape :  torch.Size([3408, 3])
ldmk_t.shape :  torch.Size([3408, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  3408
fraction of true landmark correspondences returned from Outlier Rejection :  0.009683098591549295
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3408, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 22.017 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.643 
vis-epe: 22.246 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.706 
occ-epe: 21.819 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.588 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.19816524483086725
Strict IR :  0.0
Relaxed IR :  0.011449579831932772
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  110  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.022
vec6d.shape :  torch.Size([4507, 6])
ldmk_s.shape :  torch.Size([4507, 3])
ldmk_t.shape :  torch.Size([4507, 3])
number of true landmark correspondences returned from Outlier Rejection :  98  out of  4507
fraction of true landmark correspondences returned from Outlier Rejection :  0.02174395384956734
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4507, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.079 
full-AccS: 0.339 
full-AccR: 5.555 
full-outlier: 83.370 
vis-epe: 16.779 
vis-AccS: 0.107 
vis-AccR: 1.333 
vis-outlier: 87.504 
occ-epe: 1.956 
occ-AccS: 5.018 
occ-AccR: 90.681 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.022667827740484498
Strict IR :  0.026584867075664622
Relaxed IR :  0.8646216768916155
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  45  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.009
vec6d.shape :  torch.Size([3714, 6])
ldmk_s.shape :  torch.Size([3714, 3])
ldmk_t.shape :  torch.Size([3714, 3])
number of true landmark correspondences returned from Outlier Rejection :  42  out of  3714
fraction of true landmark correspondences returned from Outlier Rejection :  0.011308562197092083
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3714, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.907 
full-AccS: 0.000 
full-AccR: 0.256 
full-outlier: 99.222 
vis-epe: 23.142 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 19.071 
occ-AccS: 0.000 
occ-AccR: 0.466 
occ-outlier: 98.582 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17923116303941783
Strict IR :  0.0
Relaxed IR :  0.018763326226012792
model 002
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3942, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3942])
ti.shape :  torch.Size([3942])
s_pos.shape :  torch.Size([3942, 3])
t_pos.shape :  torch.Size([3942, 3])
ind.shape :  torch.Size([3942, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3942])
ti.shape :  torch.Size([3942])
s_pos.shape :  torch.Size([3942, 3])
t_pos.shape :  torch.Size([3942, 3])
number of true landmarks correspondences returned from Lepard :  113  out of  3942
fraction of true landmark correspondences returned from Lepard :  0.028665651953323185
vec6d.shape :  torch.Size([2687, 6])
ldmk_s.shape :  torch.Size([2687, 3])
ldmk_t.shape :  torch.Size([2687, 3])
number of true landmark correspondences returned from Outlier Rejection :  104  out of  2687
fraction of true landmark correspondences returned from Outlier Rejection :  0.03870487532564198
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2687, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.490 
full-AccS: 0.000 
full-AccR: 0.882 
full-outlier: 95.219 
vis-epe: 18.490 
vis-AccS: 0.000 
vis-AccR: 0.882 
vis-outlier: 95.219 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.018944369250617526
Strict IR :  0.0
Relaxed IR :  1.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3437, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3437])
ti.shape :  torch.Size([3437])
s_pos.shape :  torch.Size([3437, 3])
t_pos.shape :  torch.Size([3437, 3])
ind.shape :  torch.Size([3437, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3437])
ti.shape :  torch.Size([3437])
s_pos.shape :  torch.Size([3437, 3])
t_pos.shape :  torch.Size([3437, 3])
number of true landmarks correspondences returned from Lepard :  33  out of  3437
fraction of true landmark correspondences returned from Lepard :  0.009601396566773349
vec6d.shape :  torch.Size([2401, 6])
ldmk_s.shape :  torch.Size([2401, 3])
ldmk_t.shape :  torch.Size([2401, 3])
number of true landmark correspondences returned from Outlier Rejection :  27  out of  2401
fraction of true landmark correspondences returned from Outlier Rejection :  0.011245314452311536
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2401, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 21.922 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 99.632 
vis-epe: 22.211 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.570 
occ-epe: 21.670 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 99.686 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.19692637510357125
Strict IR :  0.0001050420168067227
Relaxed IR :  0.011554621848739496
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([4479, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4479])
ti.shape :  torch.Size([4479])
s_pos.shape :  torch.Size([4479, 3])
t_pos.shape :  torch.Size([4479, 3])
ind.shape :  torch.Size([4479, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4479])
ti.shape :  torch.Size([4479])
s_pos.shape :  torch.Size([4479, 3])
t_pos.shape :  torch.Size([4479, 3])
number of true landmarks correspondences returned from Lepard :  108  out of  4479
fraction of true landmark correspondences returned from Lepard :  0.024112525117213665
vec6d.shape :  torch.Size([4044, 6])
ldmk_s.shape :  torch.Size([4044, 3])
ldmk_t.shape :  torch.Size([4044, 3])
number of true landmark correspondences returned from Outlier Rejection :  96  out of  4044
fraction of true landmark correspondences returned from Outlier Rejection :  0.02373887240356083
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4044, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.099 
full-AccS: 0.203 
full-AccR: 5.453 
full-outlier: 83.421 
vis-epe: 16.781 
vis-AccS: 0.107 
vis-AccR: 1.315 
vis-outlier: 87.558 
occ-epe: 2.333 
occ-AccS: 2.151 
occ-AccR: 88.889 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.023966697488443732
Strict IR :  0.01820040899795501
Relaxed IR :  0.821881390593047
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3677, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3677])
ti.shape :  torch.Size([3677])
s_pos.shape :  torch.Size([3677, 3])
t_pos.shape :  torch.Size([3677, 3])
ind.shape :  torch.Size([3677, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3677])
ti.shape :  torch.Size([3677])
s_pos.shape :  torch.Size([3677, 3])
t_pos.shape :  torch.Size([3677, 3])
number of true landmarks correspondences returned from Lepard :  43  out of  3677
fraction of true landmark correspondences returned from Lepard :  0.011694316018493337
vec6d.shape :  torch.Size([2715, 6])
ldmk_s.shape :  torch.Size([2715, 3])
ldmk_t.shape :  torch.Size([2715, 3])
number of true landmark correspondences returned from Outlier Rejection :  40  out of  2715
fraction of true landmark correspondences returned from Outlier Rejection :  0.014732965009208104
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2715, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.449 
full-AccS: 0.000 
full-AccR: 0.629 
full-outlier: 98.710 
vis-epe: 22.851 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.976 
occ-epe: 18.476 
occ-AccS: 0.000 
occ-AccR: 1.146 
occ-outlier: 97.669 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17513497707432613
Strict IR :  0.0
Relaxed IR :  0.02302771855010661
model 002
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([22, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([22])
ti.shape :  torch.Size([22])
s_pos.shape :  torch.Size([22, 3])
t_pos.shape :  torch.Size([22, 3])
ind.shape :  torch.Size([22, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([22])
ti.shape :  torch.Size([22])
s_pos.shape :  torch.Size([22, 3])
t_pos.shape :  torch.Size([22, 3])
number of true landmarks correspondences returned from Lepard :  3  out of  22
fraction of true landmark correspondences returned from Lepard :  0.13636363636363635
vec6d.shape :  torch.Size([22, 6])
ldmk_s.shape :  torch.Size([22, 3])
ldmk_t.shape :  torch.Size([22, 3])
number of true landmark correspondences returned from Outlier Rejection :  3  out of  22
fraction of true landmark correspondences returned from Outlier Rejection :  0.13636363636363635
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([22, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.274 
full-AccS: 0.102 
full-AccR: 0.983 
full-outlier: 95.202 
vis-epe: 19.274 
vis-AccS: 0.102 
vis-AccR: 0.983 
vis-outlier: 95.202 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.028733978790341085
Strict IR :  0.08019667683960664
Relaxed IR :  0.612580535774839
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([21, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([21])
ti.shape :  torch.Size([21])
s_pos.shape :  torch.Size([21, 3])
t_pos.shape :  torch.Size([21, 3])
ind.shape :  torch.Size([21, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([21])
ti.shape :  torch.Size([21])
s_pos.shape :  torch.Size([21, 3])
t_pos.shape :  torch.Size([21, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  21
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([19, 6])
ldmk_s.shape :  torch.Size([19, 3])
ldmk_t.shape :  torch.Size([19, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  19
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([19, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 23.018 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 98.739 
vis-epe: 23.103 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 99.977 
occ-epe: 22.944 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 97.666 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.20965009552070227
Strict IR :  0.0
Relaxed IR :  0.0001050420168067227
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([12, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([12])
ti.shape :  torch.Size([12])
s_pos.shape :  torch.Size([12, 3])
t_pos.shape :  torch.Size([12, 3])
ind.shape :  torch.Size([12, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([12])
ti.shape :  torch.Size([12])
s_pos.shape :  torch.Size([12, 3])
t_pos.shape :  torch.Size([12, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  12
fraction of true landmark correspondences returned from Lepard :  0.08333333333333333
vec6d.shape :  torch.Size([12, 6])
ldmk_s.shape :  torch.Size([12, 3])
ldmk_t.shape :  torch.Size([12, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  12
fraction of true landmark correspondences returned from Outlier Rejection :  0.08333333333333333
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([12, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 29.856 
full-AccS: 0.000 
full-AccR: 0.186 
full-outlier: 97.104 
vis-epe: 30.176 
vis-AccS: 0.000 
vis-AccR: 0.196 
vis-outlier: 97.121 
occ-epe: 23.394 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 96.774 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15997531134872023
Strict IR :  0.0
Relaxed IR :  0.0196319018404908
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([24, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([24])
ti.shape :  torch.Size([24])
s_pos.shape :  torch.Size([24, 3])
t_pos.shape :  torch.Size([24, 3])
ind.shape :  torch.Size([24, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([24])
ti.shape :  torch.Size([24])
s_pos.shape :  torch.Size([24, 3])
t_pos.shape :  torch.Size([24, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  24
fraction of true landmark correspondences returned from Lepard :  0.041666666666666664
vec6d.shape :  torch.Size([23, 6])
ldmk_s.shape :  torch.Size([23, 3])
ldmk_t.shape :  torch.Size([23, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  23
fraction of true landmark correspondences returned from Outlier Rejection :  0.043478260869565216
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([23, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.273 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 100.000 
vis-epe: 27.818 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 25.003 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.2390319432365557
Strict IR :  0.0
Relaxed IR :  0.0
model 002
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[156, 163]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([319, 2048])
block_i :  1
x.shape :  torch.Size([319, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 319])
coarse_feats.shape :  torch.Size([1, 528, 319])
coarse_feats.shape :  torch.Size([319, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 156])
tgt_mask.shape :  torch.Size([1, 163])
src_ind_coarse_split.shape :  torch.Size([156])
tgt_ind_coarse_split.shape :  torch.Size([163])
src_ind_coarse.shape :  torch.Size([156])
tgt_ind_coarse.shape :  torch.Size([163])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[132, 123]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 132])
tgt_mask.shape :  torch.Size([1, 123])
src_ind_coarse_split.shape :  torch.Size([132])
tgt_ind_coarse_split.shape :  torch.Size([123])
src_ind_coarse.shape :  torch.Size([132])
tgt_ind_coarse.shape :  torch.Size([123])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[150, 164]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([314, 2048])
block_i :  1
x.shape :  torch.Size([314, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 314])
coarse_feats.shape :  torch.Size([1, 528, 314])
coarse_feats.shape :  torch.Size([314, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 150])
tgt_mask.shape :  torch.Size([1, 164])
src_ind_coarse_split.shape :  torch.Size([150])
tgt_ind_coarse_split.shape :  torch.Size([164])
src_ind_coarse.shape :  torch.Size([150])
tgt_ind_coarse.shape :  torch.Size([164])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([255, 2048])
block_i :  1
x.shape :  torch.Size([255, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 255])
coarse_feats.shape :  torch.Size([1, 528, 255])
coarse_feats.shape :  torch.Size([255, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 042
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  102  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0204
vec6d.shape :  torch.Size([3455, 6])
ldmk_s.shape :  torch.Size([3455, 3])
ldmk_t.shape :  torch.Size([3455, 3])
number of true landmark correspondences returned from Outlier Rejection :  93  out of  3455
fraction of true landmark correspondences returned from Outlier Rejection :  0.026917510853835022
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3455, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.894 
full-AccS: 0.534 
full-AccR: 3.899 
full-outlier: 90.453 
vis-epe: 12.894 
vis-AccS: 0.534 
vis-AccR: 3.899 
vis-outlier: 90.453 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019306852238025047
Strict IR :  0.18037167496659784
Relaxed IR :  0.9669622251913033
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  47  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0094
vec6d.shape :  torch.Size([3423, 6])
ldmk_s.shape :  torch.Size([3423, 3])
ldmk_t.shape :  torch.Size([3423, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  3423
fraction of true landmark correspondences returned from Outlier Rejection :  0.012854221443178498
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3423, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 27.473 
full-AccS: 0.023 
full-AccR: 1.447 
full-outlier: 98.123 
vis-epe: 30.160 
vis-AccS: 0.031 
vis-AccR: 1.043 
vis-outlier: 98.552 
occ-epe: 20.350 
occ-AccS: 0.000 
occ-AccR: 2.519 
occ-outlier: 96.986 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18047468563916355
Strict IR :  0.0
Relaxed IR :  0.02714011082211919
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  96  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0192
vec6d.shape :  torch.Size([3490, 6])
ldmk_s.shape :  torch.Size([3490, 3])
ldmk_t.shape :  torch.Size([3490, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  3490
fraction of true landmark correspondences returned from Outlier Rejection :  0.02177650429799427
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3490, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.339 
full-AccS: 0.073 
full-AccR: 4.089 
full-outlier: 68.522 
vis-epe: 10.713 
vis-AccS: 0.114 
vis-AccR: 2.512 
vis-outlier: 77.198 
occ-epe: 6.881 
occ-AccS: 0.000 
occ-AccR: 6.907 
occ-outlier: 53.011 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0523084114551023
Strict IR :  0.0023285351397121083
Relaxed IR :  0.1443691786621507
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  82  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0164
vec6d.shape :  torch.Size([3962, 6])
ldmk_s.shape :  torch.Size([3962, 3])
ldmk_t.shape :  torch.Size([3962, 3])
number of true landmark correspondences returned from Outlier Rejection :  69  out of  3962
fraction of true landmark correspondences returned from Outlier Rejection :  0.01741544674406865
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3962, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.473 
full-AccS: 0.482 
full-AccR: 5.027 
full-outlier: 92.191 
vis-epe: 13.247 
vis-AccS: 0.089 
vis-AccR: 2.311 
vis-outlier: 95.482 
occ-epe: 6.563 
occ-AccS: 1.568 
occ-AccR: 12.546 
occ-outlier: 83.079 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.059389610321395656
Strict IR :  0.012595837897042717
Relaxed IR :  0.15958378970427164
model 042
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  102  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0204
vec6d.shape :  torch.Size([3455, 6])
ldmk_s.shape :  torch.Size([3455, 3])
ldmk_t.shape :  torch.Size([3455, 3])
number of true landmark correspondences returned from Outlier Rejection :  93  out of  3455
fraction of true landmark correspondences returned from Outlier Rejection :  0.026917510853835022
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3455, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.894 
full-AccS: 0.534 
full-AccR: 3.899 
full-outlier: 90.453 
vis-epe: 12.894 
vis-AccS: 0.534 
vis-AccR: 3.899 
vis-outlier: 90.453 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019306852238025047
Strict IR :  0.18037167496659784
Relaxed IR :  0.9669622251913033
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  47  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0094
vec6d.shape :  torch.Size([3423, 6])
ldmk_s.shape :  torch.Size([3423, 3])
ldmk_t.shape :  torch.Size([3423, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  3423
fraction of true landmark correspondences returned from Outlier Rejection :  0.012854221443178498
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3423, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 27.473 
full-AccS: 0.023 
full-AccR: 1.447 
full-outlier: 98.123 
vis-epe: 30.160 
vis-AccS: 0.031 
vis-AccR: 1.043 
vis-outlier: 98.552 
occ-epe: 20.350 
occ-AccS: 0.000 
occ-AccR: 2.519 
occ-outlier: 96.986 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.18047468563916355
Strict IR :  0.0
Relaxed IR :  0.02714011082211919
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  96  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0192
vec6d.shape :  torch.Size([3490, 6])
ldmk_s.shape :  torch.Size([3490, 3])
ldmk_t.shape :  torch.Size([3490, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  3490
fraction of true landmark correspondences returned from Outlier Rejection :  0.02177650429799427
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3490, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.339 
full-AccS: 0.073 
full-AccR: 4.089 
full-outlier: 68.522 
vis-epe: 10.713 
vis-AccS: 0.114 
vis-AccR: 2.512 
vis-outlier: 77.198 
occ-epe: 6.881 
occ-AccS: 0.000 
occ-AccR: 6.907 
occ-outlier: 53.011 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0523084114551023
Strict IR :  0.0023285351397121083
Relaxed IR :  0.1443691786621507
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  82  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0164
vec6d.shape :  torch.Size([3962, 6])
ldmk_s.shape :  torch.Size([3962, 3])
ldmk_t.shape :  torch.Size([3962, 3])
number of true landmark correspondences returned from Outlier Rejection :  69  out of  3962
fraction of true landmark correspondences returned from Outlier Rejection :  0.01741544674406865
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3962, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.473 
full-AccS: 0.482 
full-AccR: 5.027 
full-outlier: 92.191 
vis-epe: 13.247 
vis-AccS: 0.089 
vis-AccR: 2.311 
vis-outlier: 95.482 
occ-epe: 6.563 
occ-AccS: 1.568 
occ-AccR: 12.546 
occ-outlier: 83.079 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.059389610321395656
Strict IR :  0.012595837897042717
Relaxed IR :  0.15958378970427164
model 042
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([2888, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2888])
ti.shape :  torch.Size([2888])
s_pos.shape :  torch.Size([2888, 3])
t_pos.shape :  torch.Size([2888, 3])
ind.shape :  torch.Size([2888, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2888])
ti.shape :  torch.Size([2888])
s_pos.shape :  torch.Size([2888, 3])
t_pos.shape :  torch.Size([2888, 3])
number of true landmarks correspondences returned from Lepard :  94  out of  2888
fraction of true landmark correspondences returned from Lepard :  0.03254847645429363
vec6d.shape :  torch.Size([2241, 6])
ldmk_s.shape :  torch.Size([2241, 3])
ldmk_t.shape :  torch.Size([2241, 3])
number of true landmark correspondences returned from Outlier Rejection :  91  out of  2241
fraction of true landmark correspondences returned from Outlier Rejection :  0.04060687193217314
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2241, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.741 
full-AccS: 0.607 
full-AccR: 4.178 
full-outlier: 90.587 
vis-epe: 12.741 
vis-AccS: 0.607 
vis-AccR: 4.178 
vis-outlier: 90.587 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.023187697741201767
Strict IR :  0.17211223126442365
Relaxed IR :  0.7856188509656261
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3040, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3040])
ti.shape :  torch.Size([3040])
s_pos.shape :  torch.Size([3040, 3])
t_pos.shape :  torch.Size([3040, 3])
ind.shape :  torch.Size([3040, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3040])
ti.shape :  torch.Size([3040])
s_pos.shape :  torch.Size([3040, 3])
t_pos.shape :  torch.Size([3040, 3])
number of true landmarks correspondences returned from Lepard :  31  out of  3040
fraction of true landmark correspondences returned from Lepard :  0.010197368421052632
vec6d.shape :  torch.Size([2105, 6])
ldmk_s.shape :  torch.Size([2105, 3])
ldmk_t.shape :  torch.Size([2105, 3])
number of true landmark correspondences returned from Outlier Rejection :  31  out of  2105
fraction of true landmark correspondences returned from Outlier Rejection :  0.014726840855106888
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2105, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 27.381 
full-AccS: 0.034 
full-AccR: 1.470 
full-outlier: 98.191 
vis-epe: 30.145 
vis-AccS: 0.047 
vis-AccR: 0.997 
vis-outlier: 98.629 
occ-epe: 20.055 
occ-AccS: 0.000 
occ-AccR: 2.725 
occ-outlier: 97.027 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17822837779126224
Strict IR :  0.00011308379509216329
Relaxed IR :  0.028270948773040823
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([2583, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2583])
ti.shape :  torch.Size([2583])
s_pos.shape :  torch.Size([2583, 3])
t_pos.shape :  torch.Size([2583, 3])
ind.shape :  torch.Size([2583, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2583])
ti.shape :  torch.Size([2583])
s_pos.shape :  torch.Size([2583, 3])
t_pos.shape :  torch.Size([2583, 3])
number of true landmarks correspondences returned from Lepard :  73  out of  2583
fraction of true landmark correspondences returned from Lepard :  0.028261711188540456
vec6d.shape :  torch.Size([1757, 6])
ldmk_s.shape :  torch.Size([1757, 3])
ldmk_t.shape :  torch.Size([1757, 3])
number of true landmark correspondences returned from Outlier Rejection :  64  out of  1757
fraction of true landmark correspondences returned from Outlier Rejection :  0.03642572566875356
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1757, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.020 
full-AccS: 0.073 
full-AccR: 2.954 
full-outlier: 74.002 
vis-epe: 11.308 
vis-AccS: 0.114 
vis-AccR: 2.493 
vis-outlier: 79.539 
occ-epe: 7.716 
occ-AccS: 0.000 
occ-AccR: 3.777 
occ-outlier: 64.103 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.055798714821219404
Strict IR :  0.0012701100762066045
Relaxed IR :  0.09970364098221846
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3445, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3445])
ti.shape :  torch.Size([3445])
s_pos.shape :  torch.Size([3445, 3])
t_pos.shape :  torch.Size([3445, 3])
ind.shape :  torch.Size([3445, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3445])
ti.shape :  torch.Size([3445])
s_pos.shape :  torch.Size([3445, 3])
t_pos.shape :  torch.Size([3445, 3])
number of true landmarks correspondences returned from Lepard :  76  out of  3445
fraction of true landmark correspondences returned from Lepard :  0.022060957910014514
vec6d.shape :  torch.Size([2789, 6])
ldmk_s.shape :  torch.Size([2789, 3])
ldmk_t.shape :  torch.Size([2789, 3])
number of true landmark correspondences returned from Outlier Rejection :  65  out of  2789
fraction of true landmark correspondences returned from Outlier Rejection :  0.023305844388669773
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2789, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.737 
full-AccS: 0.175 
full-AccR: 3.560 
full-outlier: 92.212 
vis-epe: 12.277 
vis-AccS: 0.239 
vis-AccR: 2.788 
vis-outlier: 94.901 
occ-epe: 6.475 
occ-AccS: 0.000 
occ-AccR: 5.695 
occ-outlier: 84.771 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05512229491321642
Strict IR :  0.0104052573932092
Relaxed IR :  0.16900328587075575
model 042
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([57, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([57])
ti.shape :  torch.Size([57])
s_pos.shape :  torch.Size([57, 3])
t_pos.shape :  torch.Size([57, 3])
ind.shape :  torch.Size([57, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([57])
ti.shape :  torch.Size([57])
s_pos.shape :  torch.Size([57, 3])
t_pos.shape :  torch.Size([57, 3])
number of true landmarks correspondences returned from Lepard :  6  out of  57
fraction of true landmark correspondences returned from Lepard :  0.10526315789473684
vec6d.shape :  torch.Size([54, 6])
ldmk_s.shape :  torch.Size([54, 3])
ldmk_t.shape :  torch.Size([54, 3])
number of true landmark correspondences returned from Outlier Rejection :  5  out of  54
fraction of true landmark correspondences returned from Outlier Rejection :  0.09259259259259259
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([54, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.034 
full-AccS: 0.085 
full-AccR: 2.879 
full-outlier: 93.101 
vis-epe: 14.034 
vis-AccS: 0.085 
vis-AccR: 2.879 
vis-outlier: 93.101 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.056608671819337646
Strict IR :  0.017126199441272926
Relaxed IR :  0.1690756710798008
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([8, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([8])
ti.shape :  torch.Size([8])
s_pos.shape :  torch.Size([8, 3])
t_pos.shape :  torch.Size([8, 3])
ind.shape :  torch.Size([8, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([8])
ti.shape :  torch.Size([8])
s_pos.shape :  torch.Size([8, 3])
t_pos.shape :  torch.Size([8, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  8
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([8, 6])
ldmk_s.shape :  torch.Size([8, 3])
ldmk_t.shape :  torch.Size([8, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  8
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([8, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 26.639 
full-AccS: 0.057 
full-AccR: 0.531 
full-outlier: 98.813 
vis-epe: 30.151 
vis-AccS: 0.047 
vis-AccR: 0.498 
vis-outlier: 99.050 
occ-epe: 17.330 
occ-AccS: 0.083 
occ-AccR: 0.619 
occ-outlier: 98.183 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.17887170953309892
Strict IR :  0.0013570055411059596
Relaxed IR :  0.020128915526405066
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([68, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([68])
ti.shape :  torch.Size([68])
s_pos.shape :  torch.Size([68, 3])
t_pos.shape :  torch.Size([68, 3])
ind.shape :  torch.Size([68, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([68])
ti.shape :  torch.Size([68])
s_pos.shape :  torch.Size([68, 3])
t_pos.shape :  torch.Size([68, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  68
fraction of true landmark correspondences returned from Lepard :  0.029411764705882353
vec6d.shape :  torch.Size([61, 6])
ldmk_s.shape :  torch.Size([61, 3])
ldmk_t.shape :  torch.Size([61, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  61
fraction of true landmark correspondences returned from Outlier Rejection :  0.03278688524590164
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([61, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.690 
full-AccS: 0.024 
full-AccR: 2.209 
full-outlier: 83.169 
vis-epe: 12.803 
vis-AccS: 0.038 
vis-AccR: 1.922 
vis-outlier: 85.896 
occ-epe: 9.700 
occ-AccS: 0.000 
occ-AccR: 2.722 
occ-outlier: 78.292 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07056890793919249
Strict IR :  0.0
Relaxed IR :  0.04170194750211685
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  10
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([10, 6])
ldmk_s.shape :  torch.Size([10, 3])
ldmk_t.shape :  torch.Size([10, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  10
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([10, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.214 
full-AccS: 0.000 
full-AccR: 3.384 
full-outlier: 94.042 
vis-epe: 20.976 
vis-AccS: 0.000 
vis-AccR: 0.015 
vis-outlier: 99.284 
occ-epe: 10.568 
occ-AccS: 0.000 
occ-AccR: 12.712 
occ-outlier: 79.530 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14672581075419908
Strict IR :  0.0
Relaxed IR :  0.05629791894852136
model 042
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[123, 130]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([253, 2048])
block_i :  1
x.shape :  torch.Size([253, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 253])
coarse_feats.shape :  torch.Size([1, 528, 253])
coarse_feats.shape :  torch.Size([253, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 123])
tgt_mask.shape :  torch.Size([1, 130])
src_ind_coarse_split.shape :  torch.Size([123])
tgt_ind_coarse_split.shape :  torch.Size([130])
src_ind_coarse.shape :  torch.Size([123])
tgt_ind_coarse.shape :  torch.Size([130])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 114]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([231, 2048])
block_i :  1
x.shape :  torch.Size([231, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 231])
coarse_feats.shape :  torch.Size([1, 528, 231])
coarse_feats.shape :  torch.Size([231, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 114])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([114])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([114])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[124, 112]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([236, 2048])
block_i :  1
x.shape :  torch.Size([236, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 236])
coarse_feats.shape :  torch.Size([1, 528, 236])
coarse_feats.shape :  torch.Size([236, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 124])
tgt_mask.shape :  torch.Size([1, 112])
src_ind_coarse_split.shape :  torch.Size([124])
tgt_ind_coarse_split.shape :  torch.Size([112])
src_ind_coarse.shape :  torch.Size([124])
tgt_ind_coarse.shape :  torch.Size([112])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  1
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([1, 6])
ldmk_s.shape :  torch.Size([1, 3])
ldmk_t.shape :  torch.Size([1, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  1
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.109 
full-AccS: 0.037 
full-AccR: 0.684 
full-outlier: 91.493 
vis-epe: 21.988 
vis-AccS: 0.000 
vis-AccR: 0.362 
vis-outlier: 95.242 
occ-epe: 16.751 
occ-AccS: 0.102 
occ-AccR: 1.259 
occ-outlier: 84.791 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1723430977788773
Strict IR :  0.0012701100762066045
Relaxed IR :  0.03090601185436071
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[117, 115]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([232, 2048])
block_i :  1
x.shape :  torch.Size([232, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 232])
coarse_feats.shape :  torch.Size([1, 528, 232])
coarse_feats.shape :  torch.Size([232, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 117])
tgt_mask.shape :  torch.Size([1, 115])
src_ind_coarse_split.shape :  torch.Size([117])
tgt_ind_coarse_split.shape :  torch.Size([115])
src_ind_coarse.shape :  torch.Size([117])
tgt_ind_coarse.shape :  torch.Size([115])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 085
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0162
vec6d.shape :  torch.Size([3708, 6])
ldmk_s.shape :  torch.Size([3708, 3])
ldmk_t.shape :  torch.Size([3708, 3])
number of true landmark correspondences returned from Outlier Rejection :  66  out of  3708
fraction of true landmark correspondences returned from Outlier Rejection :  0.01779935275080906
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3708, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.733 
full-AccS: 0.045 
full-AccR: 2.094 
full-outlier: 96.702 
vis-epe: 13.733 
vis-AccS: 0.045 
vis-AccR: 2.094 
vis-outlier: 96.702 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03014335108334923
Strict IR :  0.02406417112299465
Relaxed IR :  0.5868983957219251
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([3658, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3658])
ti.shape :  torch.Size([3658])
s_pos.shape :  torch.Size([3658, 3])
t_pos.shape :  torch.Size([3658, 3])
ind.shape :  torch.Size([3658, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3658])
ti.shape :  torch.Size([3658])
s_pos.shape :  torch.Size([3658, 3])
t_pos.shape :  torch.Size([3658, 3])
number of true landmarks correspondences returned from Lepard :  51  out of  3658
fraction of true landmark correspondences returned from Lepard :  0.013942044833242209
vec6d.shape :  torch.Size([3015, 6])
ldmk_s.shape :  torch.Size([3015, 3])
ldmk_t.shape :  torch.Size([3015, 3])
number of true landmark correspondences returned from Outlier Rejection :  42  out of  3015
fraction of true landmark correspondences returned from Outlier Rejection :  0.013930348258706468
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3015, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.603 
full-AccS: 0.000 
full-AccR: 1.404 
full-outlier: 75.649 
vis-epe: 19.670 
vis-AccS: 0.000 
vis-AccR: 0.877 
vis-outlier: 79.439 
occ-epe: 14.205 
occ-AccS: 0.000 
occ-AccR: 1.816 
occ-outlier: 72.687 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14645783802662413
Strict IR :  0.0
Relaxed IR :  0.02308136180034622
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4517, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4517])
ti.shape :  torch.Size([4517])
s_pos.shape :  torch.Size([4517, 3])
t_pos.shape :  torch.Size([4517, 3])
ind.shape :  torch.Size([4517, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4517])
ti.shape :  torch.Size([4517])
s_pos.shape :  torch.Size([4517, 3])
t_pos.shape :  torch.Size([4517, 3])
number of true landmarks correspondences returned from Lepard :  47  out of  4517
fraction of true landmark correspondences returned from Lepard :  0.010405136152313482
vec6d.shape :  torch.Size([2736, 6])
ldmk_s.shape :  torch.Size([2736, 3])
ldmk_t.shape :  torch.Size([2736, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  2736
fraction of true landmark correspondences returned from Outlier Rejection :  0.01206140350877193
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2736, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.971 
full-AccS: 2.228 
full-AccR: 27.005 
full-outlier: 56.774 
vis-epe: 11.628 
vis-AccS: 0.373 
vis-AccR: 5.352 
vis-outlier: 79.278 
occ-epe: 2.267 
occ-AccS: 6.907 
occ-AccR: 81.633 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.022740441867158574
Strict IR :  0.09149484536082474
Relaxed IR :  0.8460051546391752
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4088, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4088])
ti.shape :  torch.Size([4088])
s_pos.shape :  torch.Size([4088, 3])
t_pos.shape :  torch.Size([4088, 3])
ind.shape :  torch.Size([4088, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4088])
ti.shape :  torch.Size([4088])
s_pos.shape :  torch.Size([4088, 3])
t_pos.shape :  torch.Size([4088, 3])
number of true landmarks correspondences returned from Lepard :  51  out of  4088
fraction of true landmark correspondences returned from Lepard :  0.012475538160469667
vec6d.shape :  torch.Size([3161, 6])
ldmk_s.shape :  torch.Size([3161, 3])
ldmk_t.shape :  torch.Size([3161, 3])
number of true landmark correspondences returned from Outlier Rejection :  43  out of  3161
fraction of true landmark correspondences returned from Outlier Rejection :  0.013603290098070231
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3161, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.799 
full-AccS: 0.038 
full-AccR: 1.106 
full-outlier: 98.169 
vis-epe: 23.088 
vis-AccS: 0.000 
vis-AccR: 0.420 
vis-outlier: 99.466 
occ-epe: 14.508 
occ-AccS: 0.076 
occ-AccR: 1.794 
occ-outlier: 96.870 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1424992358000445
Strict IR :  0.0013353681800839375
Relaxed IR :  0.016787485692483783
model 085
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([4348, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4348])
ti.shape :  torch.Size([4348])
s_pos.shape :  torch.Size([4348, 3])
t_pos.shape :  torch.Size([4348, 3])
ind.shape :  torch.Size([4348, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4348])
ti.shape :  torch.Size([4348])
s_pos.shape :  torch.Size([4348, 3])
t_pos.shape :  torch.Size([4348, 3])
number of true landmarks correspondences returned from Lepard :  81  out of  4348
fraction of true landmark correspondences returned from Lepard :  0.018629254829806808
vec6d.shape :  torch.Size([3324, 6])
ldmk_s.shape :  torch.Size([3324, 3])
ldmk_t.shape :  torch.Size([3324, 3])
number of true landmark correspondences returned from Outlier Rejection :  68  out of  3324
fraction of true landmark correspondences returned from Outlier Rejection :  0.02045728038507822
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3324, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.776 
full-AccS: 0.223 
full-AccR: 2.273 
full-outlier: 96.435 
vis-epe: 13.776 
vis-AccS: 0.223 
vis-AccR: 2.273 
vis-outlier: 96.435 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.02560383487641408
Strict IR :  0.05481283422459893
Relaxed IR :  0.7312834224598931
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2603, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2603])
ti.shape :  torch.Size([2603])
s_pos.shape :  torch.Size([2603, 3])
t_pos.shape :  torch.Size([2603, 3])
ind.shape :  torch.Size([2603, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2603])
ti.shape :  torch.Size([2603])
s_pos.shape :  torch.Size([2603, 3])
t_pos.shape :  torch.Size([2603, 3])
number of true landmarks correspondences returned from Lepard :  33  out of  2603
fraction of true landmark correspondences returned from Lepard :  0.012677679600461006
vec6d.shape :  torch.Size([2236, 6])
ldmk_s.shape :  torch.Size([2236, 3])
ldmk_t.shape :  torch.Size([2236, 3])
number of true landmark correspondences returned from Outlier Rejection :  30  out of  2236
fraction of true landmark correspondences returned from Outlier Rejection :  0.013416815742397137
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2236, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.312 
full-AccS: 0.000 
full-AccR: 1.635 
full-outlier: 76.361 
vis-epe: 19.647 
vis-AccS: 0.000 
vis-AccR: 1.140 
vis-outlier: 79.395 
occ-epe: 13.705 
occ-AccS: 0.000 
occ-AccR: 2.022 
occ-outlier: 73.989 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14258226684943184
Strict IR :  0.0
Relaxed IR :  0.020580880938642045
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2898, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2898])
ti.shape :  torch.Size([2898])
s_pos.shape :  torch.Size([2898, 3])
t_pos.shape :  torch.Size([2898, 3])
ind.shape :  torch.Size([2898, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2898])
ti.shape :  torch.Size([2898])
s_pos.shape :  torch.Size([2898, 3])
t_pos.shape :  torch.Size([2898, 3])
number of true landmarks correspondences returned from Lepard :  47  out of  2898
fraction of true landmark correspondences returned from Lepard :  0.01621808143547274
vec6d.shape :  torch.Size([2080, 6])
ldmk_s.shape :  torch.Size([2080, 3])
ldmk_t.shape :  torch.Size([2080, 3])
number of true landmark correspondences returned from Outlier Rejection :  42  out of  2080
fraction of true landmark correspondences returned from Outlier Rejection :  0.020192307692307693
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2080, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.085 
full-AccS: 2.807 
full-AccR: 32.041 
full-outlier: 56.774 
vis-epe: 11.857 
vis-AccS: 0.747 
vis-AccR: 5.103 
vis-outlier: 79.278 
occ-epe: 2.092 
occ-AccS: 8.006 
occ-AccR: 100.000 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.016476105923068644
Strict IR :  0.2699742268041237
Relaxed IR :  0.9555412371134021
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2961, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2961])
ti.shape :  torch.Size([2961])
s_pos.shape :  torch.Size([2961, 3])
t_pos.shape :  torch.Size([2961, 3])
ind.shape :  torch.Size([2961, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2961])
ti.shape :  torch.Size([2961])
s_pos.shape :  torch.Size([2961, 3])
t_pos.shape :  torch.Size([2961, 3])
number of true landmarks correspondences returned from Lepard :  32  out of  2961
fraction of true landmark correspondences returned from Lepard :  0.010807159743329957
vec6d.shape :  torch.Size([2334, 6])
ldmk_s.shape :  torch.Size([2334, 3])
ldmk_t.shape :  torch.Size([2334, 3])
number of true landmark correspondences returned from Outlier Rejection :  24  out of  2334
fraction of true landmark correspondences returned from Outlier Rejection :  0.010282776349614395
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2334, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.913 
full-AccS: 0.382 
full-AccR: 2.862 
full-outlier: 96.509 
vis-epe: 22.984 
vis-AccS: 0.000 
vis-AccR: 0.839 
vis-outlier: 98.818 
occ-epe: 14.840 
occ-AccS: 0.763 
occ-AccR: 4.885 
occ-outlier: 94.198 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14779344758317703
Strict IR :  0.008202975963372758
Relaxed IR :  0.049790156428843955
model 085
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1956, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1956])
ti.shape :  torch.Size([1956])
s_pos.shape :  torch.Size([1956, 3])
t_pos.shape :  torch.Size([1956, 3])
ind.shape :  torch.Size([1956, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1956])
ti.shape :  torch.Size([1956])
s_pos.shape :  torch.Size([1956, 3])
t_pos.shape :  torch.Size([1956, 3])
number of true landmarks correspondences returned from Lepard :  80  out of  1956
fraction of true landmark correspondences returned from Lepard :  0.0408997955010225
vec6d.shape :  torch.Size([1704, 6])
ldmk_s.shape :  torch.Size([1704, 3])
ldmk_t.shape :  torch.Size([1704, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  1704
fraction of true landmark correspondences returned from Outlier Rejection :  0.04460093896713615
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1704, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.802 
full-AccS: 0.267 
full-AccR: 2.763 
full-outlier: 95.588 
vis-epe: 12.802 
vis-AccS: 0.267 
vis-AccR: 2.763 
vis-outlier: 95.588 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.012977927285418585
Strict IR :  0.42780748663101603
Relaxed IR :  1.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1317, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1317])
ti.shape :  torch.Size([1317])
s_pos.shape :  torch.Size([1317, 3])
t_pos.shape :  torch.Size([1317, 3])
ind.shape :  torch.Size([1317, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1317])
ti.shape :  torch.Size([1317])
s_pos.shape :  torch.Size([1317, 3])
t_pos.shape :  torch.Size([1317, 3])
number of true landmarks correspondences returned from Lepard :  11  out of  1317
fraction of true landmark correspondences returned from Lepard :  0.008352315869400152
vec6d.shape :  torch.Size([1160, 6])
ldmk_s.shape :  torch.Size([1160, 3])
ldmk_t.shape :  torch.Size([1160, 3])
number of true landmark correspondences returned from Outlier Rejection :  11  out of  1160
fraction of true landmark correspondences returned from Outlier Rejection :  0.009482758620689655
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1160, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.209 
full-AccS: 0.000 
full-AccR: 2.058 
full-outlier: 76.938 
vis-epe: 19.211 
vis-AccS: 0.000 
vis-AccR: 0.833 
vis-outlier: 79.702 
occ-epe: 13.862 
occ-AccS: 0.000 
occ-AccR: 3.016 
occ-outlier: 74.777 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14227266896274307
Strict IR :  0.00019234468166955183
Relaxed IR :  0.03923831506058857
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1371, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1371])
ti.shape :  torch.Size([1371])
s_pos.shape :  torch.Size([1371, 3])
t_pos.shape :  torch.Size([1371, 3])
ind.shape :  torch.Size([1371, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1371])
ti.shape :  torch.Size([1371])
s_pos.shape :  torch.Size([1371, 3])
t_pos.shape :  torch.Size([1371, 3])
number of true landmarks correspondences returned from Lepard :  44  out of  1371
fraction of true landmark correspondences returned from Lepard :  0.032093362509117436
vec6d.shape :  torch.Size([1189, 6])
ldmk_s.shape :  torch.Size([1189, 3])
ldmk_t.shape :  torch.Size([1189, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  1189
fraction of true landmark correspondences returned from Outlier Rejection :  0.03700588730025231
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1189, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.294 
full-AccS: 2.139 
full-AccR: 22.638 
full-outlier: 56.684 
vis-epe: 11.958 
vis-AccS: 0.622 
vis-AccR: 5.476 
vis-outlier: 79.154 
occ-epe: 2.574 
occ-AccS: 5.965 
occ-AccR: 65.934 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.01867015923280262
Strict IR :  0.20747422680412372
Relaxed IR :  0.916881443298969
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1291, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1291])
ti.shape :  torch.Size([1291])
s_pos.shape :  torch.Size([1291, 3])
t_pos.shape :  torch.Size([1291, 3])
ind.shape :  torch.Size([1291, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1291])
ti.shape :  torch.Size([1291])
s_pos.shape :  torch.Size([1291, 3])
t_pos.shape :  torch.Size([1291, 3])
number of true landmarks correspondences returned from Lepard :  9  out of  1291
fraction of true landmark correspondences returned from Lepard :  0.006971340046475601
vec6d.shape :  torch.Size([1004, 6])
ldmk_s.shape :  torch.Size([1004, 3])
ldmk_t.shape :  torch.Size([1004, 3])
number of true landmark correspondences returned from Outlier Rejection :  9  out of  1004
fraction of true landmark correspondences returned from Outlier Rejection :  0.008964143426294821
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1004, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.304 
full-AccS: 0.019 
full-AccR: 3.014 
full-outlier: 96.356 
vis-epe: 23.698 
vis-AccS: 0.000 
vis-AccR: 0.572 
vis-outlier: 99.047 
occ-epe: 14.907 
occ-AccS: 0.038 
occ-AccR: 5.458 
occ-outlier: 93.664 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15092907432946817
Strict IR :  0.00019076688286913393
Relaxed IR :  0.040824112933994655
model 085
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([65, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([65])
ti.shape :  torch.Size([65])
s_pos.shape :  torch.Size([65, 3])
t_pos.shape :  torch.Size([65, 3])
ind.shape :  torch.Size([65, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([65])
ti.shape :  torch.Size([65])
s_pos.shape :  torch.Size([65, 3])
t_pos.shape :  torch.Size([65, 3])
number of true landmarks correspondences returned from Lepard :  9  out of  65
fraction of true landmark correspondences returned from Lepard :  0.13846153846153847
vec6d.shape :  torch.Size([59, 6])
ldmk_s.shape :  torch.Size([59, 3])
ldmk_t.shape :  torch.Size([59, 3])
number of true landmark correspondences returned from Outlier Rejection :  9  out of  59
fraction of true landmark correspondences returned from Outlier Rejection :  0.15254237288135594
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([59, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.753 
full-AccS: 0.089 
full-AccR: 1.738 
full-outlier: 96.658 
vis-epe: 13.753 
vis-AccS: 0.089 
vis-AccR: 1.738 
vis-outlier: 96.658 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.060554613759810916
Strict IR :  0.029411764705882353
Relaxed IR :  0.20632798573975045
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([46, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([46])
ti.shape :  torch.Size([46])
s_pos.shape :  torch.Size([46, 3])
t_pos.shape :  torch.Size([46, 3])
ind.shape :  torch.Size([46, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([46])
ti.shape :  torch.Size([46])
s_pos.shape :  torch.Size([46, 3])
t_pos.shape :  torch.Size([46, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  46
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([44, 6])
ldmk_s.shape :  torch.Size([44, 3])
ldmk_t.shape :  torch.Size([44, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  44
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([44, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.990 
full-AccS: 0.000 
full-AccR: 1.885 
full-outlier: 75.111 
vis-epe: 19.146 
vis-AccS: 0.000 
vis-AccR: 0.921 
vis-outlier: 78.167 
occ-epe: 13.522 
occ-AccS: 0.000 
occ-AccR: 2.639 
occ-outlier: 72.721 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.14056471622936387
Strict IR :  0.0
Relaxed IR :  0.0315445277938065
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([98, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([98])
ti.shape :  torch.Size([98])
s_pos.shape :  torch.Size([98, 3])
t_pos.shape :  torch.Size([98, 3])
ind.shape :  torch.Size([98, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([98])
ti.shape :  torch.Size([98])
s_pos.shape :  torch.Size([98, 3])
t_pos.shape :  torch.Size([98, 3])
number of true landmarks correspondences returned from Lepard :  13  out of  98
fraction of true landmark correspondences returned from Lepard :  0.1326530612244898
vec6d.shape :  torch.Size([96, 6])
ldmk_s.shape :  torch.Size([96, 3])
ldmk_t.shape :  torch.Size([96, 3])
number of true landmark correspondences returned from Outlier Rejection :  13  out of  96
fraction of true landmark correspondences returned from Outlier Rejection :  0.13541666666666666
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([96, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 9.289 
full-AccS: 0.446 
full-AccR: 13.904 
full-outlier: 55.481 
vis-epe: 11.625 
vis-AccS: 0.622 
vis-AccR: 6.658 
vis-outlier: 77.474 
occ-epe: 3.398 
occ-AccS: 0.000 
occ-AccR: 32.182 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03226090986903282
Strict IR :  0.008376288659793814
Relaxed IR :  0.5541237113402062
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([81, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([81])
ti.shape :  torch.Size([81])
s_pos.shape :  torch.Size([81, 3])
t_pos.shape :  torch.Size([81, 3])
ind.shape :  torch.Size([81, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([81])
ti.shape :  torch.Size([81])
s_pos.shape :  torch.Size([81, 3])
t_pos.shape :  torch.Size([81, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  81
fraction of true landmark correspondences returned from Lepard :  0.024691358024691357
vec6d.shape :  torch.Size([62, 6])
ldmk_s.shape :  torch.Size([62, 3])
ldmk_t.shape :  torch.Size([62, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  62
fraction of true landmark correspondences returned from Outlier Rejection :  0.03225806451612903
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([62, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.503 
full-AccS: 0.000 
full-AccR: 2.709 
full-outlier: 96.814 
vis-epe: 23.743 
vis-AccS: 0.000 
vis-AccR: 0.877 
vis-outlier: 99.047 
occ-epe: 15.261 
occ-AccS: 0.000 
occ-AccR: 4.542 
occ-outlier: 94.580 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.15247457550715737
Strict IR :  0.0
Relaxed IR :  0.04101487981686379
model 085
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[88, 89]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([177, 2048])
block_i :  1
x.shape :  torch.Size([177, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 177])
coarse_feats.shape :  torch.Size([1, 528, 177])
coarse_feats.shape :  torch.Size([177, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 88])
tgt_mask.shape :  torch.Size([1, 89])
src_ind_coarse_split.shape :  torch.Size([88])
tgt_ind_coarse_split.shape :  torch.Size([89])
src_ind_coarse.shape :  torch.Size([88])
tgt_ind_coarse.shape :  torch.Size([89])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[72, 76]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([148, 2048])
block_i :  1
x.shape :  torch.Size([148, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 148])
coarse_feats.shape :  torch.Size([1, 528, 148])
coarse_feats.shape :  torch.Size([148, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 72])
tgt_mask.shape :  torch.Size([1, 76])
src_ind_coarse_split.shape :  torch.Size([72])
tgt_ind_coarse_split.shape :  torch.Size([76])
src_ind_coarse.shape :  torch.Size([72])
tgt_ind_coarse.shape :  torch.Size([76])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[69, 64]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 69])
tgt_mask.shape :  torch.Size([1, 64])
src_ind_coarse_split.shape :  torch.Size([69])
tgt_ind_coarse_split.shape :  torch.Size([64])
src_ind_coarse.shape :  torch.Size([69])
tgt_ind_coarse.shape :  torch.Size([64])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 126
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  102  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0204
vec6d.shape :  torch.Size([3484, 6])
ldmk_s.shape :  torch.Size([3484, 3])
ldmk_t.shape :  torch.Size([3484, 3])
number of true landmark correspondences returned from Outlier Rejection :  102  out of  3484
fraction of true landmark correspondences returned from Outlier Rejection :  0.029276693455797934
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3484, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.110 
full-AccS: 0.084 
full-AccR: 1.022 
full-outlier: 92.217 
vis-epe: 19.110 
vis-AccS: 0.084 
vis-AccR: 1.022 
vis-outlier: 92.217 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.025224729716571918
Strict IR :  0.08118701007838745
Relaxed IR :  0.7288633818589025
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  71  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0142
vec6d.shape :  torch.Size([3431, 6])
ldmk_s.shape :  torch.Size([3431, 3])
ldmk_t.shape :  torch.Size([3431, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  3431
fraction of true landmark correspondences returned from Outlier Rejection :  0.01428155056834742
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3431, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.065 
full-AccS: 0.036 
full-AccR: 1.416 
full-outlier: 91.780 
vis-epe: 17.505 
vis-AccS: 0.064 
vis-AccR: 1.187 
vis-outlier: 97.222 
occ-epe: 7.156 
occ-AccS: 0.000 
occ-AccR: 1.721 
occ-outlier: 84.537 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07614710430477685
Strict IR :  0.0
Relaxed IR :  0.038256658595641646
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  106  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0212
vec6d.shape :  torch.Size([3292, 6])
ldmk_s.shape :  torch.Size([3292, 3])
ldmk_t.shape :  torch.Size([3292, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  3292
fraction of true landmark correspondences returned from Outlier Rejection :  0.023086269744835967
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3292, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.591 
full-AccS: 0.014 
full-AccR: 3.541 
full-outlier: 70.115 
vis-epe: 14.318 
vis-AccS: 0.015 
vis-AccR: 1.838 
vis-outlier: 75.471 
occ-epe: 4.075 
occ-AccS: 0.000 
occ-AccR: 25.838 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.048126421499347614
Strict IR :  0.0
Relaxed IR :  0.09545302574389836
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  80  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.016
vec6d.shape :  torch.Size([3628, 6])
ldmk_s.shape :  torch.Size([3628, 3])
ldmk_t.shape :  torch.Size([3628, 3])
number of true landmark correspondences returned from Outlier Rejection :  74  out of  3628
fraction of true landmark correspondences returned from Outlier Rejection :  0.020396912899669238
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3628, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.207 
full-AccS: 0.180 
full-AccR: 21.778 
full-outlier: 60.601 
vis-epe: 12.331 
vis-AccS: 0.331 
vis-AccR: 4.123 
vis-outlier: 94.819 
occ-epe: 3.299 
occ-AccS: 0.000 
occ-AccR: 42.786 
occ-outlier: 19.885 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03724452116196112
Strict IR :  0.0
Relaxed IR :  0.404168663152851
model 126
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  102  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0204
vec6d.shape :  torch.Size([3484, 6])
ldmk_s.shape :  torch.Size([3484, 3])
ldmk_t.shape :  torch.Size([3484, 3])
number of true landmark correspondences returned from Outlier Rejection :  102  out of  3484
fraction of true landmark correspondences returned from Outlier Rejection :  0.029276693455797934
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3484, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.110 
full-AccS: 0.084 
full-AccR: 1.022 
full-outlier: 92.217 
vis-epe: 19.110 
vis-AccS: 0.084 
vis-AccR: 1.022 
vis-outlier: 92.217 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.025224729716571918
Strict IR :  0.08118701007838745
Relaxed IR :  0.7288633818589025
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  71  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0142
vec6d.shape :  torch.Size([3431, 6])
ldmk_s.shape :  torch.Size([3431, 3])
ldmk_t.shape :  torch.Size([3431, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  3431
fraction of true landmark correspondences returned from Outlier Rejection :  0.01428155056834742
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3431, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.065 
full-AccS: 0.036 
full-AccR: 1.416 
full-outlier: 91.780 
vis-epe: 17.505 
vis-AccS: 0.064 
vis-AccR: 1.187 
vis-outlier: 97.222 
occ-epe: 7.156 
occ-AccS: 0.000 
occ-AccR: 1.721 
occ-outlier: 84.537 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07614710430477685
Strict IR :  0.0
Relaxed IR :  0.038256658595641646
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  106  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.0212
vec6d.shape :  torch.Size([3292, 6])
ldmk_s.shape :  torch.Size([3292, 3])
ldmk_t.shape :  torch.Size([3292, 3])
number of true landmark correspondences returned from Outlier Rejection :  76  out of  3292
fraction of true landmark correspondences returned from Outlier Rejection :  0.023086269744835967
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3292, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.591 
full-AccS: 0.014 
full-AccR: 3.541 
full-outlier: 70.115 
vis-epe: 14.318 
vis-AccS: 0.015 
vis-AccR: 1.838 
vis-outlier: 75.471 
occ-epe: 4.075 
occ-AccS: 0.000 
occ-AccR: 25.838 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.048126421499347614
Strict IR :  0.0
Relaxed IR :  0.09545302574389836
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
ind.shape :  torch.Size([5000, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([5000])
ti.shape :  torch.Size([5000])
s_pos.shape :  torch.Size([5000, 3])
t_pos.shape :  torch.Size([5000, 3])
number of true landmarks correspondences returned from Lepard :  80  out of  5000
fraction of true landmark correspondences returned from Lepard :  0.016
vec6d.shape :  torch.Size([3628, 6])
ldmk_s.shape :  torch.Size([3628, 3])
ldmk_t.shape :  torch.Size([3628, 3])
number of true landmark correspondences returned from Outlier Rejection :  74  out of  3628
fraction of true landmark correspondences returned from Outlier Rejection :  0.020396912899669238
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3628, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.207 
full-AccS: 0.180 
full-AccR: 21.778 
full-outlier: 60.601 
vis-epe: 12.331 
vis-AccS: 0.331 
vis-AccR: 4.123 
vis-outlier: 94.819 
occ-epe: 3.299 
occ-AccS: 0.000 
occ-AccR: 42.786 
occ-outlier: 19.885 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03724452116196112
Strict IR :  0.0
Relaxed IR :  0.404168663152851
model 126
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3599, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3599])
ti.shape :  torch.Size([3599])
s_pos.shape :  torch.Size([3599, 3])
t_pos.shape :  torch.Size([3599, 3])
ind.shape :  torch.Size([3599, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3599])
ti.shape :  torch.Size([3599])
s_pos.shape :  torch.Size([3599, 3])
t_pos.shape :  torch.Size([3599, 3])
number of true landmarks correspondences returned from Lepard :  91  out of  3599
fraction of true landmark correspondences returned from Lepard :  0.025284801333703807
vec6d.shape :  torch.Size([2637, 6])
ldmk_s.shape :  torch.Size([2637, 3])
ldmk_t.shape :  torch.Size([2637, 3])
number of true landmark correspondences returned from Outlier Rejection :  91  out of  2637
fraction of true landmark correspondences returned from Outlier Rejection :  0.03450891164201744
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2637, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 19.117 
full-AccS: 0.056 
full-AccR: 0.994 
full-outlier: 92.343 
vis-epe: 19.117 
vis-AccS: 0.056 
vis-AccR: 0.994 
vis-outlier: 92.343 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.025415349579614974
Strict IR :  0.09840425531914894
Relaxed IR :  0.7103863381858903
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3399, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3399])
ti.shape :  torch.Size([3399])
s_pos.shape :  torch.Size([3399, 3])
t_pos.shape :  torch.Size([3399, 3])
ind.shape :  torch.Size([3399, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3399])
ti.shape :  torch.Size([3399])
s_pos.shape :  torch.Size([3399, 3])
t_pos.shape :  torch.Size([3399, 3])
number of true landmarks correspondences returned from Lepard :  64  out of  3399
fraction of true landmark correspondences returned from Lepard :  0.01882906737275669
vec6d.shape :  torch.Size([2353, 6])
ldmk_s.shape :  torch.Size([2353, 3])
ldmk_t.shape :  torch.Size([2353, 3])
number of true landmark correspondences returned from Outlier Rejection :  41  out of  2353
fraction of true landmark correspondences returned from Outlier Rejection :  0.017424564385890354
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2353, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.471 
full-AccS: 0.000 
full-AccR: 1.755 
full-outlier: 86.538 
vis-epe: 16.938 
vis-AccS: 0.000 
vis-AccR: 1.060 
vis-outlier: 97.307 
occ-epe: 6.527 
occ-AccS: 0.000 
occ-AccR: 2.681 
occ-outlier: 72.207 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06956163169811144
Strict IR :  0.0
Relaxed IR :  0.04951573849878935
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([4302, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4302])
ti.shape :  torch.Size([4302])
s_pos.shape :  torch.Size([4302, 3])
t_pos.shape :  torch.Size([4302, 3])
ind.shape :  torch.Size([4302, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4302])
ti.shape :  torch.Size([4302])
s_pos.shape :  torch.Size([4302, 3])
t_pos.shape :  torch.Size([4302, 3])
number of true landmarks correspondences returned from Lepard :  101  out of  4302
fraction of true landmark correspondences returned from Lepard :  0.023477452347745235
vec6d.shape :  torch.Size([2842, 6])
ldmk_s.shape :  torch.Size([2842, 3])
ldmk_t.shape :  torch.Size([2842, 3])
number of true landmark correspondences returned from Outlier Rejection :  72  out of  2842
fraction of true landmark correspondences returned from Outlier Rejection :  0.025334271639690358
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2842, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.545 
full-AccS: 0.000 
full-AccR: 3.611 
full-outlier: 70.031 
vis-epe: 14.240 
vis-AccS: 0.000 
vis-AccR: 2.079 
vis-outlier: 75.380 
occ-epe: 4.443 
occ-AccS: 0.000 
occ-AccR: 23.669 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.05040755132360225
Strict IR :  0.0
Relaxed IR :  0.1099966566365764
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([3614, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3614])
ti.shape :  torch.Size([3614])
s_pos.shape :  torch.Size([3614, 3])
t_pos.shape :  torch.Size([3614, 3])
ind.shape :  torch.Size([3614, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3614])
ti.shape :  torch.Size([3614])
s_pos.shape :  torch.Size([3614, 3])
t_pos.shape :  torch.Size([3614, 3])
number of true landmarks correspondences returned from Lepard :  70  out of  3614
fraction of true landmark correspondences returned from Lepard :  0.01936912008854455
vec6d.shape :  torch.Size([2759, 6])
ldmk_s.shape :  torch.Size([2759, 3])
ldmk_t.shape :  torch.Size([2759, 3])
number of true landmark correspondences returned from Outlier Rejection :  67  out of  2759
fraction of true landmark correspondences returned from Outlier Rejection :  0.024284160927872417
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2759, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.419 
full-AccS: 0.024 
full-AccR: 15.908 
full-outlier: 72.832 
vis-epe: 12.006 
vis-AccS: 0.044 
vis-AccR: 3.924 
vis-outlier: 94.951 
occ-epe: 4.151 
occ-AccS: 0.000 
occ-AccR: 30.168 
occ-outlier: 46.511 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.04697294626258243
Strict IR :  0.0
Relaxed IR :  0.3043842836607571
model 126
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([33, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([33])
ti.shape :  torch.Size([33])
s_pos.shape :  torch.Size([33, 3])
t_pos.shape :  torch.Size([33, 3])
ind.shape :  torch.Size([33, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([33])
ti.shape :  torch.Size([33])
s_pos.shape :  torch.Size([33, 3])
t_pos.shape :  torch.Size([33, 3])
number of true landmarks correspondences returned from Lepard :  3  out of  33
fraction of true landmark correspondences returned from Lepard :  0.09090909090909091
vec6d.shape :  torch.Size([27, 6])
ldmk_s.shape :  torch.Size([27, 3])
ldmk_t.shape :  torch.Size([27, 3])
number of true landmark correspondences returned from Outlier Rejection :  3  out of  27
fraction of true landmark correspondences returned from Outlier Rejection :  0.1111111111111111
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([27, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 34.442 
full-AccS: 0.014 
full-AccR: 0.322 
full-outlier: 98.390 
vis-epe: 34.442 
vis-AccS: 0.014 
vis-AccR: 0.322 
vis-outlier: 98.390 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.19908405804619353
Strict IR :  0.0012597984322508398
Relaxed IR :  0.011058230683090706
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
ind.shape :  torch.Size([10, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([10])
ti.shape :  torch.Size([10])
s_pos.shape :  torch.Size([10, 3])
t_pos.shape :  torch.Size([10, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  10
fraction of true landmark correspondences returned from Lepard :  0.1
vec6d.shape :  torch.Size([9, 6])
ldmk_s.shape :  torch.Size([9, 3])
ldmk_t.shape :  torch.Size([9, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  9
fraction of true landmark correspondences returned from Outlier Rejection :  0.1111111111111111
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([9, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 20.267 
full-AccS: 0.012 
full-AccR: 0.327 
full-outlier: 98.959 
vis-epe: 25.462 
vis-AccS: 0.021 
vis-AccR: 0.466 
vis-outlier: 99.067 
occ-epe: 13.354 
occ-AccS: 0.000 
occ-AccR: 0.141 
occ-outlier: 98.815 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13930513082653384
Strict IR :  0.00048426150121065375
Relaxed IR :  0.005569007263922518
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
ind.shape :  torch.Size([1, 3])
bi :  tensor([0], device='cuda:0')
si.shape :  torch.Size([1])
ti.shape :  torch.Size([1])
s_pos.shape :  torch.Size([1, 3])
t_pos.shape :  torch.Size([1, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  1
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([1, 6])
ldmk_s.shape :  torch.Size([1, 3])
ldmk_t.shape :  torch.Size([1, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  1
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 32.333 
full-AccS: 0.154 
full-AccR: 1.904 
full-outlier: 88.004 
vis-epe: 34.024 
vis-AccS: 0.105 
vis-AccR: 1.431 
vis-outlier: 91.156 
occ-epe: 10.196 
occ-AccS: 0.789 
occ-AccR: 8.087 
occ-outlier: 46.746 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.3106046658999122
Strict IR :  0.00033433634236041456
Relaxed IR :  0.013206285523236376
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([20, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([20])
ti.shape :  torch.Size([20])
s_pos.shape :  torch.Size([20, 3])
t_pos.shape :  torch.Size([20, 3])
ind.shape :  torch.Size([20, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([20])
ti.shape :  torch.Size([20])
s_pos.shape :  torch.Size([20, 3])
t_pos.shape :  torch.Size([20, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  20
fraction of true landmark correspondences returned from Lepard :  0.1
vec6d.shape :  torch.Size([16, 6])
ldmk_s.shape :  torch.Size([16, 3])
ldmk_t.shape :  torch.Size([16, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  16
fraction of true landmark correspondences returned from Outlier Rejection :  0.0625
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([16, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.745 
full-AccS: 0.000 
full-AccR: 2.204 
full-outlier: 94.609 
vis-epe: 15.474 
vis-AccS: 0.000 
vis-AccR: 1.257 
vis-outlier: 96.958 
occ-epe: 9.498 
occ-AccS: 0.000 
occ-AccR: 3.332 
occ-outlier: 91.815 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1061392430317086
Strict IR :  0.0
Relaxed IR :  0.03569717297556301
model 126
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[142, 137]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([279, 2048])
block_i :  1
x.shape :  torch.Size([279, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 279])
coarse_feats.shape :  torch.Size([1, 528, 279])
coarse_feats.shape :  torch.Size([279, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 142])
tgt_mask.shape :  torch.Size([1, 137])
src_ind_coarse_split.shape :  torch.Size([142])
tgt_ind_coarse_split.shape :  torch.Size([137])
src_ind_coarse.shape :  torch.Size([142])
tgt_ind_coarse.shape :  torch.Size([137])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[128, 132]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([260, 2048])
block_i :  1
x.shape :  torch.Size([260, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 260])
coarse_feats.shape :  torch.Size([1, 528, 260])
coarse_feats.shape :  torch.Size([260, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 128])
tgt_mask.shape :  torch.Size([1, 132])
src_ind_coarse_split.shape :  torch.Size([128])
tgt_ind_coarse_split.shape :  torch.Size([132])
src_ind_coarse.shape :  torch.Size([128])
tgt_ind_coarse.shape :  torch.Size([132])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[139, 135]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([274, 2048])
block_i :  1
x.shape :  torch.Size([274, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 274])
coarse_feats.shape :  torch.Size([1, 528, 274])
coarse_feats.shape :  torch.Size([274, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 139])
tgt_mask.shape :  torch.Size([1, 135])
src_ind_coarse_split.shape :  torch.Size([139])
tgt_ind_coarse_split.shape :  torch.Size([135])
src_ind_coarse.shape :  torch.Size([139])
tgt_ind_coarse.shape :  torch.Size([135])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[129, 129]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([258, 2048])
block_i :  1
x.shape :  torch.Size([258, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 258])
coarse_feats.shape :  torch.Size([1, 528, 258])
coarse_feats.shape :  torch.Size([258, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 129])
tgt_mask.shape :  torch.Size([1, 129])
src_ind_coarse_split.shape :  torch.Size([129])
tgt_ind_coarse_split.shape :  torch.Size([129])
src_ind_coarse.shape :  torch.Size([129])
tgt_ind_coarse.shape :  torch.Size([129])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
model 167
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2493, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2493])
ti.shape :  torch.Size([2493])
s_pos.shape :  torch.Size([2493, 3])
t_pos.shape :  torch.Size([2493, 3])
ind.shape :  torch.Size([2493, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2493])
ti.shape :  torch.Size([2493])
s_pos.shape :  torch.Size([2493, 3])
t_pos.shape :  torch.Size([2493, 3])
number of true landmarks correspondences returned from Lepard :  56  out of  2493
fraction of true landmark correspondences returned from Lepard :  0.022462896109105495
vec6d.shape :  torch.Size([1973, 6])
ldmk_s.shape :  torch.Size([1973, 3])
ldmk_t.shape :  torch.Size([1973, 3])
number of true landmark correspondences returned from Outlier Rejection :  50  out of  1973
fraction of true landmark correspondences returned from Outlier Rejection :  0.025342118601115054
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1973, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.579 
full-AccS: 0.778 
full-AccR: 9.029 
full-outlier: 9.153 
vis-epe: 6.579 
vis-AccS: 0.778 
vis-AccR: 9.029 
vis-outlier: 9.153 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019184076107664746
Strict IR :  0.10927770859277709
Relaxed IR :  0.9561021170610212
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2662, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2662])
ti.shape :  torch.Size([2662])
s_pos.shape :  torch.Size([2662, 3])
t_pos.shape :  torch.Size([2662, 3])
ind.shape :  torch.Size([2662, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2662])
ti.shape :  torch.Size([2662])
s_pos.shape :  torch.Size([2662, 3])
t_pos.shape :  torch.Size([2662, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  2662
fraction of true landmark correspondences returned from Lepard :  0.021412471825694966
vec6d.shape :  torch.Size([1900, 6])
ldmk_s.shape :  torch.Size([1900, 3])
ldmk_t.shape :  torch.Size([1900, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  1900
fraction of true landmark correspondences returned from Outlier Rejection :  0.024736842105263158
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1900, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.812 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 100.000 
vis-epe: 15.166 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 9.749 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08984818779511372
Strict IR :  0.0010206685378923194
Relaxed IR :  0.0367440673641235
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2664, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2664])
ti.shape :  torch.Size([2664])
s_pos.shape :  torch.Size([2664, 3])
t_pos.shape :  torch.Size([2664, 3])
ind.shape :  torch.Size([2664, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2664])
ti.shape :  torch.Size([2664])
s_pos.shape :  torch.Size([2664, 3])
t_pos.shape :  torch.Size([2664, 3])
number of true landmarks correspondences returned from Lepard :  59  out of  2664
fraction of true landmark correspondences returned from Lepard :  0.022147147147147148
vec6d.shape :  torch.Size([2286, 6])
ldmk_s.shape :  torch.Size([2286, 3])
ldmk_t.shape :  torch.Size([2286, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  2286
fraction of true landmark correspondences returned from Outlier Rejection :  0.021434820647419073
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2286, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.362 
full-AccS: 0.000 
full-AccR: 0.125 
full-outlier: 72.727 
vis-epe: 16.400 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 80.915 
occ-epe: 8.346 
occ-AccS: 0.000 
occ-AccR: 0.966 
occ-outlier: 17.391 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08208709348337878
Strict IR :  0.0
Relaxed IR :  0.022786701531565184
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2540, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2540])
ti.shape :  torch.Size([2540])
s_pos.shape :  torch.Size([2540, 3])
t_pos.shape :  torch.Size([2540, 3])
ind.shape :  torch.Size([2540, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2540])
ti.shape :  torch.Size([2540])
s_pos.shape :  torch.Size([2540, 3])
t_pos.shape :  torch.Size([2540, 3])
number of true landmarks correspondences returned from Lepard :  43  out of  2540
fraction of true landmark correspondences returned from Lepard :  0.016929133858267716
vec6d.shape :  torch.Size([2167, 6])
ldmk_s.shape :  torch.Size([2167, 3])
ldmk_t.shape :  torch.Size([2167, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  2167
fraction of true landmark correspondences returned from Outlier Rejection :  0.015228426395939087
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2167, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.567 
full-AccS: 0.000 
full-AccR: 1.072 
full-outlier: 96.045 
vis-epe: 17.137 
vis-AccS: 0.000 
vis-AccR: 0.737 
vis-outlier: 96.216 
occ-epe: 11.791 
occ-AccS: 0.000 
occ-AccR: 1.433 
occ-outlier: 95.860 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11123819526215764
Strict IR :  0.0
Relaxed IR :  0.031640724674661905
model 167
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1796, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1796])
ti.shape :  torch.Size([1796])
s_pos.shape :  torch.Size([1796, 3])
t_pos.shape :  torch.Size([1796, 3])
ind.shape :  torch.Size([1796, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1796])
ti.shape :  torch.Size([1796])
s_pos.shape :  torch.Size([1796, 3])
t_pos.shape :  torch.Size([1796, 3])
number of true landmarks correspondences returned from Lepard :  56  out of  1796
fraction of true landmark correspondences returned from Lepard :  0.031180400890868598
vec6d.shape :  torch.Size([1458, 6])
ldmk_s.shape :  torch.Size([1458, 3])
ldmk_t.shape :  torch.Size([1458, 3])
number of true landmark correspondences returned from Outlier Rejection :  53  out of  1458
fraction of true landmark correspondences returned from Outlier Rejection :  0.03635116598079561
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1458, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.085 
full-AccS: 0.467 
full-AccR: 7.472 
full-outlier: 15.785 
vis-epe: 7.085 
vis-AccS: 0.467 
vis-AccR: 7.472 
vis-outlier: 15.785 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.0194594345253335
Strict IR :  0.17216687422166874
Relaxed IR :  0.9427148194271482
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1990, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1990])
ti.shape :  torch.Size([1990])
s_pos.shape :  torch.Size([1990, 3])
t_pos.shape :  torch.Size([1990, 3])
ind.shape :  torch.Size([1990, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1990])
ti.shape :  torch.Size([1990])
s_pos.shape :  torch.Size([1990, 3])
t_pos.shape :  torch.Size([1990, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  1990
fraction of true landmark correspondences returned from Lepard :  0.02864321608040201
vec6d.shape :  torch.Size([1474, 6])
ldmk_s.shape :  torch.Size([1474, 3])
ldmk_t.shape :  torch.Size([1474, 3])
number of true landmark correspondences returned from Outlier Rejection :  54  out of  1474
fraction of true landmark correspondences returned from Outlier Rejection :  0.036635006784260515
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1474, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 12.998 
full-AccS: 0.000 
full-AccR: 0.561 
full-outlier: 99.872 
vis-epe: 14.975 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 10.424 
occ-AccS: 0.000 
occ-AccR: 1.292 
occ-outlier: 99.706 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09367912699776249
Strict IR :  0.0053585098239346774
Relaxed IR :  0.05256442970145445
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1910, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1910])
ti.shape :  torch.Size([1910])
s_pos.shape :  torch.Size([1910, 3])
t_pos.shape :  torch.Size([1910, 3])
ind.shape :  torch.Size([1910, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1910])
ti.shape :  torch.Size([1910])
s_pos.shape :  torch.Size([1910, 3])
t_pos.shape :  torch.Size([1910, 3])
number of true landmarks correspondences returned from Lepard :  58  out of  1910
fraction of true landmark correspondences returned from Lepard :  0.030366492146596858
vec6d.shape :  torch.Size([1679, 6])
ldmk_s.shape :  torch.Size([1679, 3])
ldmk_t.shape :  torch.Size([1679, 3])
number of true landmark correspondences returned from Outlier Rejection :  49  out of  1679
fraction of true landmark correspondences returned from Outlier Rejection :  0.029184038117927337
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1679, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.606 
full-AccS: 0.000 
full-AccR: 0.405 
full-outlier: 77.055 
vis-epe: 16.625 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 84.882 
occ-epe: 8.715 
occ-AccS: 0.000 
occ-AccR: 3.140 
occ-outlier: 24.155 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.08192204704380748
Strict IR :  0.00037355248412401944
Relaxed IR :  0.040343668285394096
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1950, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1950])
ti.shape :  torch.Size([1950])
s_pos.shape :  torch.Size([1950, 3])
t_pos.shape :  torch.Size([1950, 3])
ind.shape :  torch.Size([1950, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1950])
ti.shape :  torch.Size([1950])
s_pos.shape :  torch.Size([1950, 3])
t_pos.shape :  torch.Size([1950, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  1950
fraction of true landmark correspondences returned from Lepard :  0.021025641025641025
vec6d.shape :  torch.Size([1643, 6])
ldmk_s.shape :  torch.Size([1643, 3])
ldmk_t.shape :  torch.Size([1643, 3])
number of true landmark correspondences returned from Outlier Rejection :  36  out of  1643
fraction of true landmark correspondences returned from Outlier Rejection :  0.021911138161898967
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1643, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.635 
full-AccS: 0.000 
full-AccR: 1.021 
full-outlier: 96.249 
vis-epe: 17.058 
vis-AccS: 0.000 
vis-AccR: 0.835 
vis-outlier: 96.364 
occ-epe: 12.017 
occ-AccS: 0.000 
occ-AccR: 1.221 
occ-outlier: 96.125 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11267430084816754
Strict IR :  0.0
Relaxed IR :  0.026537381985200306
model 167
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1006, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1006])
ti.shape :  torch.Size([1006])
s_pos.shape :  torch.Size([1006, 3])
t_pos.shape :  torch.Size([1006, 3])
ind.shape :  torch.Size([1006, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1006])
ti.shape :  torch.Size([1006])
s_pos.shape :  torch.Size([1006, 3])
t_pos.shape :  torch.Size([1006, 3])
number of true landmarks correspondences returned from Lepard :  56  out of  1006
fraction of true landmark correspondences returned from Lepard :  0.055666003976143144
vec6d.shape :  torch.Size([827, 6])
ldmk_s.shape :  torch.Size([827, 3])
ldmk_t.shape :  torch.Size([827, 3])
number of true landmark correspondences returned from Outlier Rejection :  54  out of  827
fraction of true landmark correspondences returned from Outlier Rejection :  0.06529625151148731
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([827, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 6.460 
full-AccS: 0.934 
full-AccR: 10.679 
full-outlier: 7.814 
vis-epe: 6.460 
vis-AccS: 0.934 
vis-AccR: 10.679 
vis-outlier: 7.814 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.01506113149862303
Strict IR :  0.07316313823163138
Relaxed IR :  1.0
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1015, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1015])
ti.shape :  torch.Size([1015])
s_pos.shape :  torch.Size([1015, 3])
t_pos.shape :  torch.Size([1015, 3])
ind.shape :  torch.Size([1015, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1015])
ti.shape :  torch.Size([1015])
s_pos.shape :  torch.Size([1015, 3])
t_pos.shape :  torch.Size([1015, 3])
number of true landmarks correspondences returned from Lepard :  25  out of  1015
fraction of true landmark correspondences returned from Lepard :  0.024630541871921183
vec6d.shape :  torch.Size([776, 6])
ldmk_s.shape :  torch.Size([776, 3])
ldmk_t.shape :  torch.Size([776, 3])
number of true landmark correspondences returned from Outlier Rejection :  24  out of  776
fraction of true landmark correspondences returned from Outlier Rejection :  0.030927835051546393
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([776, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.176 
full-AccS: 0.000 
full-AccR: 0.051 
full-outlier: 99.949 
vis-epe: 15.308 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 100.000 
occ-epe: 10.401 
occ-AccS: 0.000 
occ-AccR: 0.117 
occ-outlier: 99.883 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09319740145042642
Strict IR :  0.0061240112273539165
Relaxed IR :  0.04746108701199286
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1139, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1139])
ti.shape :  torch.Size([1139])
s_pos.shape :  torch.Size([1139, 3])
t_pos.shape :  torch.Size([1139, 3])
ind.shape :  torch.Size([1139, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1139])
ti.shape :  torch.Size([1139])
s_pos.shape :  torch.Size([1139, 3])
t_pos.shape :  torch.Size([1139, 3])
number of true landmarks correspondences returned from Lepard :  55  out of  1139
fraction of true landmark correspondences returned from Lepard :  0.048287971905179985
vec6d.shape :  torch.Size([1020, 6])
ldmk_s.shape :  torch.Size([1020, 3])
ldmk_t.shape :  torch.Size([1020, 3])
number of true landmark correspondences returned from Outlier Rejection :  47  out of  1020
fraction of true landmark correspondences returned from Outlier Rejection :  0.04607843137254902
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1020, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.816 
full-AccS: 0.841 
full-AccR: 15.847 
full-outlier: 40.037 
vis-epe: 12.130 
vis-AccS: 0.179 
vis-AccR: 3.395 
vis-outlier: 45.961 
occ-epe: 1.937 
occ-AccS: 5.314 
occ-AccR: 100.000 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.018679721253994978
Strict IR :  0.1385879716100112
Relaxed IR :  0.9936496077698916
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([911, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([911])
ti.shape :  torch.Size([911])
s_pos.shape :  torch.Size([911, 3])
t_pos.shape :  torch.Size([911, 3])
ind.shape :  torch.Size([911, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       device='cuda:0')
si.shape :  torch.Size([911])
ti.shape :  torch.Size([911])
s_pos.shape :  torch.Size([911, 3])
t_pos.shape :  torch.Size([911, 3])
number of true landmarks correspondences returned from Lepard :  25  out of  911
fraction of true landmark correspondences returned from Lepard :  0.027442371020856202
vec6d.shape :  torch.Size([775, 6])
ldmk_s.shape :  torch.Size([775, 3])
ldmk_t.shape :  torch.Size([775, 3])
number of true landmark correspondences returned from Outlier Rejection :  22  out of  775
fraction of true landmark correspondences returned from Outlier Rejection :  0.02838709677419355
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([775, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.572 
full-AccS: 0.000 
full-AccR: 2.092 
full-outlier: 93.213 
vis-epe: 16.432 
vis-AccS: 0.000 
vis-AccR: 1.818 
vis-outlier: 94.545 
occ-epe: 10.482 
occ-AccS: 0.000 
occ-AccR: 2.389 
occ-outlier: 91.773 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10208676389807883
Strict IR :  0.0
Relaxed IR :  0.05843327379433529
model 167
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([121, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0], device='cuda:0')
si.shape :  torch.Size([121])
ti.shape :  torch.Size([121])
s_pos.shape :  torch.Size([121, 3])
t_pos.shape :  torch.Size([121, 3])
ind.shape :  torch.Size([121, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0], device='cuda:0')
si.shape :  torch.Size([121])
ti.shape :  torch.Size([121])
s_pos.shape :  torch.Size([121, 3])
t_pos.shape :  torch.Size([121, 3])
number of true landmarks correspondences returned from Lepard :  21  out of  121
fraction of true landmark correspondences returned from Lepard :  0.17355371900826447
vec6d.shape :  torch.Size([116, 6])
ldmk_s.shape :  torch.Size([116, 3])
ldmk_t.shape :  torch.Size([116, 3])
number of true landmark correspondences returned from Outlier Rejection :  20  out of  116
fraction of true landmark correspondences returned from Outlier Rejection :  0.1724137931034483
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([116, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 5.606 
full-AccS: 1.214 
full-AccR: 13.574 
full-outlier: 4.545 
vis-epe: 5.606 
vis-AccS: 1.214 
vis-AccR: 13.574 
vis-outlier: 4.545 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03217218516810018
Strict IR :  0.0547945205479452
Relaxed IR :  0.538293897882939
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([65, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([65])
ti.shape :  torch.Size([65])
s_pos.shape :  torch.Size([65, 3])
t_pos.shape :  torch.Size([65, 3])
ind.shape :  torch.Size([65, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([65])
ti.shape :  torch.Size([65])
s_pos.shape :  torch.Size([65, 3])
t_pos.shape :  torch.Size([65, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  65
fraction of true landmark correspondences returned from Lepard :  0.03076923076923077
vec6d.shape :  torch.Size([63, 6])
ldmk_s.shape :  torch.Size([63, 3])
ldmk_t.shape :  torch.Size([63, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  63
fraction of true landmark correspondences returned from Outlier Rejection :  0.031746031746031744
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([63, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.555 
full-AccS: 0.000 
full-AccR: 0.077 
full-outlier: 99.923 
vis-epe: 16.298 
vis-AccS: 0.000 
vis-AccR: 0.135 
vis-outlier: 99.865 
occ-epe: 9.986 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 100.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09245168370190719
Strict IR :  0.0051033426894615975
Relaxed IR :  0.04286807859147742
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([66, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([66])
ti.shape :  torch.Size([66])
s_pos.shape :  torch.Size([66, 3])
t_pos.shape :  torch.Size([66, 3])
ind.shape :  torch.Size([66, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([66])
ti.shape :  torch.Size([66])
s_pos.shape :  torch.Size([66, 3])
t_pos.shape :  torch.Size([66, 3])
number of true landmarks correspondences returned from Lepard :  4  out of  66
fraction of true landmark correspondences returned from Lepard :  0.06060606060606061
vec6d.shape :  torch.Size([63, 6])
ldmk_s.shape :  torch.Size([63, 3])
ldmk_t.shape :  torch.Size([63, 3])
number of true landmark correspondences returned from Outlier Rejection :  4  out of  63
fraction of true landmark correspondences returned from Outlier Rejection :  0.06349206349206349
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([63, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.521 
full-AccS: 0.685 
full-AccR: 7.939 
full-outlier: 42.621 
vis-epe: 12.765 
vis-AccS: 0.107 
vis-AccR: 2.001 
vis-outlier: 48.928 
occ-epe: 3.115 
occ-AccS: 4.589 
occ-AccR: 48.068 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.03629363890088552
Strict IR :  0.010459469555472544
Relaxed IR :  0.3571161748225626
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([80, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([80])
ti.shape :  torch.Size([80])
s_pos.shape :  torch.Size([80, 3])
t_pos.shape :  torch.Size([80, 3])
ind.shape :  torch.Size([80, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([80])
ti.shape :  torch.Size([80])
s_pos.shape :  torch.Size([80, 3])
t_pos.shape :  torch.Size([80, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  80
fraction of true landmark correspondences returned from Lepard :  0.025
vec6d.shape :  torch.Size([79, 6])
ldmk_s.shape :  torch.Size([79, 3])
ldmk_t.shape :  torch.Size([79, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  79
fraction of true landmark correspondences returned from Outlier Rejection :  0.02531645569620253
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([79, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.749 
full-AccS: 0.000 
full-AccR: 0.842 
full-outlier: 96.504 
vis-epe: 17.081 
vis-AccS: 0.000 
vis-AccR: 0.639 
vis-outlier: 96.658 
occ-epe: 12.231 
occ-AccS: 0.000 
occ-AccR: 1.062 
occ-outlier: 96.338 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11382416349754017
Strict IR :  0.0
Relaxed IR :  0.031130390405715743
model 167
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 60]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([124, 2048])
block_i :  1
x.shape :  torch.Size([124, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 124])
coarse_feats.shape :  torch.Size([1, 528, 124])
coarse_feats.shape :  torch.Size([124, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 60])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([60])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([60])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
ind.shape :  torch.Size([3, 3])
bi :  tensor([0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3])
ti.shape :  torch.Size([3])
s_pos.shape :  torch.Size([3, 3])
t_pos.shape :  torch.Size([3, 3])
number of true landmarks correspondences returned from Lepard :  2  out of  3
fraction of true landmark correspondences returned from Lepard :  0.6666666666666666
vec6d.shape :  torch.Size([3, 6])
ldmk_s.shape :  torch.Size([3, 3])
ldmk_t.shape :  torch.Size([3, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  3
fraction of true landmark correspondences returned from Outlier Rejection :  0.6666666666666666
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 7.721 
full-AccS: 0.623 
full-AccR: 7.783 
full-outlier: 21.482 
vis-epe: 7.721 
vis-AccS: 0.623 
vis-AccR: 7.783 
vis-outlier: 21.482 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07577630696128955
Strict IR :  0.004669987546699875
Relaxed IR :  0.08686176836861768
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[64, 56]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([120, 2048])
block_i :  1
x.shape :  torch.Size([120, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 120])
coarse_feats.shape :  torch.Size([1, 528, 120])
coarse_feats.shape :  torch.Size([120, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 64])
tgt_mask.shape :  torch.Size([1, 56])
src_ind_coarse_split.shape :  torch.Size([64])
tgt_ind_coarse_split.shape :  torch.Size([56])
src_ind_coarse.shape :  torch.Size([64])
tgt_ind_coarse.shape :  torch.Size([56])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[54, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([106, 2048])
block_i :  1
x.shape :  torch.Size([106, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 106])
coarse_feats.shape :  torch.Size([1, 528, 106])
coarse_feats.shape :  torch.Size([106, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 54])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([54])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([54])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([4, 3])
bi :  tensor([0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4])
ti.shape :  torch.Size([4])
s_pos.shape :  torch.Size([4, 3])
t_pos.shape :  torch.Size([4, 3])
ind.shape :  torch.Size([4, 3])
bi :  tensor([0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4])
ti.shape :  torch.Size([4])
s_pos.shape :  torch.Size([4, 3])
t_pos.shape :  torch.Size([4, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  4
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([4, 6])
ldmk_s.shape :  torch.Size([4, 3])
ldmk_t.shape :  torch.Size([4, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  4
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([4, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.570 
full-AccS: 0.026 
full-AccR: 0.995 
full-outlier: 96.479 
vis-epe: 17.310 
vis-AccS: 0.000 
vis-AccR: 0.590 
vis-outlier: 96.708 
occ-epe: 13.690 
occ-AccS: 0.053 
occ-AccR: 1.433 
occ-outlier: 96.231 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1238254781054326
Strict IR :  0.0007655014034192396
Relaxed IR :  0.03266139321255422
model 207
Test - confidence threshold : 1.0e-08
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([4365, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4365])
ti.shape :  torch.Size([4365])
s_pos.shape :  torch.Size([4365, 3])
t_pos.shape :  torch.Size([4365, 3])
ind.shape :  torch.Size([4365, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([4365])
ti.shape :  torch.Size([4365])
s_pos.shape :  torch.Size([4365, 3])
t_pos.shape :  torch.Size([4365, 3])
number of true landmarks correspondences returned from Lepard :  61  out of  4365
fraction of true landmark correspondences returned from Lepard :  0.013974799541809852
vec6d.shape :  torch.Size([3499, 6])
ldmk_s.shape :  torch.Size([3499, 3])
ldmk_t.shape :  torch.Size([3499, 3])
number of true landmark correspondences returned from Outlier Rejection :  46  out of  3499
fraction of true landmark correspondences returned from Outlier Rejection :  0.013146613318090883
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([3499, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 24.841 
full-AccS: 0.035 
full-AccR: 0.523 
full-outlier: 99.163 
vis-epe: 24.841 
vis-AccS: 0.035 
vis-AccR: 0.523 
vis-outlier: 99.163 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13566953744424007
Strict IR :  0.00209351011863224
Relaxed IR :  0.02721563154221912
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2592, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2592])
ti.shape :  torch.Size([2592])
s_pos.shape :  torch.Size([2592, 3])
t_pos.shape :  torch.Size([2592, 3])
ind.shape :  torch.Size([2592, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2592])
ti.shape :  torch.Size([2592])
s_pos.shape :  torch.Size([2592, 3])
t_pos.shape :  torch.Size([2592, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  2592
fraction of true landmark correspondences returned from Lepard :  0.015817901234567902
vec6d.shape :  torch.Size([2506, 6])
ldmk_s.shape :  torch.Size([2506, 3])
ldmk_t.shape :  torch.Size([2506, 3])
number of true landmark correspondences returned from Outlier Rejection :  40  out of  2506
fraction of true landmark correspondences returned from Outlier Rejection :  0.01596169193934557
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2506, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.158 
full-AccS: 0.388 
full-AccR: 3.681 
full-outlier: 67.329 
vis-epe: 16.682 
vis-AccS: 0.000 
vis-AccR: 1.829 
vis-outlier: 77.047 
occ-epe: 10.996 
occ-AccS: 0.873 
occ-AccR: 6.001 
occ-outlier: 55.155 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10786546974433696
Strict IR :  0.007750060547348026
Relaxed IR :  0.07023492371034148
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([3683, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3683])
ti.shape :  torch.Size([3683])
s_pos.shape :  torch.Size([3683, 3])
t_pos.shape :  torch.Size([3683, 3])
ind.shape :  torch.Size([3683, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3683])
ti.shape :  torch.Size([3683])
s_pos.shape :  torch.Size([3683, 3])
t_pos.shape :  torch.Size([3683, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  3683
fraction of true landmark correspondences returned from Lepard :  0.015476513711648113
vec6d.shape :  torch.Size([2996, 6])
ldmk_s.shape :  torch.Size([2996, 3])
ldmk_t.shape :  torch.Size([2996, 3])
number of true landmark correspondences returned from Outlier Rejection :  39  out of  2996
fraction of true landmark correspondences returned from Outlier Rejection :  0.0130173564753004
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2996, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.155 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 88.804 
vis-epe: 15.243 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 88.805 
occ-epe: 12.398 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 88.764 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07707176311286786
Strict IR :  0.005591397849462366
Relaxed IR :  0.057634408602150536
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  1e-08
preprocessing :  none
confidence threshold used in the matching :  1e-08
preprocessing :  none
ind.shape :  torch.Size([2819, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2819])
ti.shape :  torch.Size([2819])
s_pos.shape :  torch.Size([2819, 3])
t_pos.shape :  torch.Size([2819, 3])
ind.shape :  torch.Size([2819, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2819])
ti.shape :  torch.Size([2819])
s_pos.shape :  torch.Size([2819, 3])
t_pos.shape :  torch.Size([2819, 3])
number of true landmarks correspondences returned from Lepard :  41  out of  2819
fraction of true landmark correspondences returned from Lepard :  0.014544164597374955
vec6d.shape :  torch.Size([2140, 6])
ldmk_s.shape :  torch.Size([2140, 3])
ldmk_t.shape :  torch.Size([2140, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  2140
fraction of true landmark correspondences returned from Outlier Rejection :  0.01542056074766355
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2140, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.694 
full-AccS: 0.047 
full-AccR: 3.482 
full-outlier: 59.640 
vis-epe: 18.749 
vis-AccS: 0.083 
vis-AccR: 1.819 
vis-outlier: 73.543 
occ-epe: 11.595 
occ-AccS: 0.000 
occ-AccR: 5.713 
occ-outlier: 40.987 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.11691963927171264
Strict IR :  0.0
Relaxed IR :  0.024159166271909047
model 207
Test - confidence threshold : 1.0e-06
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([3262, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3262])
ti.shape :  torch.Size([3262])
s_pos.shape :  torch.Size([3262, 3])
t_pos.shape :  torch.Size([3262, 3])
ind.shape :  torch.Size([3262, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([3262])
ti.shape :  torch.Size([3262])
s_pos.shape :  torch.Size([3262, 3])
t_pos.shape :  torch.Size([3262, 3])
number of true landmarks correspondences returned from Lepard :  61  out of  3262
fraction of true landmark correspondences returned from Lepard :  0.01870018393623544
vec6d.shape :  torch.Size([2649, 6])
ldmk_s.shape :  torch.Size([2649, 3])
ldmk_t.shape :  torch.Size([2649, 3])
number of true landmark correspondences returned from Outlier Rejection :  46  out of  2649
fraction of true landmark correspondences returned from Outlier Rejection :  0.01736504341260853
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2649, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 24.838 
full-AccS: 0.070 
full-AccR: 0.488 
full-outlier: 99.163 
vis-epe: 24.838 
vis-AccS: 0.070 
vis-AccR: 0.488 
vis-outlier: 99.163 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.13564394297246446
Strict IR :  0.0024424284717376133
Relaxed IR :  0.026517794836008374
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2219, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2219])
ti.shape :  torch.Size([2219])
s_pos.shape :  torch.Size([2219, 3])
t_pos.shape :  torch.Size([2219, 3])
ind.shape :  torch.Size([2219, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2219])
ti.shape :  torch.Size([2219])
s_pos.shape :  torch.Size([2219, 3])
t_pos.shape :  torch.Size([2219, 3])
number of true landmarks correspondences returned from Lepard :  35  out of  2219
fraction of true landmark correspondences returned from Lepard :  0.015772870662460567
vec6d.shape :  torch.Size([2132, 6])
ldmk_s.shape :  torch.Size([2132, 3])
ldmk_t.shape :  torch.Size([2132, 3])
number of true landmark correspondences returned from Outlier Rejection :  34  out of  2132
fraction of true landmark correspondences returned from Outlier Rejection :  0.01594746716697936
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2132, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 13.961 
full-AccS: 0.436 
full-AccR: 3.512 
full-outlier: 66.651 
vis-epe: 16.445 
vis-AccS: 0.131 
vis-AccR: 2.091 
vis-outlier: 75.958 
occ-epe: 10.850 
occ-AccS: 0.818 
occ-AccR: 5.292 
occ-outlier: 54.992 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.10589547536629246
Strict IR :  0.008234439331557278
Relaxed IR :  0.07289900702349238
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2379, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2379])
ti.shape :  torch.Size([2379])
s_pos.shape :  torch.Size([2379, 3])
t_pos.shape :  torch.Size([2379, 3])
ind.shape :  torch.Size([2379, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2379])
ti.shape :  torch.Size([2379])
s_pos.shape :  torch.Size([2379, 3])
t_pos.shape :  torch.Size([2379, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  2379
fraction of true landmark correspondences returned from Lepard :  0.02395964691046658
vec6d.shape :  torch.Size([2042, 6])
ldmk_s.shape :  torch.Size([2042, 3])
ldmk_t.shape :  torch.Size([2042, 3])
number of true landmark correspondences returned from Outlier Rejection :  44  out of  2042
fraction of true landmark correspondences returned from Outlier Rejection :  0.021547502448579822
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([2042, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 14.277 
full-AccS: 0.000 
full-AccR: 0.000 
full-outlier: 83.484 
vis-epe: 14.377 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 83.854 
occ-epe: 11.155 
occ-AccS: 0.000 
occ-AccR: 0.000 
occ-outlier: 71.910 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06549484064605687
Strict IR :  0.004731182795698925
Relaxed IR :  0.06666666666666667
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2260, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2260])
ti.shape :  torch.Size([2260])
s_pos.shape :  torch.Size([2260, 3])
t_pos.shape :  torch.Size([2260, 3])
ind.shape :  torch.Size([2260, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2260])
ti.shape :  torch.Size([2260])
s_pos.shape :  torch.Size([2260, 3])
t_pos.shape :  torch.Size([2260, 3])
number of true landmarks correspondences returned from Lepard :  40  out of  2260
fraction of true landmark correspondences returned from Lepard :  0.017699115044247787
vec6d.shape :  torch.Size([1737, 6])
ldmk_s.shape :  torch.Size([1737, 3])
ldmk_t.shape :  torch.Size([1737, 3])
number of true landmark correspondences returned from Outlier Rejection :  33  out of  1737
fraction of true landmark correspondences returned from Outlier Rejection :  0.018998272884283247
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1737, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.882 
full-AccS: 0.142 
full-AccR: 3.340 
full-outlier: 59.735 
vis-epe: 18.813 
vis-AccS: 0.248 
vis-AccR: 1.612 
vis-outlier: 72.179 
occ-epe: 11.950 
occ-AccS: 0.000 
occ-AccR: 5.657 
occ-outlier: 43.039 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.1204176573542178
Strict IR :  0.0
Relaxed IR :  0.02226432970156324
model 207
Test - confidence threshold : 1.0e-04
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1463, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1463])
ti.shape :  torch.Size([1463])
s_pos.shape :  torch.Size([1463, 3])
t_pos.shape :  torch.Size([1463, 3])
ind.shape :  torch.Size([1463, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1463])
ti.shape :  torch.Size([1463])
s_pos.shape :  torch.Size([1463, 3])
t_pos.shape :  torch.Size([1463, 3])
number of true landmarks correspondences returned from Lepard :  55  out of  1463
fraction of true landmark correspondences returned from Lepard :  0.03759398496240601
vec6d.shape :  torch.Size([1144, 6])
ldmk_s.shape :  torch.Size([1144, 3])
ldmk_t.shape :  torch.Size([1144, 3])
number of true landmark correspondences returned from Outlier Rejection :  39  out of  1144
fraction of true landmark correspondences returned from Outlier Rejection :  0.03409090909090909
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1144, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.182 
full-AccS: 0.105 
full-AccR: 1.605 
full-outlier: 97.941 
vis-epe: 16.182 
vis-AccS: 0.105 
vis-AccR: 1.605 
vis-outlier: 97.941 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06608008972134366
Strict IR :  0.013956734124214934
Relaxed IR :  0.12805303558967202
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1022, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1022])
ti.shape :  torch.Size([1022])
s_pos.shape :  torch.Size([1022, 3])
t_pos.shape :  torch.Size([1022, 3])
ind.shape :  torch.Size([1022, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1022])
ti.shape :  torch.Size([1022])
s_pos.shape :  torch.Size([1022, 3])
t_pos.shape :  torch.Size([1022, 3])
number of true landmarks correspondences returned from Lepard :  28  out of  1022
fraction of true landmark correspondences returned from Lepard :  0.0273972602739726
vec6d.shape :  torch.Size([973, 6])
ldmk_s.shape :  torch.Size([973, 3])
ldmk_t.shape :  torch.Size([973, 3])
number of true landmark correspondences returned from Outlier Rejection :  28  out of  973
fraction of true landmark correspondences returned from Outlier Rejection :  0.02877697841726619
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([973, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 8.867 
full-AccS: 0.000 
full-AccR: 6.127 
full-outlier: 28.554 
vis-epe: 11.096 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 47.648 
occ-epe: 6.075 
occ-AccS: 0.000 
occ-AccR: 13.803 
occ-outlier: 4.637 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.06125513406616494
Strict IR :  0.0
Relaxed IR :  0.11649309760232501
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1197, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1197])
ti.shape :  torch.Size([1197])
s_pos.shape :  torch.Size([1197, 3])
t_pos.shape :  torch.Size([1197, 3])
ind.shape :  torch.Size([1197, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1197])
ti.shape :  torch.Size([1197])
s_pos.shape :  torch.Size([1197, 3])
t_pos.shape :  torch.Size([1197, 3])
number of true landmarks correspondences returned from Lepard :  54  out of  1197
fraction of true landmark correspondences returned from Lepard :  0.045112781954887216
vec6d.shape :  torch.Size([1034, 6])
ldmk_s.shape :  torch.Size([1034, 3])
ldmk_t.shape :  torch.Size([1034, 3])
number of true landmark correspondences returned from Outlier Rejection :  45  out of  1034
fraction of true landmark correspondences returned from Outlier Rejection :  0.043520309477756286
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([1034, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.517 
full-AccS: 0.243 
full-AccR: 3.164 
full-outlier: 63.387 
vis-epe: 11.775 
vis-AccS: 0.251 
vis-AccR: 2.655 
vis-outlier: 65.411 
occ-epe: 3.410 
occ-AccS: 0.000 
occ-AccR: 19.101 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.019873131629245294
Strict IR :  0.20774193548387096
Relaxed IR :  0.8731182795698925
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.0001
preprocessing :  none
confidence threshold used in the matching :  0.0001
preprocessing :  none
ind.shape :  torch.Size([1099, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1099])
ti.shape :  torch.Size([1099])
s_pos.shape :  torch.Size([1099, 3])
t_pos.shape :  torch.Size([1099, 3])
ind.shape :  torch.Size([1099, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1099])
ti.shape :  torch.Size([1099])
s_pos.shape :  torch.Size([1099, 3])
t_pos.shape :  torch.Size([1099, 3])
number of true landmarks correspondences returned from Lepard :  21  out of  1099
fraction of true landmark correspondences returned from Lepard :  0.01910828025477707
vec6d.shape :  torch.Size([854, 6])
ldmk_s.shape :  torch.Size([854, 3])
ldmk_t.shape :  torch.Size([854, 3])
number of true landmark correspondences returned from Outlier Rejection :  19  out of  854
fraction of true landmark correspondences returned from Outlier Rejection :  0.02224824355971897
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([854, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 15.931 
full-AccS: 0.047 
full-AccR: 3.790 
full-outlier: 59.190 
vis-epe: 18.851 
vis-AccS: 0.083 
vis-AccR: 1.860 
vis-outlier: 71.269 
occ-epe: 12.012 
occ-AccS: 0.000 
occ-AccR: 6.378 
occ-outlier: 42.984 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12156253042421483
Strict IR :  0.0
Relaxed IR :  0.030317385125532923
model 207
Test - confidence threshold : 1.0e-02
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([29, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([29])
ti.shape :  torch.Size([29])
s_pos.shape :  torch.Size([29, 3])
t_pos.shape :  torch.Size([29, 3])
ind.shape :  torch.Size([29, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([29])
ti.shape :  torch.Size([29])
s_pos.shape :  torch.Size([29, 3])
t_pos.shape :  torch.Size([29, 3])
number of true landmarks correspondences returned from Lepard :  5  out of  29
fraction of true landmark correspondences returned from Lepard :  0.1724137931034483
vec6d.shape :  torch.Size([21, 6])
ldmk_s.shape :  torch.Size([21, 3])
ldmk_t.shape :  torch.Size([21, 3])
number of true landmark correspondences returned from Outlier Rejection :  2  out of  21
fraction of true landmark correspondences returned from Outlier Rejection :  0.09523809523809523
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([21, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 18.623 
full-AccS: 0.070 
full-AccR: 0.454 
full-outlier: 99.512 
vis-epe: 18.623 
vis-AccS: 0.070 
vis-AccR: 0.454 
vis-outlier: 99.512 
occ-epe: nan 
occ-AccS: nan 
occ-AccR: nan 
occ-outlier: nan 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.09442978034531711
Strict IR :  0.0
Relaxed IR :  0.03524075366364271
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([50, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([50])
ti.shape :  torch.Size([50])
s_pos.shape :  torch.Size([50, 3])
t_pos.shape :  torch.Size([50, 3])
ind.shape :  torch.Size([50, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:0')
si.shape :  torch.Size([50])
ti.shape :  torch.Size([50])
s_pos.shape :  torch.Size([50, 3])
t_pos.shape :  torch.Size([50, 3])
number of true landmarks correspondences returned from Lepard :  1  out of  50
fraction of true landmark correspondences returned from Lepard :  0.02
vec6d.shape :  torch.Size([46, 6])
ldmk_s.shape :  torch.Size([46, 3])
ldmk_t.shape :  torch.Size([46, 3])
number of true landmark correspondences returned from Outlier Rejection :  1  out of  46
fraction of true landmark correspondences returned from Outlier Rejection :  0.021739130434782608
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([46, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 10.648 
full-AccS: 0.000 
full-AccR: 3.560 
full-outlier: 38.823 
vis-epe: 12.920 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 60.061 
occ-epe: 7.803 
occ-AccS: 0.000 
occ-AccR: 8.020 
occ-outlier: 12.220 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.07832551121917511
Strict IR :  0.0
Relaxed IR :  0.07023492371034148
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([89, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([89])
ti.shape :  torch.Size([89])
s_pos.shape :  torch.Size([89, 3])
t_pos.shape :  torch.Size([89, 3])
ind.shape :  torch.Size([89, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([89])
ti.shape :  torch.Size([89])
s_pos.shape :  torch.Size([89, 3])
t_pos.shape :  torch.Size([89, 3])
number of true landmarks correspondences returned from Lepard :  8  out of  89
fraction of true landmark correspondences returned from Lepard :  0.0898876404494382
vec6d.shape :  torch.Size([84, 6])
ldmk_s.shape :  torch.Size([84, 3])
ldmk_t.shape :  torch.Size([84, 3])
number of true landmark correspondences returned from Outlier Rejection :  6  out of  84
fraction of true landmark correspondences returned from Outlier Rejection :  0.07142857142857142
k0 :  -8
levels :  4
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([84, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 11.019 
full-AccS: 0.382 
full-AccR: 5.807 
full-outlier: 59.597 
vis-epe: 11.318 
vis-AccS: 0.395 
vis-AccR: 2.799 
vis-outlier: 61.500 
occ-epe: 1.674 
occ-AccS: 0.000 
occ-AccR: 100.000 
occ-outlier: 0.000 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.023281766840081302
Strict IR :  0.0610752688172043
Relaxed IR :  0.8627956989247312
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.01
preprocessing :  none
confidence threshold used in the matching :  0.01
preprocessing :  none
ind.shape :  torch.Size([58, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([58])
ti.shape :  torch.Size([58])
s_pos.shape :  torch.Size([58, 3])
t_pos.shape :  torch.Size([58, 3])
ind.shape :  torch.Size([58, 3])
bi :  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([58])
ti.shape :  torch.Size([58])
s_pos.shape :  torch.Size([58, 3])
t_pos.shape :  torch.Size([58, 3])
number of true landmarks correspondences returned from Lepard :  0  out of  58
fraction of true landmark correspondences returned from Lepard :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
vec6d.shape :  torch.Size([50, 6])
ldmk_s.shape :  torch.Size([50, 3])
ldmk_t.shape :  torch.Size([50, 3])
number of true landmark correspondences returned from Outlier Rejection :  0  out of  50
fraction of true landmark correspondences returned from Outlier Rejection :  0.0
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
k0 :  -8
levels :  1
posenc function :  None
samples :  2000
src_ldmk.shape in optimize_deformation_pyramid :  torch.Size([50, 3])
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
strict threshold :  0.01
relaxed threhold :  0.03
outlier threshold :  0.1
0/1: full-epe: 16.011 
full-AccS: 0.000 
full-AccR: 0.261 
full-outlier: 65.940 
vis-epe: 17.130 
vis-AccS: 0.000 
vis-AccR: 0.000 
vis-outlier: 65.068 
occ-epe: 14.511 
occ-AccS: 0.000 
occ-AccR: 0.610 
occ-outlier: 67.110 

strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
RMSE :  0.12731240799195864
Strict IR :  0.0035528185693983892
Relaxed IR :  0.04239696826148745
model 207
Test - confidence threshold : 0.1
Full Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[70, 65]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([135, 2048])
block_i :  1
x.shape :  torch.Size([135, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 135])
coarse_feats.shape :  torch.Size([1, 528, 135])
coarse_feats.shape :  torch.Size([135, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 70])
tgt_mask.shape :  torch.Size([1, 65])
src_ind_coarse_split.shape :  torch.Size([70])
tgt_ind_coarse_split.shape :  torch.Size([65])
src_ind_coarse.shape :  torch.Size([70])
tgt_ind_coarse.shape :  torch.Size([65])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[51, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([103, 2048])
block_i :  1
x.shape :  torch.Size([103, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 103])
coarse_feats.shape :  torch.Size([1, 528, 103])
coarse_feats.shape :  torch.Size([103, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 51])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([51])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([51])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Full Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[67, 66]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([133, 2048])
block_i :  1
x.shape :  torch.Size([133, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 133])
coarse_feats.shape :  torch.Size([1, 528, 133])
coarse_feats.shape :  torch.Size([133, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 67])
tgt_mask.shape :  torch.Size([1, 66])
src_ind_coarse_split.shape :  torch.Size([67])
tgt_ind_coarse_split.shape :  torch.Size([66])
src_ind_coarse.shape :  torch.Size([67])
tgt_ind_coarse.shape :  torch.Size([66])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
Partial Non Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[47, 62]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([109, 2048])
block_i :  1
x.shape :  torch.Size([109, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 109])
coarse_feats.shape :  torch.Size([1, 528, 109])
coarse_feats.shape :  torch.Size([109, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 47])
tgt_mask.shape :  torch.Size([1, 62])
src_ind_coarse_split.shape :  torch.Size([47])
tgt_ind_coarse_split.shape :  torch.Size([62])
src_ind_coarse.shape :  torch.Size([47])
tgt_ind_coarse.shape :  torch.Size([62])
confidence threshold used in the matching :  0.1
preprocessing :  none
confidence threshold used in the matching :  0.1
preprocessing :  none
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
[1;33m[Open3D WARNING] Write PLY failed: line set has 0 points.[0;m
ind.shape :  torch.Size([0, 3])
bi :  tensor([], device='cuda:0', dtype=torch.int64)
si.shape :  torch.Size([0])
ti.shape :  torch.Size([0])
s_pos.shape :  torch.Size([0, 3])
t_pos.shape :  torch.Size([0, 3])
Early exit
