model 085
Using ARP
number of centers 500
average distance multiplier 2.0
inlier outlier thresholds 0.01
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[73, 57]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([130, 2048])
block_i :  1
x.shape :  torch.Size([130, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 130])
coarse_feats.shape :  torch.Size([1, 528, 130])
coarse_feats.shape :  torch.Size([130, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 73])
tgt_mask.shape :  torch.Size([1, 57])
src_ind_coarse_split.shape :  torch.Size([73])
tgt_ind_coarse_split.shape :  torch.Size([57])
src_ind_coarse.shape :  torch.Size([73])
tgt_ind_coarse.shape :  torch.Size([57])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([2603, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2603])
ti.shape :  torch.Size([2603])
s_pos.shape :  torch.Size([2603, 3])
t_pos.shape :  torch.Size([2603, 3])
ind.shape :  torch.Size([2603, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([2603])
ti.shape :  torch.Size([2603])
s_pos.shape :  torch.Size([2603, 3])
t_pos.shape :  torch.Size([2603, 3])
number of true landmarks correspondences returned from Lepard :  33  out of  2603
fraction of true landmark correspondences returned from Lepard :  0.012677679600461006
vec6d.shape :  torch.Size([2603, 6])
ldmk_s.shape :  torch.Size([2603, 3])
ldmk_t.shape :  torch.Size([2603, 3])
number of true landmark correspondences returned from Outlier Rejection :  30  out of  2236
fraction of true landmark correspondences returned from Outlier Rejection :  0.013416815742397137
Custom filtering is used
number of landmarks before custom filtering :  2603
average distance :  0.034961868505431454
average distance multiplier :  2.0
number of unique source landmarks :  73
number of centers :  500
sampling :  linspace
number of neighborhood centers :  500
number of iterations of custom filtering :  1
inlier outlier threshold :  0.01
number of distinct source landmarks :  73
max_ldmks :  None
number of landmarks after custom filtering :  73
number of true landmark correspondences returned from custom filtering :  0  out of  73
fraction of true landmark correspondences returned from custom filtering :  0.0
fraction of true landmark correspondences returned from custom filtering also returned from Lepard :  0
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(AlignAndNonRigidMerge) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L167:#points1: 73
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L168:#points2: 73
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L169:#matches: 73
Before Run of ransac
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SquentialRANSAC) {
num_inliers : 13
num_inliers : 18
num_inliers : 16
num_inliers : 6
num_inliers : 14
num_inliers : 11
num_inliers : 5
num_inliers : 3
num_inliers : 11
num_inliers : 11
num_inliers : 12
num_inliers : 5
num_inliers : 6
num_inliers : 16
num_inliers : 14
num_inliers : 13
num_inliers : 3
num_inliers : 11
num_inliers : 12
num_inliers : 11
num_inliers : 10
num_inliers : 17
num_inliers : 14
num_inliers : 6
num_inliers : 9
num_inliers : 11
num_inliers : 16
num_inliers : 10
num_inliers : 7
num_inliers : 9
num_inliers : 13
num_inliers : 14
num_inliers : 10
num_inliers : 12
num_inliers : 15
num_inliers : 14
num_inliers : 12
num_inliers : 13
num_inliers : 4
num_inliers : 10
num_inliers : 2
num_inliers : 20
num_inliers : 13
num_inliers : 6
num_inliers : 13
num_inliers : 16
num_inliers : 8
num_inliers : 12
num_inliers : 15
num_inliers : 5
num_inliers : 6
num_inliers : 7
num_inliers : 6
num_inliers : 14
num_inliers : 12
num_inliers : 7
num_inliers : 10
num_inliers : 16
num_inliers : 9
num_inliers : 13
num_inliers : 17
num_inliers : 20
num_inliers : 12
num_inliers : 13
num_inliers : 13
num_inliers : 13
num_inliers : 15
num_inliers : 13
num_inliers : 15
num_inliers : 13
num_inliers : 10
num_inliers : 14
num_inliers : 17
num_inliers : 11
num_inliers : 11
num_inliers : 8
num_inliers : 11
num_inliers : 11
num_inliers : 8
num_inliers : 5
num_inliers : 19
num_inliers : 5
num_inliers : 6
num_inliers : 26
num_inliers : 11
num_inliers : 13
num_inliers : 5
num_inliers : 12
num_inliers : 10
num_inliers : 4
num_inliers : 17
num_inliers : 11
num_inliers : 7
num_inliers : 7
num_inliers : 11
num_inliers : 4
num_inliers : 15
num_inliers : 12
num_inliers : 9
num_inliers : 5
num_inliers : 8
num_inliers inside of Run : 26
num_inliers : 1
num_inliers : 3
num_inliers : 7
num_inliers : 9
num_inliers : 10
num_inliers : 12
num_inliers : 9
num_inliers : 13
num_inliers : 4
num_inliers : 6
num_inliers : 11
num_inliers : 8
num_inliers : 5
num_inliers : 6
num_inliers : 10
num_inliers : 3
num_inliers : 12
num_inliers : 13
num_inliers : 7
num_inliers : 6
num_inliers : 11
num_inliers : 8
num_inliers : 5
num_inliers : 6
num_inliers : 3
num_inliers : 7
num_inliers : 8
num_inliers : 4
num_inliers : 7
num_inliers : 14
num_inliers : 8
num_inliers : 3
num_inliers : 7
num_inliers : 1
num_inliers : 3
num_inliers : 3
num_inliers : 11
num_inliers : 14
num_inliers : 6
num_inliers : 6
num_inliers : 10
num_inliers : 13
num_inliers : 7
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 8
num_inliers : 3
num_inliers : 8
num_inliers : 3
num_inliers : 10
num_inliers : 1
num_inliers : 4
num_inliers : 13
num_inliers : 5
num_inliers : 4
num_inliers : 7
num_inliers : 3
num_inliers : 11
num_inliers : 10
num_inliers : 2
num_inliers : 7
num_inliers : 4
num_inliers : 9
num_inliers : 8
num_inliers : 6
num_inliers : 4
num_inliers : 12
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 9
num_inliers : 4
num_inliers : 8
num_inliers : 5
num_inliers : 2
num_inliers : 4
num_inliers : 6
num_inliers : 5
num_inliers : 2
num_inliers : 8
num_inliers : 6
num_inliers : 5
num_inliers : 9
num_inliers : 4
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 7
num_inliers : 7
num_inliers : 4
num_inliers : 7
num_inliers : 12
num_inliers : 4
num_inliers : 10
num_inliers : 5
num_inliers : 9
num_inliers : 14
num_inliers : 2
num_inliers : 3
num_inliers : 9
num_inliers : 11
num_inliers : 9
num_inliers : 4
num_inliers : 7
num_inliers : 9
num_inliers : 5
num_inliers : 10
num_inliers : 9
num_inliers : 10
num_inliers : 9
num_inliers : 6
num_inliers : 11
num_inliers : 6
num_inliers : 9
num_inliers : 6
num_inliers : 8
num_inliers : 11
num_inliers : 5
num_inliers : 8
num_inliers : 3
num_inliers : 9
num_inliers : 5
num_inliers : 7
num_inliers : 7
num_inliers : 8
num_inliers : 4
num_inliers : 11
num_inliers : 3
num_inliers : 6
num_inliers : 9
num_inliers : 3
num_inliers : 3
num_inliers : 12
num_inliers : 6
num_inliers : 11
num_inliers : 11
num_inliers : 4
num_inliers : 3
num_inliers : 7
num_inliers : 4
num_inliers : 10
num_inliers : 7
num_inliers : 12
num_inliers : 6
num_inliers : 4
num_inliers : 3
num_inliers : 13
num_inliers : 6
num_inliers : 15
num_inliers inside of Run : 15
num_inliers : 7
num_inliers : 8
num_inliers : 3
num_inliers : 7
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 1
num_inliers : 3
num_inliers : 9
num_inliers : 2
num_inliers : 4
num_inliers : 3
num_inliers : 3
num_inliers : 6
num_inliers : 1
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 4
num_inliers : 6
num_inliers : 0
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 8
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 5
num_inliers : 6
num_inliers : 4
num_inliers : 2
num_inliers : 2
num_inliers : 6
num_inliers : 4
num_inliers : 9
num_inliers : 4
num_inliers : 2
num_inliers : 6
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 6
num_inliers : 4
num_inliers : 2
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 8
num_inliers : 2
num_inliers : 5
num_inliers : 4
num_inliers : 1
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 2
num_inliers : 7
num_inliers : 5
num_inliers : 1
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 2
num_inliers : 3
num_inliers : 6
num_inliers : 6
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 2
num_inliers : 2
num_inliers : 4
num_inliers : 5
num_inliers : 7
num_inliers : 4
num_inliers : 1
num_inliers : 3
num_inliers : 4
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 4
num_inliers : 6
num_inliers : 9
num_inliers : 5
num_inliers : 8
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 1
num_inliers : 8
num_inliers : 5
num_inliers : 3
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 6
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 3
num_inliers : 2
num_inliers : 3
num_inliers : 4
num_inliers : 7
num_inliers : 11
num_inliers inside of Run : 11
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 1
num_inliers : 4
num_inliers : 4
num_inliers : 6
num_inliers : 3
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 2
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 2
num_inliers : 3
num_inliers : 4
num_inliers : 2
num_inliers : 5
num_inliers : 1
num_inliers : 5
num_inliers : 3
num_inliers : 7
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 1
num_inliers : 4
num_inliers : 1
num_inliers : 5
num_inliers : 3
num_inliers : 2
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 6
num_inliers : 3
num_inliers : 3
num_inliers : 2
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 2
num_inliers : 3
num_inliers : 3
num_inliers : 2
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 3
num_inliers : 2
num_inliers : 4
num_inliers : 4
num_inliers : 0
num_inliers : 2
num_inliers : 1
num_inliers : 4
num_inliers : 6
num_inliers : 3
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 1
num_inliers : 2
num_inliers : 5
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 2
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 1
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 3
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 7
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers inside of Run : 7
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SquentialRANSAC) [0.045356 s]
  -0.27701   0.368385   0.389585     0.4058
  0.486041   0.357671 0.00738647   0.276513
 -0.226381   0.317148  -0.460855   0.941304
         0          0          0          1
  0.275315  0.0372954   0.711352 -0.0938948
 -0.538023  -0.488927   0.233865    1.34401
  0.466845  -0.585466  -0.149988   0.430563
         0          0          0          1
-0.399831  0.453342  0.327905   0.45112
  0.48877 0.0868689  0.475882  0.264443
 0.272295  0.509745 -0.372721   0.43865
        0         0         0         1
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(DenseGaussNewton::optimize()) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L118:# parameters: 7
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L119:# residuals: 5199
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L238:Gauss-Newton gradient threshold reached.
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L240:Gauss-Newton gradient max norm 0.000000e+00 <= 1.000000e-06
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L241:Gauss-Newton convergence #iters: 11
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L242:Gauss-Newton converged.
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (DenseGaussNewton::optimize()) [0.031302 s]
Affine transform:  0.00166366 -0.00181811  0.00182981   0.0127296
 0.00191872  0.00232749 0.000568119     0.54522
-0.00172402 0.000835897  0.00239802    0.434717
          0           0           0           1
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L232:#models: 3
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 0 | #inliers 26
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 1 | #inliers 15
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 2 | #inliers 11
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L235:#inilers: 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L257:Mesh1: #vertices: 4501
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L258:Mesh2: #vertices: 5199
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Registration2::Register) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L784:SampleDeformationNodes
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.004328 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L790:Create balltree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L797:Build kdtree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L804:Create matches...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L826:#matches / #inliers: 73/73
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L827:Mesh1: #points | #normals: 52 | 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L828:Mesh2: #points | #normals: 52 | 52
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SetupRegistrationProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SetupRegistrationProblem) [0.000036 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SolveCeresProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SolveCeresProblem) [0.000891 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L881:Summary: 
Solver Summary (v 2.1.0-eigen-(3.3.4)-lapack-suitesparse-(5.1.2)-cxsparse-(3.1.9)-eigensparse-no_openmp-cuda-(11030))

                                     Original                  Reduced
Parameter blocks                            1                        1
Parameters                                  6                        6
Residual blocks                            52                       52
Residuals                                  52                       52

Minimizer                        TRUST_REGION

Sparse linear algebra library    SUITE_SPARSE
Trust region strategy     LEVENBERG_MARQUARDT

                                        Given                     Used
Linear solver          SPARSE_NORMAL_CHOLESKY   SPARSE_NORMAL_CHOLESKY
Threads                                    16                       16
Linear solver ordering              AUTOMATIC                        1

Cost:
Initial                         -1.000000e+00

Minimizer iterations                        0
Successful steps                            0
Unsuccessful steps                          0

Time (in seconds):
Preprocessor                         0.000346

  Residual only evaluation           0.000000 (0)
  Jacobian & residual evaluation     0.000481 (1)
  Linear solver                      0.000000 (0)
Minimizer                            0.000513

Postprocessor                        0.000005
Total                                0.000876

Termination:                          FAILURE (Residual and Jacobian evaluation failed.)

INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Update nodes) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Update nodes) [0.000005 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Registration2::Register) [0.011123 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.005449 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
[1;33m[Open3D WARNING] Read PLY failed: unable to open file: TestData/PartialDeformed/model085/output_final_p_none_c_0.000001_nc_500_adm_2.0_iot_0.01_s_linspace_max_ldmks_None_kpfcn_td_partial_deformed_current_deformation/current_deformation.ply[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
