model 167
Using ARP
number of centers 500
average distance multiplier 2.0
inlier outlier thresholds 0.01
Partial Deformed
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
coarse_level :  None
feature extractor inside of collate_fn_4dmatch :  kpfcn
coarse_level :  None
coarse_level :  -2
pts_num_coarse :  tensor([[61, 52]], dtype=torch.int32)


knn_matching :  False
index_at_which_to_return_coarse_feats :  1
block_i :  0
x.shape :  torch.Size([113, 2048])
block_i :  1
x.shape :  torch.Size([113, 1024])
coarse_feats.shape :  torch.Size([1, 1024, 113])
coarse_feats.shape :  torch.Size([1, 528, 113])
coarse_feats.shape :  torch.Size([113, 528])
coarse_level :  -2
src_mask.shape :  torch.Size([1, 61])
tgt_mask.shape :  torch.Size([1, 52])
src_ind_coarse_split.shape :  torch.Size([61])
tgt_ind_coarse_split.shape :  torch.Size([52])
src_ind_coarse.shape :  torch.Size([61])
tgt_ind_coarse.shape :  torch.Size([52])
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
ind.shape :  torch.Size([1990, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1990])
ti.shape :  torch.Size([1990])
s_pos.shape :  torch.Size([1990, 3])
t_pos.shape :  torch.Size([1990, 3])
ind.shape :  torch.Size([1990, 3])
bi :  tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0')
si.shape :  torch.Size([1990])
ti.shape :  torch.Size([1990])
s_pos.shape :  torch.Size([1990, 3])
t_pos.shape :  torch.Size([1990, 3])
number of true landmarks correspondences returned from Lepard :  57  out of  1990
fraction of true landmark correspondences returned from Lepard :  0.02864321608040201
vec6d.shape :  torch.Size([1990, 6])
ldmk_s.shape :  torch.Size([1990, 3])
ldmk_t.shape :  torch.Size([1990, 3])
number of true landmark correspondences returned from Outlier Rejection :  54  out of  1474
fraction of true landmark correspondences returned from Outlier Rejection :  0.036635006784260515
Custom filtering is used
number of landmarks before custom filtering :  1990
average distance :  0.028782707061056987
average distance multiplier :  2.0
number of unique source landmarks :  61
number of centers :  500
sampling :  linspace
number of neighborhood centers :  500
number of iterations of custom filtering :  1
inlier outlier threshold :  0.01
number of distinct source landmarks :  61
max_ldmks :  None
number of landmarks after custom filtering :  61
number of true landmark correspondences returned from custom filtering :  2  out of  61
fraction of true landmark correspondences returned from custom filtering :  0.03278688524590164
fraction of true landmark correspondences returned from custom filtering also returned from Lepard :  1.0
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(AlignAndNonRigidMerge) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L167:#points1: 61
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L168:#points2: 61
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L169:#matches: 61
Before Run of ransac
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SquentialRANSAC) {
num_inliers : 12
num_inliers : 6
num_inliers : 23
num_inliers : 15
num_inliers : 14
num_inliers : 11
num_inliers : 18
num_inliers : 20
num_inliers : 10
num_inliers : 16
num_inliers : 7
num_inliers : 17
num_inliers : 21
num_inliers : 16
num_inliers : 10
num_inliers : 5
num_inliers : 17
num_inliers : 7
num_inliers : 13
num_inliers : 8
num_inliers : 12
num_inliers : 12
num_inliers : 23
num_inliers : 15
num_inliers : 17
num_inliers : 13
num_inliers : 2
num_inliers : 19
num_inliers : 20
num_inliers : 13
num_inliers : 25
num_inliers : 12
num_inliers : 6
num_inliers : 11
num_inliers : 15
num_inliers : 11
num_inliers : 13
num_inliers : 14
num_inliers : 11
num_inliers : 24
num_inliers : 9
num_inliers : 12
num_inliers : 12
num_inliers : 9
num_inliers : 7
num_inliers : 16
num_inliers : 12
num_inliers : 15
num_inliers : 4
num_inliers : 15
num_inliers : 7
num_inliers : 14
num_inliers : 16
num_inliers : 14
num_inliers : 6
num_inliers : 10
num_inliers : 5
num_inliers : 4
num_inliers : 16
num_inliers : 15
num_inliers : 14
num_inliers : 26
num_inliers : 14
num_inliers : 17
num_inliers : 14
num_inliers : 20
num_inliers : 7
num_inliers : 13
num_inliers : 14
num_inliers : 9
num_inliers : 21
num_inliers : 6
num_inliers : 23
num_inliers : 6
num_inliers : 10
num_inliers : 8
num_inliers : 9
num_inliers : 12
num_inliers : 3
num_inliers : 10
num_inliers : 25
num_inliers : 10
num_inliers : 11
num_inliers : 7
num_inliers : 19
num_inliers : 15
num_inliers : 17
num_inliers : 21
num_inliers : 7
num_inliers : 6
num_inliers : 14
num_inliers : 11
num_inliers : 19
num_inliers : 11
num_inliers : 9
num_inliers : 14
num_inliers : 18
num_inliers : 10
num_inliers : 5
num_inliers : 17
num_inliers : 19
num_inliers inside of Run : 26
num_inliers : 11
num_inliers : 11
num_inliers : 9
num_inliers : 7
num_inliers : 9
num_inliers : 3
num_inliers : 10
num_inliers : 11
num_inliers : 13
num_inliers : 8
num_inliers : 12
num_inliers : 6
num_inliers : 9
num_inliers : 7
num_inliers : 9
num_inliers : 13
num_inliers : 6
num_inliers : 9
num_inliers : 2
num_inliers : 9
num_inliers : 6
num_inliers : 11
num_inliers : 5
num_inliers : 9
num_inliers : 5
num_inliers : 4
num_inliers : 7
num_inliers : 14
num_inliers : 3
num_inliers : 9
num_inliers : 8
num_inliers : 9
num_inliers : 11
num_inliers : 6
num_inliers : 7
num_inliers : 6
num_inliers : 3
num_inliers : 4
num_inliers : 7
num_inliers : 8
num_inliers : 6
num_inliers : 5
num_inliers : 10
num_inliers : 5
num_inliers : 15
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 6
num_inliers : 13
num_inliers : 5
num_inliers : 9
num_inliers : 12
num_inliers : 3
num_inliers : 6
num_inliers : 10
num_inliers : 7
num_inliers : 8
num_inliers : 11
num_inliers : 5
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 11
num_inliers : 8
num_inliers : 5
num_inliers : 11
num_inliers : 8
num_inliers : 6
num_inliers : 3
num_inliers : 9
num_inliers : 4
num_inliers : 7
num_inliers : 13
num_inliers : 8
num_inliers : 8
num_inliers : 3
num_inliers : 5
num_inliers : 12
num_inliers : 7
num_inliers : 12
num_inliers : 4
num_inliers : 5
num_inliers : 10
num_inliers : 4
num_inliers : 6
num_inliers : 10
num_inliers : 6
num_inliers : 4
num_inliers : 10
num_inliers : 10
num_inliers : 5
num_inliers : 9
num_inliers : 7
num_inliers : 5
num_inliers : 7
num_inliers : 10
num_inliers : 13
num_inliers : 8
num_inliers inside of Run : 15
num_inliers : 8
num_inliers : 3
num_inliers : 7
num_inliers : 7
num_inliers : 5
num_inliers : 3
num_inliers : 6
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 10
num_inliers : 4
num_inliers : 2
num_inliers : 7
num_inliers : 7
num_inliers : 5
num_inliers : 4
num_inliers : 8
num_inliers : 6
num_inliers : 9
num_inliers : 6
num_inliers : 11
num_inliers : 11
num_inliers : 9
num_inliers : 8
num_inliers : 6
num_inliers : 4
num_inliers : 2
num_inliers : 6
num_inliers : 4
num_inliers : 7
num_inliers : 4
num_inliers : 4
num_inliers : 4
num_inliers : 2
num_inliers : 4
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 8
num_inliers : 5
num_inliers : 9
num_inliers : 9
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 7
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 7
num_inliers : 4
num_inliers : 6
num_inliers : 7
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 4
num_inliers : 7
num_inliers : 5
num_inliers : 5
num_inliers : 9
num_inliers : 5
num_inliers : 7
num_inliers : 5
num_inliers : 9
num_inliers : 5
num_inliers : 5
num_inliers : 7
num_inliers : 6
num_inliers : 9
num_inliers : 5
num_inliers : 7
num_inliers : 4
num_inliers : 5
num_inliers : 7
num_inliers : 5
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 8
num_inliers : 5
num_inliers : 8
num_inliers : 9
num_inliers : 4
num_inliers : 5
num_inliers : 7
num_inliers : 8
num_inliers : 5
num_inliers inside of Run : 11
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SquentialRANSAC) [0.052620 s]
 -0.353562  -0.100374   0.377078   0.165862
-0.0949672   -0.47141  -0.214529   0.384017
  0.378476  -0.212053   0.298427   0.431622
         0          0          0          1
 -0.187133  -0.653438   0.160074   0.431836
 -0.370548 -0.0385668  -0.590619   0.507232
  0.561515  -0.243218  -0.336407   0.816451
         0          0          0          1
  0.316973  -0.295411  -0.668288   0.778379
  0.113503   0.739527  -0.273066 -0.0420411
  0.721799   0.013437   0.336414   0.188574
         0          0          0          1
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(DenseGaussNewton::optimize()) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L118:# parameters: 7
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L119:# residuals: 3919
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L238:Gauss-Newton gradient threshold reached.
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L240:Gauss-Newton gradient max norm 0.000000e+00 <= 1.000000e-06
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L241:Gauss-Newton convergence #iters: 7
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L242:Gauss-Newton converged.
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (DenseGaussNewton::optimize()) [0.016313 s]
Affine transform:  0.00220939 -0.00224676 -0.00319024   -0.680065
 0.00389118  0.00154133  0.00160933   0.0556399
 0.00029023 -0.00356136  0.00270913    0.749076
          0           0           0           1
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L232:#models: 3
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 0 | #inliers 26
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 1 | #inliers 15
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 2 | #inliers 11
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L235:#inilers: 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L257:Mesh1: #vertices: 4095
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L258:Mesh2: #vertices: 3919
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Registration2::Register) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L784:SampleDeformationNodes
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.002994 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L790:Create balltree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L797:Build kdtree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L804:Create matches...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L826:#matches / #inliers: 61/61
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L827:Mesh1: #points | #normals: 52 | 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L828:Mesh2: #points | #normals: 52 | 52
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SetupRegistrationProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SetupRegistrationProblem) [0.000036 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SolveCeresProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SolveCeresProblem) [0.000961 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L881:Summary: 
Solver Summary (v 2.1.0-eigen-(3.3.4)-lapack-suitesparse-(5.1.2)-cxsparse-(3.1.9)-eigensparse-no_openmp-cuda-(11030))

                                     Original                  Reduced
Parameter blocks                            1                        1
Parameters                                  6                        6
Residual blocks                            52                       52
Residuals                                  52                       52

Minimizer                        TRUST_REGION

Sparse linear algebra library    SUITE_SPARSE
Trust region strategy     LEVENBERG_MARQUARDT

                                        Given                     Used
Linear solver          SPARSE_NORMAL_CHOLESKY   SPARSE_NORMAL_CHOLESKY
Threads                                    16                       16
Linear solver ordering              AUTOMATIC                        1

Cost:
Initial                         -1.000000e+00

Minimizer iterations                        0
Successful steps                            0
Unsuccessful steps                          0

Time (in seconds):
Preprocessor                         0.000386

  Residual only evaluation           0.000000 (0)
  Jacobian & residual evaluation     0.000498 (1)
  Linear solver                      0.000000 (0)
Minimizer                            0.000539

Postprocessor                        0.000008
Total                                0.000946

Termination:                          FAILURE (Residual and Jacobian evaluation failed.)

INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Update nodes) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Update nodes) [0.000004 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Registration2::Register) [0.008518 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.004699 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
[1;33m[Open3D WARNING] Read PLY failed: unable to open file: TestData/PartialDeformed/model167/output_final_p_none_c_0.000001_nc_500_adm_2.0_iot_0.01_s_linspace_max_ldmks_None_kpfcn_td_partial_deformed_current_deformation/current_deformation.ply[0;m
[1;33m[Open3D WARNING] Write PLY failed: point cloud has 0 points.[0;m
