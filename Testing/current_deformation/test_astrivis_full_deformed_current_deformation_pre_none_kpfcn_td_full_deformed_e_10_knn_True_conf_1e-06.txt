model 002 file1 020 file2 104
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
F0.shape : torch.Size([150, 528])
F1.shape : torch.Size([164, 528])
ldmk_t_indices :  tensor([145, 136, 153, 117,  25, 117, 104, 117, 117,  48, 129,  45,  13,  27,
         13,  39, 131,  39,  45,  39,  13, 100,  93,  38,  39, 117,  39,  61,
         19,  33, 153,  44,  52,  54,  54,  52,  44,  39, 152,  39, 104,  25,
         93,  54,  74,  25,  44,  34,  52, 161, 145, 140,  59,  88,  13,  59,
        147,  57, 136,  84, 142, 137, 153, 138, 141, 131,  67, 141, 141,  76,
         61,  80,   0,  45, 151,   5, 104,  88,  59, 147,  13,  84, 141, 161,
         39,  57,  82,  39, 153,  74,  25,  57,  59,  39, 153, 103,  29,  25,
        124,  84,  59,  57, 122,  39,  84, 142, 122,  61, 100,  25,  39,  84,
         59, 156,  57, 145,  84, 141,  57,  80, 104,  67, 136,  67,   5, 139,
         80, 142,  84,  80, 141, 129, 145,  25, 131,  93,  19, 137,  29,   4,
        139, 156, 139, 137, 129, 139, 156,  59,  93, 145], device='cuda:0')
ldmk_s.shape :  torch.Size([1, 150, 3])
ldmk_t.shape :  torch.Size([1, 150, 3])
vec_6d.shape :  torch.Size([1, 300, 3])
ind.shape :  torch.Size([1, 150, 2])
bi :  0
si.shape :  torch.Size([150])
ti.shape :  torch.Size([150])
s_pos.shape :  torch.Size([150, 3])
t_pos.shape :  torch.Size([150, 3])
ind.shape :  torch.Size([1, 150, 2])
bi :  0
si.shape :  torch.Size([150])
ti.shape :  torch.Size([150])
s_pos.shape :  torch.Size([150, 3])
t_pos.shape :  torch.Size([150, 3])
number of true landmarks correspondences returned from KNN matching :  9  out of  150
fraction of true landmark correspondences returned from KNN matching :  0.06
vec6d.shape :  torch.Size([1, 300, 3])
ldmk_s.shape :  torch.Size([1, 3, 3])
ldmk_t.shape :  torch.Size([1, 297, 3])
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(AlignAndNonRigidMerge) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L167:#points1: 150
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L168:#points2: 150
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L169:#matches: 150
Before Run of ransac
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SquentialRANSAC) {
num_inliers : 28
num_inliers : 12
num_inliers : 31
num_inliers : 31
num_inliers : 35
num_inliers : 9
num_inliers : 27
num_inliers : 25
num_inliers : 39
num_inliers : 28
num_inliers : 9
num_inliers : 20
num_inliers : 34
num_inliers : 33
num_inliers : 19
num_inliers : 22
num_inliers : 36
num_inliers : 33
num_inliers : 48
num_inliers : 42
num_inliers : 15
num_inliers : 29
num_inliers : 45
num_inliers : 25
num_inliers : 10
num_inliers : 33
num_inliers : 34
num_inliers : 32
num_inliers : 29
num_inliers : 29
num_inliers : 43
num_inliers : 11
num_inliers : 10
num_inliers : 41
num_inliers : 29
num_inliers : 35
num_inliers : 31
num_inliers : 24
num_inliers : 23
num_inliers : 22
num_inliers : 18
num_inliers : 29
num_inliers : 30
num_inliers : 9
num_inliers : 37
num_inliers : 38
num_inliers : 11
num_inliers : 6
num_inliers : 20
num_inliers : 23
num_inliers : 13
num_inliers : 34
num_inliers : 36
num_inliers : 25
num_inliers : 43
num_inliers : 29
num_inliers : 18
num_inliers : 27
num_inliers : 25
num_inliers : 1
num_inliers : 13
num_inliers : 28
num_inliers : 23
num_inliers : 29
num_inliers : 28
num_inliers : 26
num_inliers : 24
num_inliers : 46
num_inliers : 30
num_inliers : 14
num_inliers : 18
num_inliers : 22
num_inliers : 17
num_inliers : 20
num_inliers : 19
num_inliers : 24
num_inliers : 26
num_inliers : 22
num_inliers : 18
num_inliers : 21
num_inliers : 41
num_inliers : 11
num_inliers : 12
num_inliers : 41
num_inliers : 22
num_inliers : 27
num_inliers : 40
num_inliers : 31
num_inliers : 26
num_inliers : 8
num_inliers : 17
num_inliers : 41
num_inliers : 4
num_inliers : 18
num_inliers : 24
num_inliers : 23
num_inliers : 16
num_inliers : 30
num_inliers : 27
num_inliers : 20
num_inliers : 14
num_inliers : 30
num_inliers : 15
num_inliers : 20
num_inliers : 13
num_inliers : 27
num_inliers : 32
num_inliers : 47
num_inliers : 15
num_inliers : 18
num_inliers : 26
num_inliers : 11
num_inliers : 21
num_inliers : 41
num_inliers : 27
num_inliers : 26
num_inliers : 25
num_inliers : 14
num_inliers : 26
num_inliers : 25
num_inliers : 35
num_inliers : 23
num_inliers : 21
num_inliers : 41
num_inliers : 31
num_inliers : 26
num_inliers : 27
num_inliers : 28
num_inliers : 17
num_inliers : 32
num_inliers : 36
num_inliers : 33
num_inliers : 35
num_inliers : 17
num_inliers : 24
num_inliers : 17
num_inliers : 13
num_inliers : 42
num_inliers : 52
num_inliers inside of Run : 52
num_inliers : 24
num_inliers : 13
num_inliers : 20
num_inliers : 8
num_inliers : 19
num_inliers : 20
num_inliers : 6
num_inliers : 21
num_inliers : 18
num_inliers : 13
num_inliers : 18
num_inliers : 26
num_inliers : 19
num_inliers : 5
num_inliers : 23
num_inliers : 23
num_inliers : 14
num_inliers : 17
num_inliers : 15
num_inliers : 33
num_inliers : 25
num_inliers : 14
num_inliers : 9
num_inliers : 14
num_inliers : 9
num_inliers : 17
num_inliers : 24
num_inliers : 18
num_inliers : 34
num_inliers : 29
num_inliers : 16
num_inliers : 13
num_inliers : 3
num_inliers : 7
num_inliers : 28
num_inliers : 29
num_inliers : 11
num_inliers : 21
num_inliers : 28
num_inliers : 18
num_inliers : 9
num_inliers : 22
num_inliers : 28
num_inliers : 20
num_inliers : 6
num_inliers : 17
num_inliers : 15
num_inliers : 18
num_inliers : 22
num_inliers : 7
num_inliers : 17
num_inliers : 9
num_inliers : 28
num_inliers : 16
num_inliers : 33
num_inliers : 22
num_inliers : 12
num_inliers : 9
num_inliers : 28
num_inliers : 23
num_inliers : 9
num_inliers : 14
num_inliers : 11
num_inliers : 10
num_inliers : 19
num_inliers : 29
num_inliers : 19
num_inliers : 23
num_inliers : 13
num_inliers : 19
num_inliers : 20
num_inliers : 18
num_inliers : 9
num_inliers : 23
num_inliers : 21
num_inliers : 9
num_inliers : 15
num_inliers : 20
num_inliers : 18
num_inliers : 16
num_inliers : 17
num_inliers : 10
num_inliers : 18
num_inliers : 10
num_inliers : 6
num_inliers : 21
num_inliers : 7
num_inliers : 22
num_inliers : 7
num_inliers : 13
num_inliers : 16
num_inliers : 36
num_inliers : 16
num_inliers : 32
num_inliers : 26
num_inliers : 22
num_inliers : 20
num_inliers : 12
num_inliers : 18
num_inliers : 11
num_inliers : 18
num_inliers inside of Run : 36
num_inliers : 16
num_inliers : 14
num_inliers : 22
num_inliers : 9
num_inliers : 11
num_inliers : 7
num_inliers : 26
num_inliers : 14
num_inliers : 5
num_inliers : 16
num_inliers : 14
num_inliers : 10
num_inliers : 15
num_inliers : 24
num_inliers : 17
num_inliers : 11
num_inliers : 7
num_inliers : 8
num_inliers : 16
num_inliers : 15
num_inliers : 10
num_inliers : 16
num_inliers : 21
num_inliers : 19
num_inliers : 24
num_inliers : 8
num_inliers : 10
num_inliers : 7
num_inliers : 7
num_inliers : 12
num_inliers : 15
num_inliers : 17
num_inliers : 22
num_inliers : 16
num_inliers : 18
num_inliers : 21
num_inliers : 15
num_inliers : 17
num_inliers : 22
num_inliers : 16
num_inliers : 13
num_inliers : 13
num_inliers : 16
num_inliers : 15
num_inliers : 14
num_inliers : 26
num_inliers : 5
num_inliers : 6
num_inliers : 20
num_inliers : 23
num_inliers : 19
num_inliers : 24
num_inliers : 19
num_inliers : 18
num_inliers : 20
num_inliers : 24
num_inliers : 14
num_inliers : 10
num_inliers : 20
num_inliers : 6
num_inliers : 29
num_inliers : 3
num_inliers : 18
num_inliers : 22
num_inliers : 20
num_inliers : 6
num_inliers : 11
num_inliers : 20
num_inliers : 19
num_inliers : 14
num_inliers : 20
num_inliers : 20
num_inliers : 18
num_inliers : 22
num_inliers : 17
num_inliers : 28
num_inliers : 13
num_inliers : 20
num_inliers : 11
num_inliers : 11
num_inliers : 13
num_inliers : 21
num_inliers : 14
num_inliers : 16
num_inliers : 8
num_inliers : 8
num_inliers : 30
num_inliers : 19
num_inliers : 16
num_inliers : 15
num_inliers : 16
num_inliers : 17
num_inliers : 22
num_inliers : 25
num_inliers : 17
num_inliers : 26
num_inliers : 13
num_inliers : 20
num_inliers : 11
num_inliers : 18
num_inliers : 16
num_inliers inside of Run : 30
num_inliers : 7
num_inliers : 6
num_inliers : 14
num_inliers : 14
num_inliers : 9
num_inliers : 6
num_inliers : 7
num_inliers : 5
num_inliers : 8
num_inliers : 6
num_inliers : 5
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 3
num_inliers : 7
num_inliers : 4
num_inliers : 7
num_inliers : 9
num_inliers : 11
num_inliers : 11
num_inliers : 7
num_inliers : 4
num_inliers : 8
num_inliers : 6
num_inliers : 13
num_inliers : 11
num_inliers : 8
num_inliers : 6
num_inliers : 7
num_inliers : 12
num_inliers : 7
num_inliers : 8
num_inliers : 12
num_inliers : 7
num_inliers : 6
num_inliers : 5
num_inliers : 15
num_inliers : 7
num_inliers : 6
num_inliers : 5
num_inliers : 14
num_inliers : 7
num_inliers : 5
num_inliers : 7
num_inliers : 9
num_inliers : 3
num_inliers : 7
num_inliers : 8
num_inliers : 11
num_inliers : 15
num_inliers : 8
num_inliers : 9
num_inliers : 5
num_inliers : 8
num_inliers : 9
num_inliers : 8
num_inliers : 6
num_inliers : 6
num_inliers : 8
num_inliers : 10
num_inliers : 12
num_inliers : 5
num_inliers : 11
num_inliers : 7
num_inliers : 5
num_inliers : 4
num_inliers : 8
num_inliers : 3
num_inliers : 13
num_inliers : 7
num_inliers : 13
num_inliers : 11
num_inliers : 4
num_inliers : 9
num_inliers : 7
num_inliers : 8
num_inliers : 7
num_inliers : 7
num_inliers : 5
num_inliers : 5
num_inliers : 8
num_inliers : 10
num_inliers : 12
num_inliers : 8
num_inliers : 4
num_inliers : 11
num_inliers : 7
num_inliers : 3
num_inliers : 13
num_inliers : 10
num_inliers : 11
num_inliers : 13
num_inliers : 10
num_inliers : 6
num_inliers : 7
num_inliers : 5
num_inliers : 5
num_inliers : 7
num_inliers : 10
num_inliers : 13
num_inliers inside of Run : 15
num_inliers : 3
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 1
num_inliers : 5
num_inliers : 2
num_inliers : 3
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 7
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 2
num_inliers : 4
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 6
num_inliers : 4
num_inliers : 6
num_inliers : 6
num_inliers : 3
num_inliers : 3
num_inliers : 2
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 2
num_inliers : 3
num_inliers : 1
num_inliers : 3
num_inliers : 3
num_inliers : 5
num_inliers : 2
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 6
num_inliers : 4
num_inliers : 3
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 3
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 4
num_inliers : 2
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 2
num_inliers : 3
num_inliers : 4
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 6
num_inliers : 7
num_inliers : 6
num_inliers : 2
num_inliers : 3
num_inliers : 2
num_inliers : 5
num_inliers : 6
num_inliers inside of Run : 7
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SquentialRANSAC) [26.212791 s]
-0.518638  0.100042 -0.721319   1.36458
  0.27902 -0.790677  -0.31028  0.813043
 -0.67265 -0.405114  0.427458  0.819514
        0         0         0         1
 0.472248 -0.335106 -0.270402  0.572766
 0.348023 0.0607184  0.532564   0.63879
 -0.25356 -0.540785  0.227354  0.436387
        0         0         0         1
 0.439481 -0.240594  0.546455  0.535092
-0.126221  0.625753  0.377019  0.883657
-0.583581 -0.316528  0.329978  0.735459
        0         0         0         1
-0.277885  0.762161 -0.177466   1.05745
 0.176616 -0.122381 -0.802143  0.886231
-0.762358 -0.306165 -0.121146  0.929639
        0         0         0         1
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(DenseGaussNewton::optimize()) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L118:# parameters: 7
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L119:# residuals: 5905
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L238:Gauss-Newton gradient threshold reached.
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L240:Gauss-Newton gradient max norm 5.279577e-07 <= 1.000000e-06
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L241:Gauss-Newton convergence #iters: 9
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L242:Gauss-Newton converged.
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (DenseGaussNewton::optimize()) [0.096659 s]
Affine transform:  -0.72029  0.130624 -0.671942   1.50219
 0.323015 -0.795122 -0.500828  0.813663
-0.603514 -0.581468  0.533903  0.757046
        0         0         0         1
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L232:#models: 4
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 0 | #inliers 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 1 | #inliers 36
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 2 | #inliers 30
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 3 | #inliers 15
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L235:#inilers: 133
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L257:Mesh1: #vertices: 5888
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L258:Mesh2: #vertices: 5905
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Registration2::Register) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L784:SampleDeformationNodes
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.013738 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L790:Create balltree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L797:Build kdtree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L804:Create matches...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L826:#matches / #inliers: 150/150
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L827:Mesh1: #points | #normals: 133 | 133
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L828:Mesh2: #points | #normals: 133 | 133
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SetupRegistrationProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SetupRegistrationProblem) [0.067329 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SolveCeresProblem) {
iter      cost      cost_change  |gradient|   |step|    tr_ratio  tr_radius  ls_iter  iter_time  total_time
   0  2.231271e-03    0.00e+00    8.58e-04   0.00e+00   0.00e+00  1.00e+04        0    7.22e-02    1.45e-01
   1  1.151107e-03    1.08e-03    5.55e-04   2.35e+01   5.40e-01  1.00e+04        1    5.92e+01    5.93e+01
   2  4.703104e-04    6.81e-04    7.19e-04   1.76e+01   6.68e-01  1.04e+04        1    6.40e+01    1.23e+02
   3  3.586954e-04    1.12e-04    4.49e-04   2.77e+01   2.56e-01  9.32e+03        1    6.63e+01    1.90e+02
