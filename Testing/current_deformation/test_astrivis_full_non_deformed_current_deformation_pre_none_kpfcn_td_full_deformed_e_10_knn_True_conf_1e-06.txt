model 002
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  1e-06
preprocessing :  none
confidence threshold used in the matching :  1e-06
preprocessing :  none
F0.shape : torch.Size([156, 528])
F1.shape : torch.Size([163, 528])
ldmk_t_indices :  tensor([ 52, 156,  52,  52,  44, 103, 156, 156,  63, 156,  24,  63, 139,  52,
        124,  26,  52,  39,  24,  30,  68,  24, 148,  39,  26,  52,  65,  66,
         24,  65,  26,  44,  43,  87, 137,  26, 107,  15,  15,  63,  15,  24,
         26,  24, 154, 100, 154,  65,  91, 100, 136,  65, 100,  30,  61, 160,
        148, 156, 121, 160,  62,  41, 124,  60,  52, 100,  24, 100,  58, 156,
         30, 124,  54, 137, 136,   6, 137,  12, 137,   6,  30, 121,   4, 107,
        137, 107, 137, 143, 127,  12,  12,  56,  12, 154, 107,  72, 107, 121,
         65,  12, 107, 161,  12,  56, 127, 124, 127,  37,  24, 124,  58, 103,
          5,  44,  30,  12, 137,  56,  99,  11, 127,  63, 120,  30, 121,  39,
         12,   6, 137, 144,  30, 121,  30, 100,   4,  58, 121, 152,  99,   6,
         43, 156, 121,  30, 143, 120, 156,  58, 136,   5, 143,  65, 121, 156,
          1,  52], device='cuda:0')
ldmk_s.shape :  torch.Size([1, 156, 3])
ldmk_t.shape :  torch.Size([1, 156, 3])
vec_6d.shape :  torch.Size([1, 312, 3])
ind.shape :  torch.Size([1, 156, 2])
bi :  0
si.shape :  torch.Size([156])
ti.shape :  torch.Size([156])
s_pos.shape :  torch.Size([156, 3])
t_pos.shape :  torch.Size([156, 3])
ind.shape :  torch.Size([1, 156, 2])
bi :  0
si.shape :  torch.Size([156])
ti.shape :  torch.Size([156])
s_pos.shape :  torch.Size([156, 3])
t_pos.shape :  torch.Size([156, 3])
number of true landmarks correspondences returned from KNN matching :  15  out of  156
fraction of true landmark correspondences returned from KNN matching :  0.09615384615384616
vec6d.shape :  torch.Size([1, 312, 3])
ldmk_s.shape :  torch.Size([1, 3, 3])
ldmk_t.shape :  torch.Size([1, 309, 3])
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(AlignAndNonRigidMerge) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L167:#points1: 156
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L168:#points2: 156
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L169:#matches: 156
Before Run of ransac
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SquentialRANSAC) {
num_inliers : 49
num_inliers : 32
num_inliers : 29
num_inliers : 19
num_inliers : 59
num_inliers : 54
num_inliers : 46
num_inliers : 44
num_inliers : 24
num_inliers : 48
num_inliers : 18
num_inliers : 47
num_inliers : 50
num_inliers : 30
num_inliers : 39
num_inliers : 35
num_inliers : 35
num_inliers : 22
num_inliers : 18
num_inliers : 18
num_inliers : 18
num_inliers : 16
num_inliers : 25
num_inliers : 16
num_inliers : 62
num_inliers : 14
num_inliers : 7
num_inliers : 27
num_inliers : 32
num_inliers : 24
num_inliers : 65
num_inliers : 66
num_inliers : 29
num_inliers : 33
num_inliers : 22
num_inliers : 24
num_inliers : 26
num_inliers : 15
num_inliers : 40
num_inliers : 23
num_inliers : 14
num_inliers : 47
num_inliers : 24
num_inliers : 16
num_inliers : 32
num_inliers : 33
num_inliers : 4
num_inliers : 54
num_inliers : 18
num_inliers : 6
num_inliers : 43
num_inliers : 54
num_inliers : 13
num_inliers : 22
num_inliers : 34
num_inliers : 38
num_inliers : 11
num_inliers : 39
num_inliers : 60
num_inliers : 47
num_inliers : 44
num_inliers : 69
num_inliers : 15
num_inliers : 25
num_inliers : 51
num_inliers : 56
num_inliers : 14
num_inliers : 59
num_inliers : 64
num_inliers : 29
num_inliers : 38
num_inliers : 20
num_inliers : 40
num_inliers : 10
num_inliers : 24
num_inliers : 32
num_inliers : 30
num_inliers : 33
num_inliers : 35
num_inliers : 51
num_inliers : 31
num_inliers : 20
num_inliers : 25
num_inliers : 9
num_inliers : 30
num_inliers : 33
num_inliers : 3
num_inliers : 39
num_inliers : 23
num_inliers : 55
num_inliers : 33
num_inliers : 33
num_inliers : 27
num_inliers : 37
num_inliers : 27
num_inliers : 35
num_inliers : 14
num_inliers : 62
num_inliers : 14
num_inliers : 30
num_inliers : 60
num_inliers inside of Run : 69
num_inliers : 16
num_inliers : 17
num_inliers : 27
num_inliers : 18
num_inliers : 36
num_inliers : 14
num_inliers : 29
num_inliers : 8
num_inliers : 12
num_inliers : 14
num_inliers : 29
num_inliers : 6
num_inliers : 17
num_inliers : 10
num_inliers : 16
num_inliers : 26
num_inliers : 18
num_inliers : 10
num_inliers : 12
num_inliers : 17
num_inliers : 19
num_inliers : 21
num_inliers : 4
num_inliers : 27
num_inliers : 8
num_inliers : 9
num_inliers : 5
num_inliers : 32
num_inliers : 16
num_inliers : 17
num_inliers : 14
num_inliers : 7
num_inliers : 15
num_inliers : 11
num_inliers : 13
num_inliers : 26
num_inliers : 21
num_inliers : 17
num_inliers : 26
num_inliers : 14
num_inliers : 17
num_inliers : 33
num_inliers : 9
num_inliers : 9
num_inliers : 9
num_inliers : 14
num_inliers : 4
num_inliers : 24
num_inliers : 8
num_inliers : 13
num_inliers : 10
num_inliers : 18
num_inliers : 11
num_inliers : 27
num_inliers : 4
num_inliers : 9
num_inliers : 23
num_inliers : 20
num_inliers : 12
num_inliers : 27
num_inliers : 19
num_inliers : 21
num_inliers : 7
num_inliers : 8
num_inliers : 30
num_inliers : 9
num_inliers : 23
num_inliers : 24
num_inliers : 28
num_inliers : 6
num_inliers : 5
num_inliers : 12
num_inliers : 17
num_inliers : 19
num_inliers : 7
num_inliers : 9
num_inliers : 28
num_inliers : 12
num_inliers : 12
num_inliers : 10
num_inliers : 23
num_inliers : 3
num_inliers : 18
num_inliers : 19
num_inliers : 4
num_inliers : 11
num_inliers : 18
num_inliers : 9
num_inliers : 17
num_inliers : 25
num_inliers : 7
num_inliers : 19
num_inliers : 29
num_inliers : 10
num_inliers : 13
num_inliers : 22
num_inliers : 13
num_inliers : 13
num_inliers : 8
num_inliers : 7
num_inliers : 4
num_inliers inside of Run : 36
num_inliers : 6
num_inliers : 7
num_inliers : 7
num_inliers : 10
num_inliers : 7
num_inliers : 10
num_inliers : 5
num_inliers : 13
num_inliers : 13
num_inliers : 11
num_inliers : 9
num_inliers : 7
num_inliers : 4
num_inliers : 10
num_inliers : 16
num_inliers : 8
num_inliers : 12
num_inliers : 8
num_inliers : 7
num_inliers : 6
num_inliers : 12
num_inliers : 8
num_inliers : 3
num_inliers : 10
num_inliers : 12
num_inliers : 2
num_inliers : 13
num_inliers : 17
num_inliers : 8
num_inliers : 3
num_inliers : 14
num_inliers : 12
num_inliers : 7
num_inliers : 11
num_inliers : 12
num_inliers : 13
num_inliers : 12
num_inliers : 5
num_inliers : 4
num_inliers : 4
num_inliers : 17
num_inliers : 2
num_inliers : 9
num_inliers : 8
num_inliers : 9
num_inliers : 11
num_inliers : 12
num_inliers : 7
num_inliers : 5
num_inliers : 11
num_inliers : 12
num_inliers : 4
num_inliers : 10
num_inliers : 11
num_inliers : 8
num_inliers : 10
num_inliers : 16
num_inliers : 9
num_inliers : 12
num_inliers : 7
num_inliers : 8
num_inliers : 9
num_inliers : 10
num_inliers : 11
num_inliers : 11
num_inliers : 13
num_inliers : 14
num_inliers : 14
num_inliers : 7
num_inliers : 7
num_inliers : 9
num_inliers : 7
num_inliers : 16
num_inliers : 2
num_inliers : 13
num_inliers : 10
num_inliers : 14
num_inliers : 5
num_inliers : 8
num_inliers : 2
num_inliers : 1
num_inliers : 5
num_inliers : 12
num_inliers : 11
num_inliers : 11
num_inliers : 10
num_inliers : 1
num_inliers : 11
num_inliers : 7
num_inliers : 4
num_inliers : 14
num_inliers : 19
num_inliers : 15
num_inliers : 13
num_inliers : 7
num_inliers : 6
num_inliers : 3
num_inliers : 12
num_inliers : 8
num_inliers : 7
num_inliers : 9
num_inliers inside of Run : 19
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 7
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 9
num_inliers : 3
num_inliers : 6
num_inliers : 10
num_inliers : 1
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 8
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 11
num_inliers : 6
num_inliers : 3
num_inliers : 5
num_inliers : 11
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 7
num_inliers : 3
num_inliers : 8
num_inliers : 4
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 3
num_inliers : 7
num_inliers : 7
num_inliers : 4
num_inliers : 4
num_inliers : 7
num_inliers : 1
num_inliers : 10
num_inliers : 2
num_inliers : 7
num_inliers : 3
num_inliers : 8
num_inliers : 6
num_inliers : 2
num_inliers : 2
num_inliers : 6
num_inliers : 8
num_inliers : 5
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 5
num_inliers : 5
num_inliers : 3
num_inliers : 9
num_inliers : 4
num_inliers : 8
num_inliers : 6
num_inliers : 7
num_inliers : 4
num_inliers : 4
num_inliers : 10
num_inliers : 3
num_inliers : 7
num_inliers : 4
num_inliers : 9
num_inliers : 6
num_inliers : 8
num_inliers : 6
num_inliers : 4
num_inliers : 7
num_inliers : 9
num_inliers : 8
num_inliers : 4
num_inliers : 6
num_inliers : 6
num_inliers : 2
num_inliers : 2
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 8
num_inliers : 5
num_inliers : 3
num_inliers : 6
num_inliers : 5
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 7
num_inliers : 4
num_inliers : 5
num_inliers : 6
num_inliers : 8
num_inliers : 7
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 1
num_inliers : 4
num_inliers : 5
num_inliers inside of Run : 11
num_inliers : 6
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 9
num_inliers : 5
num_inliers : 3
num_inliers : 3
num_inliers : 5
num_inliers : 7
num_inliers : 4
num_inliers : 6
num_inliers : 2
num_inliers : 2
num_inliers : 6
num_inliers : 1
num_inliers : 7
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 5
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 4
num_inliers : 7
num_inliers : 6
num_inliers : 5
num_inliers : 5
num_inliers : 2
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 6
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 7
num_inliers : 4
num_inliers : 3
num_inliers : 3
num_inliers : 5
num_inliers : 5
num_inliers : 5
num_inliers : 2
num_inliers : 6
num_inliers : 4
num_inliers : 2
num_inliers : 3
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 1
num_inliers : 4
num_inliers : 3
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 6
num_inliers : 4
num_inliers : 3
num_inliers : 2
num_inliers : 6
num_inliers : 5
num_inliers : 7
num_inliers : 6
num_inliers : 6
num_inliers : 6
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 5
num_inliers : 5
num_inliers : 5
num_inliers : 6
num_inliers : 2
num_inliers : 4
num_inliers : 4
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 3
num_inliers : 8
num_inliers : 6
num_inliers : 4
num_inliers inside of Run : 9
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SquentialRANSAC) [25.331180 s]
-0.442453 -0.557423   0.53945  0.812278
-0.684357  0.572892 0.0306741  0.401004
-0.365214 -0.398203 -0.711016    1.1177
        0         0         0         1
   0.121814    0.614719    0.443084    -0.10938
  -0.170019    0.459503   -0.590756    0.370723
  -0.738443 -0.00439145    0.209107    0.750529
          0           0           0           1
-0.334006 -0.188689  0.442274  0.590359
-0.323332 -0.310447 -0.376628  0.685926
 0.355902 -0.459117 0.0729026 0.0585783
        0         0         0         1
-0.316278  -0.77865 -0.148593   1.20944
-0.502558  0.320683 -0.610742  0.738262
 0.613035 -0.138831 -0.577341  0.078682
        0         0         0         1
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(DenseGaussNewton::optimize()) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L118:# parameters: 7
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L119:# residuals: 5898
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L238:Gauss-Newton gradient threshold reached.
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L240:Gauss-Newton gradient max norm 2.639030e-08 <= 1.000000e-06
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L241:Gauss-Newton convergence #iters: 3
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L242:Gauss-Newton converged.
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (DenseGaussNewton::optimize()) [0.013558 s]
Affine transform:   -0.534865   -0.600021     0.59489    0.896925
  -0.748901    0.662663 -0.00495792    0.437772
  -0.391237   -0.448166   -0.803792     1.20478
          0           0           0           1
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L232:#models: 4
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 0 | #inliers 69
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 1 | #inliers 36
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 2 | #inliers 19
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 3 | #inliers 11
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L235:#inilers: 135
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L257:Mesh1: #vertices: 5898
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L258:Mesh2: #vertices: 5898
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Registration2::Register) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L784:SampleDeformationNodes
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.009184 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L790:Create balltree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L797:Build kdtree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L804:Create matches...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L826:#matches / #inliers: 156/156
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L827:Mesh1: #points | #normals: 135 | 135
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L828:Mesh2: #points | #normals: 135 | 135
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SetupRegistrationProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SetupRegistrationProblem) [0.018381 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SolveCeresProblem) {
iter      cost      cost_change  |gradient|   |step|    tr_ratio  tr_radius  ls_iter  iter_time  total_time
   0  1.499094e-03    0.00e+00    8.20e-04   0.00e+00   0.00e+00  1.00e+04        0    7.85e-02    9.46e-02
   1  5.742813e-04    9.25e-04    5.06e-04   3.21e+01   6.47e-01  1.03e+04        1    6.45e+01    6.46e+01
   2  3.379981e-04    2.36e-04    6.52e-04   3.94e+01   4.56e-01  1.03e+04        1    6.94e+01    1.34e+02
