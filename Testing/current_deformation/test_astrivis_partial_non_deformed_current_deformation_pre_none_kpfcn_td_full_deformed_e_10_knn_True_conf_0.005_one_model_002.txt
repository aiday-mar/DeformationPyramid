model 002
feature_extractor :  kpfcn
feature extractor inside of get_dataloader :  kpfcn
feature extractor inside of collate_fn_4dmatch :  kpfcn


knn_matching :  True
coarse_level :  -2
confidence threshold used in the matching :  0.005
preprocessing :  none
confidence threshold used in the matching :  0.005
preprocessing :  none
F0.shape : torch.Size([123, 528])
F1.shape : torch.Size([132, 528])
ldmk_t_indices :  tensor([ 83, 111,  34, 114, 131,  29, 118,  88,  24,   0,  18, 121,  24,  53,
          0, 112,  74,  83,  74,  85,  29, 114,  74, 112,  74, 128,  42,  42,
          1,  50,  90,  84,  12, 128, 128, 128, 128,  88,  32,  90, 128, 128,
         32, 114, 112, 114,  76, 128, 112,  29, 118, 124,   0,  73, 108,  32,
         32,  88,  58, 123,  81, 120, 107, 114,  32, 114,  84,  73,  29, 128,
         29,   0,  74,   3,  90,  34,  58, 123,  53,  83,   0,  16, 101,  29,
         87,   3, 128, 114, 104,   0,  83,   0,   3,  48,  16,  87,   7, 130,
         88, 123,  81,  29, 119,  52,  29,  29, 101,  74,  53,  90,  74,   3,
        111,  52,   0,  90,  50, 131,  81,  29, 121,  26, 131],
       device='cuda:0')
ldmk_s.shape :  torch.Size([123, 3])
ldmk_t.shape :  torch.Size([123, 3])
vec_6d.shape :  torch.Size([123, 6])
ind.shape :  torch.Size([1, 123, 2])
bi :  0
si.shape :  torch.Size([123])
ti.shape :  torch.Size([123])
s_pos.shape :  torch.Size([123, 3])
t_pos.shape :  torch.Size([123, 3])
ind.shape :  torch.Size([1, 123, 2])
bi :  0
si.shape :  torch.Size([123])
ti.shape :  torch.Size([123])
s_pos.shape :  torch.Size([123, 3])
t_pos.shape :  torch.Size([123, 3])
number of true landmarks correspondences returned from KNN matching :  4  out of  123
fraction of true landmark correspondences returned from KNN matching :  0.032520325203252036
vec6d.shape :  torch.Size([123, 6])
ldmk_s.shape :  torch.Size([123, 3])
ldmk_t.shape :  torch.Size([123, 3])
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(AlignAndNonRigidMerge) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L167:#points1: 123
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L168:#points2: 123
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L169:#matches: 123
Before Run of ransac
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SquentialRANSAC) {
num_inliers : 12
num_inliers : 24
num_inliers : 16
num_inliers : 0
num_inliers : 1
num_inliers : 26
num_inliers : 32
num_inliers : 9
num_inliers : 16
num_inliers : 3
num_inliers : 14
num_inliers : 16
num_inliers : 13
num_inliers : 29
num_inliers : 29
num_inliers : 10
num_inliers : 9
num_inliers : 22
num_inliers : 7
num_inliers : 13
num_inliers : 6
num_inliers : 8
num_inliers : 2
num_inliers : 4
num_inliers : 2
num_inliers : 18
num_inliers : 10
num_inliers : 6
num_inliers : 15
num_inliers : 33
num_inliers : 19
num_inliers : 9
num_inliers : 13
num_inliers : 13
num_inliers : 29
num_inliers : 20
num_inliers : 26
num_inliers : 6
num_inliers : 8
num_inliers : 14
num_inliers : 21
num_inliers : 11
num_inliers : 23
num_inliers : 21
num_inliers : 16
num_inliers : 10
num_inliers : 23
num_inliers : 4
num_inliers : 3
num_inliers : 16
num_inliers : 26
num_inliers : 17
num_inliers : 28
num_inliers : 12
num_inliers : 9
num_inliers : 22
num_inliers : 11
num_inliers : 10
num_inliers : 13
num_inliers : 31
num_inliers : 26
num_inliers : 9
num_inliers : 0
num_inliers : 22
num_inliers : 15
num_inliers : 8
num_inliers : 28
num_inliers : 8
num_inliers : 9
num_inliers : 18
num_inliers : 9
num_inliers : 23
num_inliers : 19
num_inliers : 17
num_inliers : 52
num_inliers : 15
num_inliers : 20
num_inliers : 14
num_inliers : 2
num_inliers : 8
num_inliers : 8
num_inliers : 23
num_inliers : 3
num_inliers : 36
num_inliers : 33
num_inliers : 11
num_inliers : 31
num_inliers : 9
num_inliers : 19
num_inliers : 18
num_inliers : 22
num_inliers : 4
num_inliers : 5
num_inliers : 3
num_inliers : 8
num_inliers : 26
num_inliers : 10
num_inliers : 4
num_inliers : 36
num_inliers : 17
num_inliers : 8
num_inliers inside of Run : 52
num_inliers : 13
num_inliers : 0
num_inliers : 21
num_inliers : 9
num_inliers : 0
num_inliers : 13
num_inliers : 1
num_inliers : 9
num_inliers : 6
num_inliers : 13
num_inliers : 19
num_inliers : 15
num_inliers : 6
num_inliers : 10
num_inliers : 6
num_inliers : 12
num_inliers : 15
num_inliers : 5
num_inliers : 30
num_inliers : 13
num_inliers : 8
num_inliers : 22
num_inliers : 32
num_inliers : 8
num_inliers : 18
num_inliers : 8
num_inliers : 25
num_inliers : 3
num_inliers : 4
num_inliers : 1
num_inliers : 3
num_inliers : 0
num_inliers : 5
num_inliers : 9
num_inliers : 9
num_inliers : 7
num_inliers : 13
num_inliers : 8
num_inliers : 24
num_inliers : 10
num_inliers : 22
num_inliers : 24
num_inliers : 1
num_inliers : 0
num_inliers : 3
num_inliers : 7
num_inliers : 17
num_inliers : 12
num_inliers : 2
num_inliers : 12
num_inliers : 9
num_inliers : 18
num_inliers : 10
num_inliers : 16
num_inliers : 4
num_inliers : 25
num_inliers : 2
num_inliers : 14
num_inliers : 1
num_inliers : 11
num_inliers : 28
num_inliers : 2
num_inliers : 21
num_inliers : 10
num_inliers : 12
num_inliers : 8
num_inliers : 19
num_inliers : 21
num_inliers : 4
num_inliers : 19
num_inliers : 5
num_inliers : 7
num_inliers : 4
num_inliers : 11
num_inliers : 2
num_inliers : 19
num_inliers : 6
num_inliers : 2
num_inliers : 11
num_inliers : 29
num_inliers : 8
num_inliers : 7
num_inliers : 3
num_inliers : 6
num_inliers : 11
num_inliers : 3
num_inliers : 8
num_inliers : 34
num_inliers : 7
num_inliers : 14
num_inliers : 7
num_inliers : 7
num_inliers : 3
num_inliers : 17
num_inliers : 0
num_inliers : 2
num_inliers : 9
num_inliers : 5
num_inliers : 19
num_inliers : 8
num_inliers : 13
num_inliers inside of Run : 34
num_inliers : 6
num_inliers : 5
num_inliers : 9
num_inliers : 7
num_inliers : 4
num_inliers : 6
num_inliers : 8
num_inliers : 1
num_inliers : 7
num_inliers : 8
num_inliers : 5
num_inliers : 9
num_inliers : 3
num_inliers : 11
num_inliers : 10
num_inliers : 8
num_inliers : 7
num_inliers : 2
num_inliers : 7
num_inliers : 0
num_inliers : 1
num_inliers : 7
num_inliers : 8
num_inliers : 3
num_inliers : 3
num_inliers : 8
num_inliers : 5
num_inliers : 8
num_inliers : 12
num_inliers : 6
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 1
num_inliers : 7
num_inliers : 10
num_inliers : 7
num_inliers : 9
num_inliers : 6
num_inliers : 6
num_inliers : 10
num_inliers : 1
num_inliers : 7
num_inliers : 9
num_inliers : 9
num_inliers : 8
num_inliers : 6
num_inliers : 6
num_inliers : 7
num_inliers : 9
num_inliers : 1
num_inliers : 8
num_inliers : 6
num_inliers : 5
num_inliers : 8
num_inliers : 7
num_inliers : 10
num_inliers : 9
num_inliers : 7
num_inliers : 9
num_inliers : 8
num_inliers : 7
num_inliers : 6
num_inliers : 10
num_inliers : 8
num_inliers : 1
num_inliers : 9
num_inliers : 6
num_inliers : 8
num_inliers : 7
num_inliers : 11
num_inliers : 5
num_inliers : 9
num_inliers : 11
num_inliers : 9
num_inliers : 7
num_inliers : 5
num_inliers : 1
num_inliers : 10
num_inliers : 9
num_inliers : 3
num_inliers : 2
num_inliers : 6
num_inliers : 11
num_inliers : 11
num_inliers : 8
num_inliers : 14
num_inliers : 9
num_inliers : 7
num_inliers : 4
num_inliers : 11
num_inliers : 9
num_inliers : 5
num_inliers : 2
num_inliers : 9
num_inliers : 2
num_inliers : 0
num_inliers : 10
num_inliers : 0
num_inliers : 6
num_inliers : 8
num_inliers inside of Run : 14
num_inliers : 5
num_inliers : 4
num_inliers : 8
num_inliers : 0
num_inliers : 2
num_inliers : 2
num_inliers : 6
num_inliers : 3
num_inliers : 7
num_inliers : 1
num_inliers : 5
num_inliers : 6
num_inliers : 6
num_inliers : 9
num_inliers : 8
num_inliers : 4
num_inliers : 4
num_inliers : 7
num_inliers : 0
num_inliers : 6
num_inliers : 3
num_inliers : 1
num_inliers : 7
num_inliers : 6
num_inliers : 4
num_inliers : 8
num_inliers : 7
num_inliers : 4
num_inliers : 4
num_inliers : 6
num_inliers : 7
num_inliers : 7
num_inliers : 3
num_inliers : 5
num_inliers : 7
num_inliers : 3
num_inliers : 2
num_inliers : 6
num_inliers : 1
num_inliers : 5
num_inliers : 4
num_inliers : 6
num_inliers : 7
num_inliers : 4
num_inliers : 9
num_inliers : 9
num_inliers : 2
num_inliers : 7
num_inliers : 7
num_inliers : 6
num_inliers : 2
num_inliers : 3
num_inliers : 5
num_inliers : 0
num_inliers : 4
num_inliers : 5
num_inliers : 4
num_inliers : 1
num_inliers : 0
num_inliers : 1
num_inliers : 6
num_inliers : 6
num_inliers : 2
num_inliers : 8
num_inliers : 6
num_inliers : 5
num_inliers : 6
num_inliers : 5
num_inliers : 3
num_inliers : 7
num_inliers : 5
num_inliers : 0
num_inliers : 8
num_inliers : 0
num_inliers : 3
num_inliers : 3
num_inliers : 6
num_inliers : 9
num_inliers : 6
num_inliers : 0
num_inliers : 9
num_inliers : 2
num_inliers : 5
num_inliers : 5
num_inliers : 4
num_inliers : 8
num_inliers : 5
num_inliers : 4
num_inliers : 9
num_inliers : 5
num_inliers : 8
num_inliers : 7
num_inliers : 1
num_inliers : 5
num_inliers : 4
num_inliers : 7
num_inliers : 7
num_inliers : 7
num_inliers : 7
num_inliers : 3
num_inliers : 7
num_inliers inside of Run : 9
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SquentialRANSAC) [0.024898 s]
   0.520135    0.192783   0.0196328    0.557589
  -0.193772    0.517963   0.0475157   0.0824023
-0.00181754  -0.0513798    0.552674  -0.0727782
          0           0           0           1
  0.276269  0.0148584  -0.299656   0.796121
  0.127889   0.362653    0.13589 -0.0742789
  0.271402  -0.186013   0.240996   0.046562
         0          0          0          1
 0.757764 -0.362379 -0.433789  0.641266
 0.504624   0.10686  0.792233 -0.381142
-0.254649 -0.866579   0.27909  0.368076
        0         0         0         1
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(DenseGaussNewton::optimize()) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L118:# parameters: 7
VERBOSE: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L119:# residuals: 9380
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L238:Gauss-Newton gradient threshold reached.
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L240:Gauss-Newton gradient max norm 0.000000e+00 <= 1.000000e-06
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L241:Gauss-Newton convergence #iters: 7
INFO: /home/aiday.kyzy/code/sfm/src/./vision/geometry/dense_gauss_newton.h:L242:Gauss-Newton converged.
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (DenseGaussNewton::optimize()) [0.037180 s]
Affine transform:    0.0018804  0.000279165 -0.000965123    -0.132766
   0.0009642  7.40905e-05   0.00190003      2.20437
 0.000282335  -0.00211231  -6.0907e-05      1.58015
           0            0            0            1
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L232:#models: 3
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 0 | #inliers 52
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 1 | #inliers 34
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L91:#model 2 | #inliers 14
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L235:#inilers: 100
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L257:Mesh1: #vertices: 9132
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/point_cloud_non_rigid_merge.cc:L258:Mesh2: #vertices: 9380
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Registration2::Register) {
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L784:SampleDeformationNodes
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.008897 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L790:Create balltree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L797:Build kdtree...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L804:Create matches...
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L826:#matches / #inliers: 123/123
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L827:Mesh1: #points | #normals: 100 | 100
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L828:Mesh2: #points | #normals: 100 | 100
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SetupRegistrationProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SetupRegistrationProblem) [0.000065 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(SolveCeresProblem) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (SolveCeresProblem) [0.000859 s]
VERBOSE: /home/aiday.kyzy/code/sfm/src/vision/point_cloud/registration/non_rigid_registration.cc:L881:Summary: 
Solver Summary (v 2.1.0-eigen-(3.3.4)-lapack-suitesparse-(5.1.2)-cxsparse-(3.1.9)-eigensparse-no_openmp-cuda-(11030))

                                     Original                  Reduced
Parameter blocks                            1                        1
Parameters                                  6                        6
Residual blocks                           100                      100
Residuals                                 100                      100

Minimizer                        TRUST_REGION

Sparse linear algebra library    SUITE_SPARSE
Trust region strategy     LEVENBERG_MARQUARDT

                                        Given                     Used
Linear solver          SPARSE_NORMAL_CHOLESKY   SPARSE_NORMAL_CHOLESKY
Threads                                    16                       16
Linear solver ordering              AUTOMATIC                        1

Cost:
Initial                         -1.000000e+00

Minimizer iterations                        0
Successful steps                            0
Unsuccessful steps                          0

Time (in seconds):
Preprocessor                         0.000408

  Residual only evaluation           0.000000 (0)
  Jacobian & residual evaluation     0.000378 (1)
  Linear solver                      0.000000 (0)
Minimizer                            0.000424

Postprocessor                        0.000004
Total                                0.000847

Termination:                          FAILURE (Residual and Jacobian evaluation failed.)

INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(Update nodes) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Update nodes) [0.000004 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (Registration2::Register) [0.020407 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L74:} // ScopedTimer (PointCloudSampling::PoissonSphereSampling) [0.011648 s]
INFO: /home/aiday.kyzy/code/sfm/src/base/scoped_timer.cc:L87:ScopedTimer(PointCloudSampling::PoissonSphereSampling) {
strict inlier ratio threshold :  0.01
relaxed inlier ratio threshold :  0.03
[1;33m[Open3D WARNING] Read PLY failed: unable to open file: /home/aiday.kyzy/dataset/Synthetic/PartialNonDeformedData/TestingData//model002/output_partial_non_deformed_deformed_current_deformation_pre_none_kpfcn_td_full_deformed_e_10_knn_True_conf_0.005/current_deformation.ply[0;m
